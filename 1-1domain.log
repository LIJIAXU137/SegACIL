nohup: ignoring input
Available GPUs: 1
[1]
[1, 0]
==============================================
  task : 1-1
  step : 0
  Device: cuda
Namespace(amp=True, batch_size=6, bn_freeze=True, buffer=16384, cil_step=0, ckpt=None, crop_size=513, crop_val=True, curr_itrs=0, curr_step=0, data_root='/data/yt/BARM2/data_root/cityscapes', dataset='cityscapes_domain', gamma=10, gpu_id='1', initial=True, local_rank=0, loss_type='bce_loss', lr=0.01, lr_policy='poly', method='acil', model='deeplabv3_resnet101', num_classes=[1, 0], output_stride=16, overlap=False, print_interval=10, pseudo=True, pseudo_thresh=0.7, random_seed=1, separable_conv=False, setting='overlap', step_size=10000, subpath='BARM', target_cls=[[0]], task='1-1', test_only=False, train_epoch=50, unknown=0, val_batch_size=2, val_interval=100, weight_decay=0.0001)
==============================================
Category components: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
Dataset: cityscapes_domain, Train set: 139, Val set: 35, Test set: 35
... train epoch : 50 , iterations : 1150 , val_interval : 100
[1-1 / step 0] Epoch 0, Itrs 0/23, Loss=12.834793, StdLoss=12.8348, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=6764.66 , LR=0.00099922
[1-1 / step 0] Epoch 0, Itrs 10/23, Loss=5.423963, StdLoss=5.4240, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=721.28 , LR=0.00099139
[1-1 / step 0] Epoch 0, Itrs 20/23, Loss=3.831593, StdLoss=3.8316, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=431.95 , LR=0.00098355
[1-1 / step 0] Epoch 1, Itrs 0/23, Loss=3.558776, StdLoss=3.5588, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=392.21 , LR=0.00098120
[1-1 / step 0] Epoch 1, Itrs 10/23, Loss=2.997326, StdLoss=2.9973, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=310.37 , LR=0.00097335
[1-1 / step 0] Epoch 1, Itrs 20/23, Loss=2.628046, StdLoss=2.6280, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=265.80 , LR=0.00096550
[1-1 / step 0] Epoch 2, Itrs 0/23, Loss=2.556279, StdLoss=2.5563, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=256.13 , LR=0.00096314
[1-1 / step 0] Epoch 2, Itrs 10/23, Loss=2.301706, StdLoss=2.3017, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=231.29 , LR=0.00095528
[1-1 / step 0] Epoch 2, Itrs 20/23, Loss=2.113007, StdLoss=2.1130, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=213.83 , LR=0.00094741
[1-1 / step 0] Epoch 3, Itrs 0/23, Loss=2.072932, StdLoss=2.0729, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=209.57 , LR=0.00094505
[1-1 / step 0] Epoch 3, Itrs 10/23, Loss=1.946372, StdLoss=1.9464, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=197.73 , LR=0.00093717
[1-1 / step 0] Epoch 3, Itrs 20/23, Loss=1.851080, StdLoss=1.8511, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=188.48 , LR=0.00092928
[1-1 / step 0] Epoch 4, Itrs 0/23, Loss=1.821563, StdLoss=1.8216, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=186.11 , LR=0.00092691
[1-1 / step 0] Epoch 4, Itrs 10/23, Loss=1.746789, StdLoss=1.7468, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=179.20 , LR=0.00091902
[1-1 / step 0] Epoch 4, Itrs 20/23, Loss=1.694596, StdLoss=1.6946, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=173.43 , LR=0.00091111
[Validation]
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:03<01:06,  3.90s/it] 28%|██▊       | 5/18 [00:04<00:07,  1.64it/s] 50%|█████     | 9/18 [00:04<00:02,  3.42it/s] 67%|██████▋   | 12/18 [00:04<00:01,  4.81it/s] 83%|████████▎ | 15/18 [00:04<00:00,  5.92it/s]100%|██████████| 18/18 [00:07<00:00,  2.08it/s]100%|██████████| 18/18 [00:08<00:00,  2.23it/s]
Total samples: 35.000000
Overall Acc: 0.840859
Mean Acc: 0.251262
FreqW Acc: 0.730516
Mean IoU: 0.209637
Class IoU:
	class 0: 0.9111729708695607
	class 1: 0.19781263701406132
	class 2: 0.7034484329552481
	class 3: 0.0
	class 4: 0.0
	class 5: 0.0
	class 6: 0.0
	class 7: 0.0
	class 8: 0.7097484380920677
	class 9: 0.0
	class 10: 0.3868217169308883
	class 11: 0.04224324491384106
	class 12: 0.0
	class 13: 0.6125890643722808
	class 14: X
	class 15: 0.0
	class 16: X
	class 17: 0.0
	class 18: 0.0
Class Acc:
	class 0: 0.9821544893419498
	class 1: 0.280753308037472
	class 2: 0.9232728859586401
	class 3: 0.0
	class 4: 0.0
	class 5: 0.0
	class 6: 0.0
	class 7: 0.0
	class 8: 0.7862188218783909
	class 9: 0.0
	class 10: 0.39769432660807696
	class 11: 0.04379767933785759
	class 12: 0.0
	class 13: 0.8575700790032303
	class 14: X
	class 15: 0.0
	class 16: X
	class 17: 0.0
	class 18: 0.0

curr_val_score : 0.9112

... save best ckpt :  0.9111729708695607

[1-1 / step 0] Epoch 5, Itrs 0/23, Loss=1.673935, StdLoss=1.6739, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=172.11 , LR=0.00090874
[1-1 / step 0] Epoch 5, Itrs 10/23, Loss=1.614023, StdLoss=1.6140, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=167.54 , LR=0.00090083
[1-1 / step 0] Epoch 5, Itrs 20/23, Loss=1.552817, StdLoss=1.5528, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=163.64 , LR=0.00089291
[1-1 / step 0] Epoch 6, Itrs 0/23, Loss=1.538974, StdLoss=1.5390, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=162.57 , LR=0.00089053
[1-1 / step 0] Epoch 6, Itrs 10/23, Loss=1.504677, StdLoss=1.5047, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=159.36 , LR=0.00088260
[1-1 / step 0] Epoch 6, Itrs 20/23, Loss=1.472173, StdLoss=1.4722, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=156.57 , LR=0.00087466
[1-1 / step 0] Epoch 7, Itrs 0/23, Loss=1.459005, StdLoss=1.4590, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=155.81 , LR=0.00087227
[1-1 / step 0] Epoch 7, Itrs 10/23, Loss=1.430492, StdLoss=1.4305, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=153.46 , LR=0.00086432
[1-1 / step 0] Epoch 7, Itrs 20/23, Loss=1.412723, StdLoss=1.4127, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=151.36 , LR=0.00085637
[1-1 / step 0] Epoch 8, Itrs 0/23, Loss=1.403369, StdLoss=1.4034, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=150.77 , LR=0.00085398
[1-1 / step 0] Epoch 8, Itrs 10/23, Loss=1.376071, StdLoss=1.3761, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=148.95 , LR=0.00084601
[1-1 / step 0] Epoch 8, Itrs 20/23, Loss=1.350003, StdLoss=1.3500, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=147.30 , LR=0.00083803
[1-1 / step 0] Epoch 9, Itrs 0/23, Loss=1.341119, StdLoss=1.3411, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=146.85 , LR=0.00083564
[1-1 / step 0] Epoch 9, Itrs 10/23, Loss=1.318256, StdLoss=1.3183, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=145.42 , LR=0.00082765
[1-1 / step 0] Epoch 9, Itrs 20/23, Loss=1.303899, StdLoss=1.3039, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=144.11 , LR=0.00081965
[Validation]
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:09,  1.78it/s] 22%|██▏       | 4/18 [00:00<00:01,  7.36it/s] 33%|███▎      | 6/18 [00:00<00:01,  7.97it/s] 50%|█████     | 9/18 [00:01<00:00,  9.14it/s] 72%|███████▏  | 13/18 [00:01<00:00, 10.45it/s] 94%|█████████▍| 17/18 [00:01<00:00, 11.41it/s]100%|██████████| 18/18 [00:01<00:00,  9.57it/s]
Total samples: 35.000000
Overall Acc: 0.869523
Mean Acc: 0.298700
FreqW Acc: 0.770598
Mean IoU: 0.257369
Class IoU:
	class 0: 0.9181369426961755
	class 1: 0.20158681837131706
	class 2: 0.7538697151040027
	class 3: 0.0
	class 4: 0.0
	class 5: 0.0
	class 6: 0.0
	class 7: 0.0
	class 8: 0.7378300937416509
	class 9: 0.017808917196998498
	class 10: 0.6621142833074712
	class 11: 0.4009526135773523
	class 12: 0.0
	class 13: 0.682980741900224
	class 14: X
	class 15: 0.0
	class 16: X
	class 17: 0.0
	class 18: 0.0
Class Acc:
	class 0: 0.9896699490129531
	class 1: 0.22892664840052146
	class 2: 0.9472862671127678
	class 3: 0.0
	class 4: 0.0
	class 5: 0.0
	class 6: 0.0
	class 7: 0.0
	class 8: 0.8158009929141886
	class 9: 0.018020572842351684
	class 10: 0.6801100700891137
	class 11: 0.5892941855171576
	class 12: 0.0
	class 13: 0.8087888146475496
	class 14: X
	class 15: 0.0
	class 16: X
	class 17: 0.0
	class 18: 0.0

curr_val_score : 0.9181

... save best ckpt :  0.9181369426961755

[1-1 / step 0] Epoch 10, Itrs 0/23, Loss=1.299642, StdLoss=1.2996, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=143.77 , LR=0.00081725
[1-1 / step 0] Epoch 10, Itrs 10/23, Loss=1.284589, StdLoss=1.2846, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=142.60 , LR=0.00080924
[1-1 / step 0] Epoch 10, Itrs 20/23, Loss=1.272687, StdLoss=1.2727, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=141.49 , LR=0.00080123
[1-1 / step 0] Epoch 11, Itrs 0/23, Loss=1.266907, StdLoss=1.2669, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=141.19 , LR=0.00079882
[1-1 / step 0] Epoch 11, Itrs 10/23, Loss=1.250459, StdLoss=1.2505, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=140.21 , LR=0.00079079
[1-1 / step 0] Epoch 11, Itrs 20/23, Loss=1.235134, StdLoss=1.2351, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=139.31 , LR=0.00078275
[1-1 / step 0] Epoch 12, Itrs 0/23, Loss=1.230673, StdLoss=1.2307, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=139.06 , LR=0.00078034
[1-1 / step 0] Epoch 12, Itrs 10/23, Loss=1.217604, StdLoss=1.2176, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=138.24 , LR=0.00077229
[1-1 / step 0] Epoch 12, Itrs 20/23, Loss=1.202204, StdLoss=1.2022, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=137.49 , LR=0.00076423
[1-1 / step 0] Epoch 13, Itrs 0/23, Loss=1.199552, StdLoss=1.1996, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=137.28 , LR=0.00076181
[1-1 / step 0] Epoch 13, Itrs 10/23, Loss=1.188268, StdLoss=1.1883, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=136.60 , LR=0.00075374
[1-1 / step 0] Epoch 13, Itrs 20/23, Loss=1.172584, StdLoss=1.1726, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=135.96 , LR=0.00074566
[1-1 / step 0] Epoch 14, Itrs 0/23, Loss=1.167710, StdLoss=1.1677, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=135.78 , LR=0.00074324
[1-1 / step 0] Epoch 14, Itrs 10/23, Loss=1.154031, StdLoss=1.1540, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=135.18 , LR=0.00073514
[1-1 / step 0] Epoch 14, Itrs 20/23, Loss=1.141436, StdLoss=1.1414, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=134.61 , LR=0.00072704
[Validation]
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:09,  1.79it/s] 28%|██▊       | 5/18 [00:00<00:01,  6.77it/s] 50%|█████     | 9/18 [00:01<00:00,  9.07it/s] 72%|███████▏  | 13/18 [00:01<00:00, 10.49it/s] 94%|█████████▍| 17/18 [00:01<00:00, 11.23it/s]100%|██████████| 18/18 [00:01<00:00,  9.38it/s]
Total samples: 35.000000
Overall Acc: 0.890275
Mean Acc: 0.339170
FreqW Acc: 0.809664
Mean IoU: 0.284855
Class IoU:
	class 0: 0.9480877979985932
	class 1: 0.4560844086558153
	class 2: 0.7848099367547711
	class 3: 0.0
	class 4: 0.0
	class 5: 0.0013990218409115724
	class 6: 0.0
	class 7: 0.0016292394166880484
	class 8: 0.7856167144590357
	class 9: 0.021497815057976346
	class 10: 0.6871280268236748
	class 11: 0.4346877071542411
	class 12: 0.0
	class 13: 0.7215908772453858
	class 14: X
	class 15: 0.0
	class 16: X
	class 17: 0.0
	class 18: 0.0
Class Acc:
	class 0: 0.9730115292312571
	class 1: 0.6743429297396163
	class 2: 0.933269413740055
	class 3: 0.0
	class 4: 0.0
	class 5: 0.0014013225705420997
	class 6: 0.0
	class 7: 0.0016292394166880484
	class 8: 0.8862035964605756
	class 9: 0.022068112093065865
	class 10: 0.7061601611359342
	class 11: 0.6894031668608321
	class 12: 0.0
	class 13: 0.8784061603098385
	class 14: X
	class 15: 0.0
	class 16: X
	class 17: 0.0
	class 18: 0.0

curr_val_score : 0.9481

... save best ckpt :  0.9480877979985932

[1-1 / step 0] Epoch 15, Itrs 0/23, Loss=1.138587, StdLoss=1.1386, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=134.47 , LR=0.00072461
[1-1 / step 0] Epoch 15, Itrs 10/23, Loss=1.127308, StdLoss=1.1273, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=133.94 , LR=0.00071649
[1-1 / step 0] Epoch 15, Itrs 20/23, Loss=1.115063, StdLoss=1.1151, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=133.44 , LR=0.00070836
[1-1 / step 0] Epoch 16, Itrs 0/23, Loss=1.111993, StdLoss=1.1120, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=133.30 , LR=0.00070592
[1-1 / step 0] Epoch 16, Itrs 10/23, Loss=1.104330, StdLoss=1.1043, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=132.85 , LR=0.00069778
[1-1 / step 0] Epoch 16, Itrs 20/23, Loss=1.096878, StdLoss=1.0969, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=132.43 , LR=0.00068963
[1-1 / step 0] Epoch 17, Itrs 0/23, Loss=1.093752, StdLoss=1.0938, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=132.30 , LR=0.00068719
[1-1 / step 0] Epoch 17, Itrs 10/23, Loss=1.085446, StdLoss=1.0854, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=131.90 , LR=0.00067902
[1-1 / step 0] Epoch 17, Itrs 20/23, Loss=1.079187, StdLoss=1.0792, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=131.49 , LR=0.00067085
[1-1 / step 0] Epoch 18, Itrs 0/23, Loss=1.076316, StdLoss=1.0763, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=131.38 , LR=0.00066839
[1-1 / step 0] Epoch 18, Itrs 10/23, Loss=1.068128, StdLoss=1.0681, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=131.02 , LR=0.00066020
[1-1 / step 0] Epoch 18, Itrs 20/23, Loss=1.061669, StdLoss=1.0617, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=130.68 , LR=0.00065200
[1-1 / step 0] Epoch 19, Itrs 0/23, Loss=1.058643, StdLoss=1.0586, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=130.58 , LR=0.00064954
[1-1 / step 0] Epoch 19, Itrs 10/23, Loss=1.051509, StdLoss=1.0515, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=130.25 , LR=0.00064132
[1-1 / step 0] Epoch 19, Itrs 20/23, Loss=1.042242, StdLoss=1.0422, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=129.93 , LR=0.00063309
[Validation]
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:07,  2.17it/s] 17%|█▋        | 3/18 [00:00<00:02,  5.78it/s] 33%|███▎      | 6/18 [00:00<00:01,  8.30it/s] 56%|█████▌    | 10/18 [00:01<00:00, 10.18it/s] 78%|███████▊  | 14/18 [00:01<00:00, 11.20it/s]100%|██████████| 18/18 [00:01<00:00, 14.37it/s]100%|██████████| 18/18 [00:01<00:00, 10.55it/s]
Total samples: 35.000000
Overall Acc: 0.867962
Mean Acc: 0.323543
FreqW Acc: 0.773612
Mean IoU: 0.270647
Class IoU:
	class 0: 0.9345995249836024
	class 1: 0.43562712231139106
	class 2: 0.7214266300315302
	class 3: 0.0
	class 4: 0.0
	class 5: 0.0037293432021745457
	class 6: 0.0
	class 7: 0.0
	class 8: 0.6994073907217992
	class 9: 0.004577990236877406
	class 10: 0.7482884690439598
	class 11: 0.36878889861814773
	class 12: 0.0
	class 13: 0.6845549620221197
	class 14: X
	class 15: 0.0
	class 16: X
	class 17: 0.0
	class 18: 0.0
Class Acc:
	class 0: 0.9693592961964534
	class 1: 0.5566018167179909
	class 2: 0.9313759531549819
	class 3: 0.0
	class 4: 0.0
	class 5: 0.003787045293944352
	class 6: 0.0
	class 7: 0.0
	class 8: 0.7513410602323295
	class 9: 0.0046662713654730395
	class 10: 0.9067557807120304
	class 11: 0.512814924027017
	class 12: 0.0
	class 13: 0.8635329915971974
	class 14: X
	class 15: 0.0
	class 16: X
	class 17: 0.0
	class 18: 0.0

curr_val_score : 0.9346


[1-1 / step 0] Epoch 20, Itrs 0/23, Loss=1.041177, StdLoss=1.0412, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=129.85 , LR=0.00063062
[1-1 / step 0] Epoch 20, Itrs 10/23, Loss=1.033237, StdLoss=1.0332, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=129.57 , LR=0.00062238
[1-1 / step 0] Epoch 20, Itrs 20/23, Loss=1.027130, StdLoss=1.0271, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=129.29 , LR=0.00061412
[1-1 / step 0] Epoch 21, Itrs 0/23, Loss=1.024488, StdLoss=1.0245, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=129.21 , LR=0.00061164
[1-1 / step 0] Epoch 21, Itrs 10/23, Loss=1.015952, StdLoss=1.0160, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=128.95 , LR=0.00060337
[1-1 / step 0] Epoch 21, Itrs 20/23, Loss=1.008748, StdLoss=1.0087, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=128.70 , LR=0.00059509
[1-1 / step 0] Epoch 22, Itrs 0/23, Loss=1.005317, StdLoss=1.0053, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=128.62 , LR=0.00059260
[1-1 / step 0] Epoch 22, Itrs 10/23, Loss=0.998662, StdLoss=0.9987, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=128.38 , LR=0.00058430
[1-1 / step 0] Epoch 22, Itrs 20/23, Loss=0.992909, StdLoss=0.9929, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=128.15 , LR=0.00057599
[1-1 / step 0] Epoch 23, Itrs 0/23, Loss=0.990767, StdLoss=0.9908, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=128.08 , LR=0.00057349
[1-1 / step 0] Epoch 23, Itrs 10/23, Loss=0.984188, StdLoss=0.9842, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=127.86 , LR=0.00056516
[1-1 / step 0] Epoch 23, Itrs 20/23, Loss=0.979112, StdLoss=0.9791, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=127.65 , LR=0.00055681
[1-1 / step 0] Epoch 24, Itrs 0/23, Loss=0.976992, StdLoss=0.9770, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=127.59 , LR=0.00055431
[1-1 / step 0] Epoch 24, Itrs 10/23, Loss=0.970749, StdLoss=0.9707, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=127.38 , LR=0.00054594
[1-1 / step 0] Epoch 24, Itrs 20/23, Loss=0.965825, StdLoss=0.9658, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=127.18 , LR=0.00053756
[Validation]
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:07,  2.19it/s] 17%|█▋        | 3/18 [00:00<00:02,  6.07it/s] 33%|███▎      | 6/18 [00:00<00:01,  9.33it/s] 44%|████▍     | 8/18 [00:00<00:00, 11.41it/s] 56%|█████▌    | 10/18 [00:01<00:00, 12.47it/s] 67%|██████▋   | 12/18 [00:01<00:00, 12.01it/s] 83%|████████▎ | 15/18 [00:01<00:00, 11.79it/s]100%|██████████| 18/18 [00:01<00:00, 11.03it/s]
Total samples: 35.000000
Overall Acc: 0.886342
Mean Acc: 0.354117
FreqW Acc: 0.802751
Mean IoU: 0.303181
Class IoU:
	class 0: 0.9481779284794215
	class 1: 0.4243850753585632
	class 2: 0.755615001358731
	class 3: 0.0
	class 4: 0.0
	class 5: 0.012612113830000974
	class 6: 0.0
	class 7: 0.15814176486517093
	class 8: 0.7517075730813495
	class 9: 0.11524465707159162
	class 10: 0.7891489553766075
	class 11: 0.4725455537687445
	class 12: 0.0
	class 13: 0.7265003100646137
	class 14: X
	class 15: 0.0
	class 16: X
	class 17: 0.0
	class 18: 0.0
Class Acc:
	class 0: 0.9815220842365381
	class 1: 0.5002203918632178
	class 2: 0.9579693710453906
	class 3: 0.0
	class 4: 0.0
	class 5: 0.013190962048326047
	class 6: 0.0
	class 7: 0.17017405707306665
	class 8: 0.8002642697503574
	class 9: 0.16084456933252095
	class 10: 0.8447701447573148
	class 11: 0.7438040899962332
	class 12: 0.0
	class 13: 0.8472361831882087
	class 14: X
	class 15: 0.0
	class 16: X
	class 17: 0.0
	class 18: 0.0

curr_val_score : 0.9482

... save best ckpt :  0.9481779284794215

[1-1 / step 0] Epoch 25, Itrs 0/23, Loss=0.964184, StdLoss=0.9642, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=127.13 , LR=0.00053505
[1-1 / step 0] Epoch 25, Itrs 10/23, Loss=0.959417, StdLoss=0.9594, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=126.94 , LR=0.00052665
[1-1 / step 0] Epoch 25, Itrs 20/23, Loss=0.954649, StdLoss=0.9546, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=126.77 , LR=0.00051824
[1-1 / step 0] Epoch 26, Itrs 0/23, Loss=0.952502, StdLoss=0.9525, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=126.72 , LR=0.00051571
[1-1 / step 0] Epoch 26, Itrs 10/23, Loss=0.950388, StdLoss=0.9504, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=126.55 , LR=0.00050728
[1-1 / step 0] Epoch 26, Itrs 20/23, Loss=0.945357, StdLoss=0.9454, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=126.38 , LR=0.00049884
[1-1 / step 0] Epoch 27, Itrs 0/23, Loss=0.943862, StdLoss=0.9439, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=126.34 , LR=0.00049630
[1-1 / step 0] Epoch 27, Itrs 10/23, Loss=0.938642, StdLoss=0.9386, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=126.17 , LR=0.00048783
[1-1 / step 0] Epoch 27, Itrs 20/23, Loss=0.934490, StdLoss=0.9345, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=126.02 , LR=0.00047935
[1-1 / step 0] Epoch 28, Itrs 0/23, Loss=0.932333, StdLoss=0.9323, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=125.98 , LR=0.00047680
[1-1 / step 0] Epoch 28, Itrs 10/23, Loss=0.928683, StdLoss=0.9287, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=125.83 , LR=0.00046829
[1-1 / step 0] Epoch 28, Itrs 20/23, Loss=0.922831, StdLoss=0.9228, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=125.69 , LR=0.00045977
[1-1 / step 0] Epoch 29, Itrs 0/23, Loss=0.920936, StdLoss=0.9209, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=125.64 , LR=0.00045721
[1-1 / step 0] Epoch 29, Itrs 10/23, Loss=0.916932, StdLoss=0.9169, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=125.50 , LR=0.00044866
[1-1 / step 0] Epoch 29, Itrs 20/23, Loss=0.913107, StdLoss=0.9131, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=125.36 , LR=0.00044010
[Validation]
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:09,  1.78it/s] 28%|██▊       | 5/18 [00:00<00:01,  6.90it/s] 50%|█████     | 9/18 [00:01<00:00,  9.24it/s] 72%|███████▏  | 13/18 [00:01<00:00, 10.54it/s] 94%|█████████▍| 17/18 [00:01<00:00, 11.24it/s]100%|██████████| 18/18 [00:01<00:00,  9.61it/s]
Total samples: 35.000000
Overall Acc: 0.903693
Mean Acc: 0.390236
FreqW Acc: 0.831225
Mean IoU: 0.331595
Class IoU:
	class 0: 0.9543871576956726
	class 1: 0.5265515975009963
	class 2: 0.8044709703286429
	class 3: 0.0
	class 4: 0.0
	class 5: 0.009282042268890527
	class 6: 0.0
	class 7: 0.15690947911621952
	class 8: 0.8016953681465944
	class 9: 0.21472438168701924
	class 10: 0.8025526852624527
	class 11: 0.46643947958926035
	class 12: 0.0
	class 13: 0.7553360002133339
	class 14: X
	class 15: 0.0
	class 16: X
	class 17: 0.0
	class 18: 0.14476178026633804
Class Acc:
	class 0: 0.9818827595196883
	class 1: 0.6815640043876063
	class 2: 0.9322943602143899
	class 3: 0.0
	class 4: 0.0
	class 5: 0.009786095637256813
	class 6: 0.0
	class 7: 0.17161321855780776
	class 8: 0.8789422956661399
	class 9: 0.2983577818376767
	class 10: 0.8544241665881974
	class 11: 0.7510994294409757
	class 12: 0.0
	class 13: 0.8957468195504943
	class 14: X
	class 15: 0.0
	class 16: X
	class 17: 0.0
	class 18: 0.17829831762228943

curr_val_score : 0.9544

... save best ckpt :  0.9543871576956726

[1-1 / step 0] Epoch 30, Itrs 0/23, Loss=0.912126, StdLoss=0.9121, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=125.33 , LR=0.00043753
[1-1 / step 0] Epoch 30, Itrs 10/23, Loss=0.907581, StdLoss=0.9076, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=125.20 , LR=0.00042894
[1-1 / step 0] Epoch 30, Itrs 20/23, Loss=0.903344, StdLoss=0.9033, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=125.07 , LR=0.00042033
[1-1 / step 0] Epoch 31, Itrs 0/23, Loss=0.901894, StdLoss=0.9019, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=125.04 , LR=0.00041774
[1-1 / step 0] Epoch 31, Itrs 10/23, Loss=0.897820, StdLoss=0.8978, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=124.92 , LR=0.00040911
[1-1 / step 0] Epoch 31, Itrs 20/23, Loss=0.894945, StdLoss=0.8949, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=124.80 , LR=0.00040046
[1-1 / step 0] Epoch 32, Itrs 0/23, Loss=0.893598, StdLoss=0.8936, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=124.76 , LR=0.00039786
[1-1 / step 0] Epoch 32, Itrs 10/23, Loss=0.889757, StdLoss=0.8898, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=124.65 , LR=0.00038918
[1-1 / step 0] Epoch 32, Itrs 20/23, Loss=0.886269, StdLoss=0.8863, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=124.53 , LR=0.00038047
[1-1 / step 0] Epoch 33, Itrs 0/23, Loss=0.885636, StdLoss=0.8856, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=124.50 , LR=0.00037786
[1-1 / step 0] Epoch 33, Itrs 10/23, Loss=0.882621, StdLoss=0.8826, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=124.39 , LR=0.00036913
[1-1 / step 0] Epoch 33, Itrs 20/23, Loss=0.879839, StdLoss=0.8798, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=124.29 , LR=0.00036037
[1-1 / step 0] Epoch 34, Itrs 0/23, Loss=0.878818, StdLoss=0.8788, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=124.26 , LR=0.00035774
[1-1 / step 0] Epoch 34, Itrs 10/23, Loss=0.876180, StdLoss=0.8762, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=124.17 , LR=0.00034896
[1-1 / step 0] Epoch 34, Itrs 20/23, Loss=0.872722, StdLoss=0.8727, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=124.07 , LR=0.00034015
[Validation]
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:08,  2.07it/s] 17%|█▋        | 3/18 [00:00<00:02,  5.64it/s] 33%|███▎      | 6/18 [00:00<00:01,  8.19it/s] 56%|█████▌    | 10/18 [00:01<00:00, 10.09it/s] 78%|███████▊  | 14/18 [00:01<00:00, 11.12it/s]100%|██████████| 18/18 [00:01<00:00, 14.33it/s]100%|██████████| 18/18 [00:01<00:00, 10.24it/s]
Total samples: 35.000000
Overall Acc: 0.901482
Mean Acc: 0.397307
FreqW Acc: 0.828045
Mean IoU: 0.335887
Class IoU:
	class 0: 0.9515189424296976
	class 1: 0.5168993621302725
	class 2: 0.7992413065621392
	class 3: 0.0
	class 4: 0.0
	class 5: 0.021423315462825363
	class 6: 0.0
	class 7: 0.20079447649198917
	class 8: 0.7958855406046949
	class 9: 0.2548304492850386
	class 10: 0.8175749515185209
	class 11: 0.48645964160131294
	class 12: 0.0
	class 13: 0.7395244278738093
	class 14: X
	class 15: 0.0
	class 16: X
	class 17: 0.0
	class 18: 0.1259222823344853
Class Acc:
	class 0: 0.983477732978535
	class 1: 0.7010751665872921
	class 2: 0.9291447117896354
	class 3: 0.0
	class 4: 0.0
	class 5: 0.02360244131210578
	class 6: 0.0
	class 7: 0.23059168544191513
	class 8: 0.8650056007780834
	class 9: 0.33865271081134724
	class 10: 0.8942457350360264
	class 11: 0.7598051157028041
	class 12: 0.0
	class 13: 0.8431494730694601
	class 14: X
	class 15: 0.0
	class 16: X
	class 17: 0.0
	class 18: 0.1854624486689638

curr_val_score : 0.9515


[1-1 / step 0] Epoch 35, Itrs 0/23, Loss=0.871561, StdLoss=0.8716, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=124.04 , LR=0.00033750
[1-1 / step 0] Epoch 35, Itrs 10/23, Loss=0.868076, StdLoss=0.8681, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=123.94 , LR=0.00032866
[1-1 / step 0] Epoch 35, Itrs 20/23, Loss=0.864062, StdLoss=0.8641, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=123.85 , LR=0.00031979
[1-1 / step 0] Epoch 36, Itrs 0/23, Loss=0.862382, StdLoss=0.8624, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=123.82 , LR=0.00031712
[1-1 / step 0] Epoch 36, Itrs 10/23, Loss=0.859727, StdLoss=0.8597, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=123.74 , LR=0.00030822
[1-1 / step 0] Epoch 36, Itrs 20/23, Loss=0.856171, StdLoss=0.8562, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=123.65 , LR=0.00029928
[1-1 / step 0] Epoch 37, Itrs 0/23, Loss=0.856135, StdLoss=0.8561, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=123.63 , LR=0.00029660
[1-1 / step 0] Epoch 37, Itrs 10/23, Loss=0.853201, StdLoss=0.8532, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=123.54 , LR=0.00028762
[1-1 / step 0] Epoch 37, Itrs 20/23, Loss=0.849978, StdLoss=0.8500, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=123.46 , LR=0.00027862
[1-1 / step 0] Epoch 38, Itrs 0/23, Loss=0.849020, StdLoss=0.8490, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=123.43 , LR=0.00027591
[1-1 / step 0] Epoch 38, Itrs 10/23, Loss=0.845862, StdLoss=0.8459, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=123.34 , LR=0.00026687
[1-1 / step 0] Epoch 38, Itrs 20/23, Loss=0.842331, StdLoss=0.8423, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=123.26 , LR=0.00025779
[1-1 / step 0] Epoch 39, Itrs 0/23, Loss=0.841505, StdLoss=0.8415, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=123.24 , LR=0.00025505
[1-1 / step 0] Epoch 39, Itrs 10/23, Loss=0.838476, StdLoss=0.8385, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=123.17 , LR=0.00024593
[1-1 / step 0] Epoch 39, Itrs 20/23, Loss=0.834788, StdLoss=0.8348, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=123.09 , LR=0.00023676
[Validation]
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:10,  1.70it/s] 22%|██▏       | 4/18 [00:00<00:01,  7.12it/s] 33%|███▎      | 6/18 [00:00<00:01,  7.71it/s] 50%|█████     | 9/18 [00:01<00:01,  8.95it/s] 72%|███████▏  | 13/18 [00:01<00:00, 10.38it/s] 94%|█████████▍| 17/18 [00:01<00:00, 11.22it/s]100%|██████████| 18/18 [00:01<00:00,  9.38it/s]
Total samples: 35.000000
Overall Acc: 0.904176
Mean Acc: 0.400799
FreqW Acc: 0.832260
Mean IoU: 0.341461
Class IoU:
	class 0: 0.9538632925685461
	class 1: 0.5271559027953286
	class 2: 0.7994910363479146
	class 3: 0.0
	class 4: 0.0
	class 5: 0.028714363332253023
	class 6: 0.0
	class 7: 0.22506540743570788
	class 8: 0.8065782354004473
	class 9: 0.17128100547134348
	class 10: 0.8222095532822264
	class 11: 0.5052027269423219
	class 12: 0.0
	class 13: 0.7517256255378231
	class 14: X
	class 15: 0.0
	class 16: X
	class 17: 0.0
	class 18: 0.2135549871986218
Class Acc:
	class 0: 0.9841446800105054
	class 1: 0.697739038742739
	class 2: 0.9267256978787332
	class 3: 0.0
	class 4: 0.0
	class 5: 0.03243888033130927
	class 6: 0.0
	class 7: 0.28731637113293734
	class 8: 0.8723627401395896
	class 9: 0.19920596044757002
	class 10: 0.8729489018400806
	class 11: 0.7762548881239022
	class 12: 0.0
	class 13: 0.8955853524283846
	class 14: X
	class 15: 0.0
	class 16: X
	class 17: 0.0
	class 18: 0.2688561538864319

curr_val_score : 0.9539


[1-1 / step 0] Epoch 40, Itrs 0/23, Loss=0.833752, StdLoss=0.8338, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=123.07 , LR=0.00023400
[1-1 / step 0] Epoch 40, Itrs 10/23, Loss=0.829960, StdLoss=0.8300, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=122.99 , LR=0.00022479
[1-1 / step 0] Epoch 40, Itrs 20/23, Loss=0.826743, StdLoss=0.8267, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=122.91 , LR=0.00021553
[1-1 / step 0] Epoch 41, Itrs 0/23, Loss=0.825514, StdLoss=0.8255, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=122.90 , LR=0.00021274
[1-1 / step 0] Epoch 41, Itrs 10/23, Loss=0.821914, StdLoss=0.8219, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=122.83 , LR=0.00020342
[1-1 / step 0] Epoch 41, Itrs 20/23, Loss=0.819074, StdLoss=0.8191, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=122.77 , LR=0.00019406
[1-1 / step 0] Epoch 42, Itrs 0/23, Loss=0.818549, StdLoss=0.8185, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=122.75 , LR=0.00019124
[1-1 / step 0] Epoch 42, Itrs 10/23, Loss=0.816758, StdLoss=0.8168, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=122.68 , LR=0.00018181
[1-1 / step 0] Epoch 42, Itrs 20/23, Loss=0.814890, StdLoss=0.8149, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=122.62 , LR=0.00017232
[1-1 / step 0] Epoch 43, Itrs 0/23, Loss=0.814169, StdLoss=0.8142, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=122.60 , LR=0.00016946
[1-1 / step 0] Epoch 43, Itrs 10/23, Loss=0.811597, StdLoss=0.8116, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=122.53 , LR=0.00015990
[1-1 / step 0] Epoch 43, Itrs 20/23, Loss=0.809657, StdLoss=0.8097, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=122.48 , LR=0.00015028
[1-1 / step 0] Epoch 44, Itrs 0/23, Loss=0.808716, StdLoss=0.8087, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=122.46 , LR=0.00014737
[1-1 / step 0] Epoch 44, Itrs 10/23, Loss=0.806778, StdLoss=0.8068, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=122.41 , LR=0.00013766
[1-1 / step 0] Epoch 44, Itrs 20/23, Loss=0.803968, StdLoss=0.8040, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=122.35 , LR=0.00012786
[Validation]
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:08,  2.04it/s] 22%|██▏       | 4/18 [00:00<00:01,  7.94it/s] 33%|███▎      | 6/18 [00:00<00:01, 10.35it/s] 44%|████▍     | 8/18 [00:00<00:00, 10.74it/s] 61%|██████    | 11/18 [00:01<00:00, 10.62it/s] 83%|████████▎ | 15/18 [00:01<00:00, 11.53it/s]100%|██████████| 18/18 [00:01<00:00, 10.97it/s]
Total samples: 35.000000
Overall Acc: 0.910706
Mean Acc: 0.418525
FreqW Acc: 0.843546
Mean IoU: 0.354071
Class IoU:
	class 0: 0.9598185254384427
	class 1: 0.5689741356797786
	class 2: 0.8158368482397363
	class 3: 0.0
	class 4: 0.0
	class 5: 0.02403238588874813
	class 6: 0.0
	class 7: 0.22153248858267136
	class 8: 0.8233363713671927
	class 9: 0.2729260318701895
	class 10: 0.8263163543970081
	class 11: 0.49742782684792514
	class 12: 0.0
	class 13: 0.7561296695670149
	class 14: X
	class 15: 0.0
	class 16: X
	class 17: 0.0
	class 18: 0.2528722426325326
Class Acc:
	class 0: 0.9784383537430126
	class 1: 0.7820929448640827
	class 2: 0.9210757373739112
	class 3: 0.0
	class 4: 0.0
	class 5: 0.02598816403550803
	class 6: 0.0
	class 7: 0.28199418903842305
	class 8: 0.9179642257053189
	class 9: 0.344350202368085
	class 10: 0.8810413932694453
	class 11: 0.7537662670587376
	class 12: 0.0
	class 13: 0.8738623390425821
	class 14: X
	class 15: 0.0
	class 16: X
	class 17: 0.0
	class 18: 0.35434275131978243

curr_val_score : 0.9598

... save best ckpt :  0.9598185254384427

[1-1 / step 0] Epoch 45, Itrs 0/23, Loss=0.803480, StdLoss=0.8035, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=122.33 , LR=0.00012491
[1-1 / step 0] Epoch 45, Itrs 10/23, Loss=0.800481, StdLoss=0.8005, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=122.28 , LR=0.00011500
[1-1 / step 0] Epoch 45, Itrs 20/23, Loss=0.797618, StdLoss=0.7976, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=122.22 , LR=0.00010500
[1-1 / step 0] Epoch 46, Itrs 0/23, Loss=0.796955, StdLoss=0.7970, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=122.20 , LR=0.00010198
[1-1 / step 0] Epoch 46, Itrs 10/23, Loss=0.794097, StdLoss=0.7941, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=122.15 , LR=0.00009184
[1-1 / step 0] Epoch 46, Itrs 20/23, Loss=0.791940, StdLoss=0.7919, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=122.09 , LR=0.00008157
[1-1 / step 0] Epoch 47, Itrs 0/23, Loss=0.791677, StdLoss=0.7917, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=122.08 , LR=0.00007846
[1-1 / step 0] Epoch 47, Itrs 10/23, Loss=0.790001, StdLoss=0.7900, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=122.03 , LR=0.00006799
[1-1 / step 0] Epoch 47, Itrs 20/23, Loss=0.787657, StdLoss=0.7877, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=121.98 , LR=0.00005734
[1-1 / step 0] Epoch 48, Itrs 0/23, Loss=0.786900, StdLoss=0.7869, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=121.96 , LR=0.00005411
[1-1 / step 0] Epoch 48, Itrs 10/23, Loss=0.783835, StdLoss=0.7838, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=121.91 , LR=0.00004316
[1-1 / step 0] Epoch 48, Itrs 20/23, Loss=0.781609, StdLoss=0.7816, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=121.87 , LR=0.00003188
[1-1 / step 0] Epoch 49, Itrs 0/23, Loss=0.781007, StdLoss=0.7810, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=121.85 , LR=0.00002842
[1-1 / step 0] Epoch 49, Itrs 10/23, Loss=0.778141, StdLoss=0.7781, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=121.80 , LR=0.00001647
[1-1 / step 0] Epoch 49, Itrs 20/23, Loss=0.775123, StdLoss=0.7751, A1=0.0000, A2=0.0000, A3=0.0000, A4=0.0000 Time=121.75 , LR=0.00000328
[Validation]
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:07,  2.19it/s] 17%|█▋        | 3/18 [00:00<00:02,  6.06it/s] 33%|███▎      | 6/18 [00:00<00:01,  8.83it/s] 56%|█████▌    | 10/18 [00:01<00:00, 12.02it/s] 78%|███████▊  | 14/18 [00:01<00:00, 13.71it/s]100%|██████████| 18/18 [00:01<00:00, 17.73it/s]100%|██████████| 18/18 [00:01<00:00, 11.90it/s]

Total samples: 35.000000
Overall Acc: 0.910459
Mean Acc: 0.418551
FreqW Acc: 0.842915
Mean IoU: 0.353217
Class IoU:
	class 0: 0.9598424234587419
	class 1: 0.5624117928846399
	class 2: 0.8146584667842366
	class 3: 0.0
	class 4: 0.0
	class 5: 0.013311549468598215
	class 6: 0.0
	class 7: 0.2287372380391459
	class 8: 0.8236179253057934
	class 9: 0.25392495485803585
	class 10: 0.8225813422960198
	class 11: 0.5057064548659241
	class 12: 0.0
	class 13: 0.7564851382035991
	class 14: X
	class 15: 0.0
	class 16: X
	class 17: 0.0
	class 18: 0.2634086196119818
Class Acc:
	class 0: 0.9789418023226053
	class 1: 0.7508318712533346
	class 2: 0.9252565612862707
	class 3: 0.0
	class 4: 0.0
	class 5: 0.014059550418496769
	class 6: 0.0
	class 7: 0.2889727645399035
	class 8: 0.9096351065501177
	class 9: 0.3335739513693683
	class 10: 0.8712118900090762
	class 11: 0.7641130841622654
	class 12: 0.0
	class 13: 0.9004316402764944
	class 14: X
	class 15: 0.0
	class 16: X
	class 17: 0.0
	class 18: 0.37833051594797307

curr_val_score : 0.9598

... save best ckpt :  0.9598424234587419
... Training Done
nohup: ignoring input
Available GPUs: 1
[1, 1]
[1, 0, 1]
==============================================
  task : 1-1
  step : 1
  Device: cuda
Namespace(amp=True, batch_size=6, bn_freeze=True, buffer=16384, cil_step=0, ckpt=None, crop_size=513, crop_val=True, curr_itrs=0, curr_step=1, data_root='/data/yt/BARM2/data_root/cityscapes', dataset='cityscapes_domain', gamma=10, gpu_id='1', initial=False, local_rank=0, loss_type='bce_loss', lr=0.01, lr_policy='poly', method='acil', model='deeplabv3_resnet101', num_classes=[1, 0, 1], output_stride=16, overlap=False, print_interval=10, pseudo=True, pseudo_thresh=0.7, random_seed=1, separable_conv=False, setting='overlap', step_size=10000, subpath='BARM', target_cls=[[0], [1]], task='1-1', test_only=False, train_epoch=50, unknown=0, val_batch_size=2, val_interval=100, weight_decay=0.0001)
==============================================
Category components: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
checkpoints/BARM/1-1/overlap/step0/deeplabv3_resnet101_cityscapes_domain_1-1_step_0_overlap.pth
Model restored from checkpoints/BARM/1-1/overlap/step0/deeplabv3_resnet101_cityscapes_domain_1-1_step_0_overlap.pth
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
Dataset: cityscapes_domain, Train set: 252, Val set: 98, Test set: 98
... train epoch : 50 , iterations : 2100 , val_interval : 100
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
Dataset: cityscapes_domain, Train set: 139, Val set: 35, Test set: 35
[Testing Best Model]
  0%|          | 0/49 [00:00<?, ?it/s]  2%|▏         | 1/49 [00:02<01:38,  2.04s/it]  6%|▌         | 3/49 [00:02<00:26,  1.71it/s] 10%|█         | 5/49 [00:02<00:14,  3.13it/s] 14%|█▍        | 7/49 [00:02<00:08,  4.67it/s] 18%|█▊        | 9/49 [00:02<00:06,  6.25it/s] 22%|██▏       | 11/49 [00:02<00:04,  7.69it/s] 27%|██▋       | 13/49 [00:02<00:03,  9.02it/s] 31%|███       | 15/49 [00:03<00:03, 10.22it/s] 35%|███▍      | 17/49 [00:03<00:02, 11.22it/s] 39%|███▉      | 19/49 [00:03<00:02, 11.75it/s] 43%|████▎     | 21/49 [00:03<00:02, 12.21it/s] 47%|████▋     | 23/49 [00:03<00:02, 12.48it/s] 51%|█████     | 25/49 [00:03<00:01, 12.97it/s] 55%|█████▌    | 27/49 [00:03<00:01, 13.10it/s] 59%|█████▉    | 29/49 [00:04<00:01, 13.23it/s] 63%|██████▎   | 31/49 [00:04<00:01, 13.33it/s] 67%|██████▋   | 33/49 [00:04<00:01, 12.21it/s] 71%|███████▏  | 35/49 [00:04<00:01, 12.46it/s] 76%|███████▌  | 37/49 [00:04<00:00, 12.07it/s] 80%|███████▉  | 39/49 [00:04<00:00, 12.52it/s] 84%|████████▎ | 41/49 [00:05<00:00, 12.10it/s] 88%|████████▊ | 43/49 [00:05<00:00, 12.53it/s] 92%|█████████▏| 45/49 [00:05<00:00, 12.27it/s] 96%|█████████▌| 47/49 [00:05<00:00, 12.82it/s]100%|██████████| 49/49 [00:05<00:00, 12.58it/s]100%|██████████| 49/49 [00:05<00:00,  8.45it/s]
Total samples: 98.000000
Overall Acc: 0.881849
Mean Acc: 0.399616
FreqW Acc: 0.801309
Mean IoU: 0.321669
Class IoU:
	class 0: 0.9352000644328012
	class 1: 0.443880559318764
	class 2: 0.747630135665754
	class 3: 0.07136192968320942
	class 4: 0.03834488992449548
	class 5: 0.009154552395533054
	class 6: 0.0
	class 7: 0.10752458505666779
	class 8: 0.7897295818257242
	class 9: 0.09307700462880816
	class 10: 0.7936120510547414
	class 11: 0.3778437902051849
	class 12: 0.07849352285548503
	class 13: 0.7082526403473428
	class 14: 0.0
	class 15: 0.539874067278581
	class 16: 0.0
	class 17: 0.0
	class 18: 0.3777244730375795
Class Acc:
	class 0: 0.9424352001535689
	class 1: 0.7188123196227437
	class 2: 0.9026852203816706
	class 3: 0.07475209763361099
	class 4: 0.0403686266648256
	class 5: 0.009455949400824528
	class 6: 0.0
	class 7: 0.12292696823430675
	class 8: 0.9152824903291179
	class 9: 0.10582440012129488
	class 10: 0.8943290436842242
	class 11: 0.5646386220046448
	class 12: 0.10596677740582149
	class 13: 0.8586702760570621
	class 14: 0.0
	class 15: 0.7455088673250274
	class 16: 0.0
	class 17: 0.0
	class 18: 0.5910565825885655

...from 0 to 18 : best/test_before_mIoU : 0.321669
...from 0 to 18 : best/test_before_acc : 0.399616

... Training Done
[Testing Best Model]
  0%|          | 0/49 [00:00<?, ?it/s]  2%|▏         | 1/49 [00:00<00:27,  1.72it/s]  6%|▌         | 3/49 [00:00<00:09,  4.84it/s] 10%|█         | 5/49 [00:00<00:06,  7.28it/s] 14%|█▍        | 7/49 [00:01<00:04,  9.09it/s] 18%|█▊        | 9/49 [00:01<00:04,  9.70it/s] 22%|██▏       | 11/49 [00:01<00:03, 10.83it/s] 27%|██▋       | 13/49 [00:01<00:03, 11.38it/s] 31%|███       | 15/49 [00:01<00:02, 12.16it/s] 35%|███▍      | 17/49 [00:01<00:02, 11.84it/s] 39%|███▉      | 19/49 [00:01<00:02, 12.48it/s] 43%|████▎     | 21/49 [00:02<00:02, 12.10it/s] 47%|████▋     | 23/49 [00:02<00:02, 12.70it/s] 51%|█████     | 25/49 [00:02<00:01, 12.15it/s] 55%|█████▌    | 27/49 [00:02<00:01, 12.70it/s] 59%|█████▉    | 29/49 [00:02<00:01, 11.96it/s] 63%|██████▎   | 31/49 [00:02<00:01, 12.56it/s] 67%|██████▋   | 33/49 [00:03<00:01, 11.35it/s] 71%|███████▏  | 35/49 [00:03<00:01, 12.13it/s] 76%|███████▌  | 37/49 [00:03<00:01, 11.81it/s] 80%|███████▉  | 39/49 [00:03<00:00, 12.48it/s] 84%|████████▎ | 41/49 [00:03<00:00, 12.07it/s] 88%|████████▊ | 43/49 [00:03<00:00, 12.67it/s] 92%|█████████▏| 45/49 [00:04<00:00, 12.12it/s] 96%|█████████▌| 47/49 [00:04<00:00, 12.75it/s]100%|██████████| 49/49 [00:04<00:00, 12.14it/s]100%|██████████| 49/49 [00:04<00:00, 10.89it/s]
Total samples: 98.000000
Overall Acc: 0.888998
Mean Acc: 0.423917
FreqW Acc: 0.811435
Mean IoU: 0.349834
Class IoU:
	class 0: 0.9453227677875091
	class 1: 0.48976774523058747
	class 2: 0.7576544260962468
	class 3: 0.09170604914717141
	class 4: 0.08058715866270028
	class 5: 0.01961277817005149
	class 6: 0.05196858052936532
	class 7: 0.1220204313269371
	class 8: 0.794180126985316
	class 9: 0.15558152076110301
	class 10: 0.7939987247669154
	class 11: 0.37435777296517286
	class 12: 0.14975273026736463
	class 13: 0.7159061543008975
	class 14: 0.0
	class 15: 0.551606331278746
	class 16: 0.06791040861525169
	class 17: 0.06390788052796632
	class 18: 0.42099592131228175
Class Acc:
	class 0: 0.9560396412840003
	class 1: 0.7135123167013694
	class 2: 0.8951976476200515
	class 3: 0.092510488174759
	class 4: 0.10971150956488893
	class 5: 0.020485274614815294
	class 6: 0.05592337685981411
	class 7: 0.13781209938202987
	class 8: 0.9242217946729352
	class 9: 0.18083123061200534
	class 10: 0.8984573926706061
	class 11: 0.5241097734041852
	class 12: 0.23178737540912192
	class 13: 0.8492133951247681
	class 14: 0.0
	class 15: 0.6741103918231084
	class 16: 0.0715114245195163
	class 17: 0.06453019402190754
	class 18: 0.6544620619439572

...from 0 to 18 : best/test_before_mIoU : 0.349834
...from 0 to 18 : best/test_before_acc : 0.423917
[1, 1, 1]
[1, 0, 1, 1]
==============================================
  task : 1-1
  step : 2
  Device: cuda
Namespace(amp=True, batch_size=6, bn_freeze=True, buffer=16384, cil_step=0, ckpt=None, crop_size=513, crop_val=True, curr_itrs=0, curr_step=2, data_root='/data/yt/BARM2/data_root/cityscapes', dataset='cityscapes_domain', gamma=10, gpu_id='1', initial=False, local_rank=0, loss_type='bce_loss', lr=0.01, lr_policy='poly', method='acil', model='deeplabv3_resnet101', num_classes=[1, 0, 1, 1], output_stride=16, overlap=False, print_interval=10, pseudo=True, pseudo_thresh=0.7, random_seed=1, separable_conv=False, setting='overlap', step_size=10000, subpath='BARM', target_cls=[[0], [1], [2]], task='1-1', test_only=False, train_epoch=50, unknown=0, val_batch_size=2, val_interval=100, weight_decay=0.0001)
==============================================
Category components: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
checkpoints/BARM/1-1/overlap/step1/final.pth
Model restored from checkpoints/BARM/1-1/overlap/step1/final.pth
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
Dataset: cityscapes_domain, Train set: 68, Val set: 115, Test set: 115
... train epoch : 50 , iterations : 550 , val_interval : 100

... Training Done
[Testing Best Model]
  0%|          | 0/58 [00:00<?, ?it/s]  2%|▏         | 1/58 [00:00<00:34,  1.65it/s]  5%|▌         | 3/58 [00:00<00:11,  4.63it/s]  9%|▊         | 5/58 [00:00<00:07,  7.14it/s] 12%|█▏        | 7/58 [00:01<00:05,  9.10it/s] 16%|█▌        | 9/58 [00:01<00:04,  9.91it/s] 19%|█▉        | 11/58 [00:01<00:04, 11.14it/s] 22%|██▏       | 13/58 [00:01<00:04, 11.21it/s] 26%|██▌       | 15/58 [00:01<00:03, 12.12it/s] 29%|██▉       | 17/58 [00:01<00:03, 11.77it/s] 33%|███▎      | 19/58 [00:01<00:03, 12.54it/s] 36%|███▌      | 21/58 [00:02<00:03, 11.95it/s] 40%|███▉      | 23/58 [00:02<00:02, 12.65it/s] 43%|████▎     | 25/58 [00:02<00:02, 12.42it/s] 47%|████▋     | 27/58 [00:02<00:02, 13.02it/s] 50%|█████     | 29/58 [00:02<00:02, 12.54it/s] 53%|█████▎    | 31/58 [00:02<00:02, 13.09it/s] 57%|█████▋    | 33/58 [00:03<00:01, 13.47it/s] 60%|██████    | 35/58 [00:03<00:01, 12.97it/s] 64%|██████▍   | 37/58 [00:03<00:01, 13.41it/s] 67%|██████▋   | 39/58 [00:03<00:01, 11.80it/s] 71%|███████   | 41/58 [00:03<00:01, 12.51it/s] 74%|███████▍  | 43/58 [00:03<00:01, 12.04it/s] 78%|███████▊  | 45/58 [00:04<00:01, 12.71it/s] 81%|████████  | 47/58 [00:04<00:00, 11.99it/s] 84%|████████▍ | 49/58 [00:04<00:00, 12.65it/s] 88%|████████▊ | 51/58 [00:04<00:00, 12.08it/s] 91%|█████████▏| 53/58 [00:04<00:00, 12.68it/s] 95%|█████████▍| 55/58 [00:04<00:00, 12.20it/s] 98%|█████████▊| 57/58 [00:04<00:00, 12.79it/s]100%|██████████| 58/58 [00:06<00:00,  8.66it/s]
Total samples: 115.000000
Overall Acc: 0.884392
Mean Acc: 0.444586
FreqW Acc: 0.804486
Mean IoU: 0.371550
Class IoU:
	class 0: 0.9407485292054526
	class 1: 0.4510537585729985
	class 2: 0.7522241647707214
	class 3: 0.0809761789979204
	class 4: 0.07117108588105499
	class 5: 0.021085640138348304
	class 6: 0.07037873301089807
	class 7: 0.13897032386440406
	class 8: 0.7846255407183796
	class 9: 0.4724114540769328
	class 10: 0.8064111715515023
	class 11: 0.3669100055195259
	class 12: 0.126210729605546
	class 13: 0.6835538119597777
	class 14: 0.03975026421811269
	class 15: 0.34119802160318013
	class 16: 0.4946542101877195
	class 17: 0.028177089731409383
	class 18: 0.3889443889416332
Class Acc:
	class 0: 0.9519290953100192
	class 1: 0.6880464332309046
	class 2: 0.9008704451608238
	class 3: 0.08203968335349955
	class 4: 0.09519866743203033
	class 5: 0.021963690255585137
	class 6: 0.07535465036547564
	class 7: 0.16188113628362116
	class 8: 0.9145407968155799
	class 9: 0.5451083365922886
	class 10: 0.9003847297914099
	class 11: 0.5344677917600629
	class 12: 0.16013842124653688
	class 13: 0.8386967680615811
	class 14: 0.041008763073112936
	class 15: 0.3928375585104468
	class 16: 0.5213297711841112
	class 17: 0.02877336790478134
	class 18: 0.5925670059628829

...from 0 to 18 : best/test_before_mIoU : 0.371550
...from 0 to 18 : best/test_before_acc : 0.444586
[1, 1, 1, 1]
[1, 0, 1, 1, 1]
==============================================
  task : 1-1
  step : 3
  Device: cuda
Namespace(amp=True, batch_size=6, bn_freeze=True, buffer=16384, cil_step=0, ckpt=None, crop_size=513, crop_val=True, curr_itrs=0, curr_step=3, data_root='/data/yt/BARM2/data_root/cityscapes', dataset='cityscapes_domain', gamma=10, gpu_id='1', initial=False, local_rank=0, loss_type='bce_loss', lr=0.01, lr_policy='poly', method='acil', model='deeplabv3_resnet101', num_classes=[1, 0, 1, 1, 1], output_stride=16, overlap=False, print_interval=10, pseudo=True, pseudo_thresh=0.7, random_seed=1, separable_conv=False, setting='overlap', step_size=10000, subpath='BARM', target_cls=[[0], [1], [2], [3]], task='1-1', test_only=False, train_epoch=50, unknown=0, val_batch_size=2, val_interval=100, weight_decay=0.0001)
==============================================
Category components: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
checkpoints/BARM/1-1/overlap/step2/final.pth
Model restored from checkpoints/BARM/1-1/overlap/step2/final.pth
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
Dataset: cityscapes_domain, Train set: 87, Val set: 137, Test set: 137
... train epoch : 50 , iterations : 700 , val_interval : 100

... Training Done
[Testing Best Model]
  0%|          | 0/69 [00:00<?, ?it/s]  1%|▏         | 1/69 [00:00<00:41,  1.65it/s]  4%|▍         | 3/69 [00:00<00:14,  4.68it/s]  7%|▋         | 5/69 [00:00<00:08,  7.16it/s] 10%|█         | 7/69 [00:01<00:06,  9.12it/s] 13%|█▎        | 9/69 [00:01<00:06,  9.88it/s] 16%|█▌        | 11/69 [00:01<00:05, 11.13it/s] 19%|█▉        | 13/69 [00:01<00:04, 11.91it/s] 22%|██▏       | 15/69 [00:01<00:04, 12.67it/s] 25%|██▍       | 17/69 [00:01<00:03, 13.21it/s] 28%|██▊       | 19/69 [00:01<00:03, 13.60it/s] 30%|███       | 21/69 [00:02<00:03, 13.89it/s] 33%|███▎      | 23/69 [00:02<00:03, 13.22it/s] 36%|███▌      | 25/69 [00:02<00:03, 13.55it/s] 39%|███▉      | 27/69 [00:02<00:03, 12.80it/s] 42%|████▏     | 29/69 [00:02<00:03, 13.28it/s] 45%|████▍     | 31/69 [00:02<00:03, 12.24it/s] 48%|████▊     | 33/69 [00:02<00:02, 12.85it/s] 51%|█████     | 35/69 [00:03<00:02, 12.33it/s] 54%|█████▎    | 37/69 [00:03<00:02, 12.91it/s] 57%|█████▋    | 39/69 [00:03<00:02, 12.29it/s] 59%|█████▉    | 41/69 [00:03<00:02, 12.89it/s] 62%|██████▏   | 43/69 [00:03<00:02, 12.35it/s] 65%|██████▌   | 45/69 [00:03<00:01, 12.95it/s] 68%|██████▊   | 47/69 [00:04<00:01, 12.48it/s] 71%|███████   | 49/69 [00:04<00:01, 13.00it/s] 74%|███████▍  | 51/69 [00:04<00:01, 12.20it/s] 77%|███████▋  | 53/69 [00:04<00:01, 12.81it/s] 80%|███████▉  | 55/69 [00:04<00:01, 12.17it/s] 83%|████████▎ | 57/69 [00:04<00:00, 12.81it/s] 86%|████████▌ | 59/69 [00:05<00:00, 12.71it/s] 88%|████████▊ | 61/69 [00:05<00:00, 13.22it/s] 91%|█████████▏| 63/69 [00:05<00:00, 12.62it/s] 94%|█████████▍| 65/69 [00:05<00:00, 13.17it/s] 97%|█████████▋| 67/69 [00:05<00:00, 12.41it/s]100%|██████████| 69/69 [00:05<00:00, 13.82it/s]100%|██████████| 69/69 [00:05<00:00, 11.71it/s]
Total samples: 137.000000
Overall Acc: 0.882606
Mean Acc: 0.409697
FreqW Acc: 0.800394
Mean IoU: 0.339851
Class IoU:
	class 0: 0.9429294836989628
	class 1: 0.5023153415027695
	class 2: 0.7578349060942589
	class 3: 0.08558569045058328
	class 4: 0.06635062336422133
	class 5: 0.02795352247394269
	class 6: 0.06643669628481896
	class 7: 0.1516642133234935
	class 8: 0.7684994918695747
	class 9: 0.4314219757461743
	class 10: 0.8087130951791056
	class 11: 0.35939132191796136
	class 12: 0.07951484602536796
	class 13: 0.683722016004856
	class 14: 0.008148013597216338
	class 15: 0.16695632546739744
	class 16: 0.15883339376179714
	class 17: 0.019129826197414566
	class 18: 0.3717719411053
Class Acc:
	class 0: 0.9564440737155306
	class 1: 0.6975908619301281
	class 2: 0.9052640460593412
	class 3: 0.0879919579380411
	class 4: 0.08151672389996281
	class 5: 0.0293011395735142
	class 6: 0.07054596035538319
	class 7: 0.171929866683242
	class 8: 0.9063626867157055
	class 9: 0.5356416317297592
	class 10: 0.9008950152239301
	class 11: 0.5086796550412354
	class 12: 0.09669386660351886
	class 13: 0.8469737706871918
	class 14: 0.008168255661093244
	class 15: 0.1721794185383911
	class 16: 0.2563877457657725
	class 17: 0.01951219512079047
	class 18: 0.5321604237541663

...from 0 to 18 : best/test_before_mIoU : 0.339851
...from 0 to 18 : best/test_before_acc : 0.409697
[1, 1, 1, 1, 1]
[1, 0, 1, 1, 1, 1]
==============================================
  task : 1-1
  step : 4
  Device: cuda
Namespace(amp=True, batch_size=6, bn_freeze=True, buffer=16384, cil_step=0, ckpt=None, crop_size=513, crop_val=True, curr_itrs=0, curr_step=4, data_root='/data/yt/BARM2/data_root/cityscapes', dataset='cityscapes_domain', gamma=10, gpu_id='1', initial=False, local_rank=0, loss_type='bce_loss', lr=0.01, lr_policy='poly', method='acil', model='deeplabv3_resnet101', num_classes=[1, 0, 1, 1, 1, 1], output_stride=16, overlap=False, print_interval=10, pseudo=True, pseudo_thresh=0.7, random_seed=1, separable_conv=False, setting='overlap', step_size=10000, subpath='BARM', target_cls=[[0], [1], [2], [3], [4]], task='1-1', test_only=False, train_epoch=50, unknown=0, val_batch_size=2, val_interval=100, weight_decay=0.0001)
==============================================
Category components: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
checkpoints/BARM/1-1/overlap/step3/final.pth
Model restored from checkpoints/BARM/1-1/overlap/step3/final.pth
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
Dataset: cityscapes_domain, Train set: 156, Val set: 176, Test set: 176
... train epoch : 50 , iterations : 1300 , val_interval : 100

... Training Done
[Testing Best Model]
  0%|          | 0/88 [00:00<?, ?it/s]  1%|          | 1/88 [00:00<01:05,  1.32it/s]  3%|▎         | 3/88 [00:00<00:21,  3.96it/s]  6%|▌         | 5/88 [00:01<00:13,  6.30it/s]  8%|▊         | 7/88 [00:01<00:09,  8.28it/s] 10%|█         | 9/88 [00:01<00:08,  9.47it/s] 12%|█▎        | 11/88 [00:01<00:07, 10.75it/s] 15%|█▍        | 13/88 [00:01<00:06, 11.74it/s] 17%|█▋        | 15/88 [00:01<00:05, 12.43it/s] 19%|█▉        | 17/88 [00:01<00:05, 12.97it/s] 22%|██▏       | 19/88 [00:02<00:05, 13.34it/s] 24%|██▍       | 21/88 [00:02<00:04, 13.64it/s] 26%|██▌       | 23/88 [00:02<00:05, 12.89it/s] 28%|██▊       | 25/88 [00:02<00:04, 13.28it/s] 31%|███       | 27/88 [00:02<00:04, 12.46it/s] 33%|███▎      | 29/88 [00:02<00:04, 12.95it/s] 35%|███▌      | 31/88 [00:03<00:04, 12.24it/s] 38%|███▊      | 33/88 [00:03<00:04, 12.82it/s] 40%|███▉      | 35/88 [00:03<00:04, 12.56it/s] 42%|████▏     | 37/88 [00:03<00:03, 12.93it/s] 44%|████▍     | 39/88 [00:03<00:03, 12.72it/s] 47%|████▋     | 41/88 [00:03<00:03, 13.16it/s] 49%|████▉     | 43/88 [00:03<00:03, 12.40it/s] 51%|█████     | 45/88 [00:04<00:03, 12.92it/s] 53%|█████▎    | 47/88 [00:04<00:03, 11.95it/s] 56%|█████▌    | 49/88 [00:04<00:03, 12.57it/s] 58%|█████▊    | 51/88 [00:04<00:02, 12.37it/s] 60%|██████    | 53/88 [00:04<00:02, 12.91it/s] 62%|██████▎   | 55/88 [00:04<00:02, 12.49it/s] 65%|██████▍   | 57/88 [00:05<00:02, 13.00it/s] 67%|██████▋   | 59/88 [00:05<00:02, 12.39it/s] 69%|██████▉   | 61/88 [00:05<00:02, 12.92it/s] 72%|███████▏  | 63/88 [00:05<00:01, 12.55it/s] 74%|███████▍  | 65/88 [00:05<00:01, 13.04it/s] 76%|███████▌  | 67/88 [00:05<00:01, 12.53it/s] 78%|███████▊  | 69/88 [00:05<00:01, 13.01it/s] 81%|████████  | 71/88 [00:06<00:01, 12.38it/s] 83%|████████▎ | 73/88 [00:06<00:01, 12.89it/s] 85%|████████▌ | 75/88 [00:06<00:01, 12.69it/s] 88%|████████▊ | 77/88 [00:06<00:00, 13.18it/s] 90%|████████▉ | 79/88 [00:06<00:00, 12.73it/s] 92%|█████████▏| 81/88 [00:06<00:00, 13.17it/s] 94%|█████████▍| 83/88 [00:07<00:00, 12.56it/s] 97%|█████████▋| 85/88 [00:07<00:00, 13.08it/s] 99%|█████████▉| 87/88 [00:07<00:00, 12.69it/s]100%|██████████| 88/88 [00:07<00:00, 11.64it/s]
Total samples: 176.000000
Overall Acc: 0.878322
Mean Acc: 0.423178
FreqW Acc: 0.794083
Mean IoU: 0.353384
Class IoU:
	class 0: 0.9398784854728273
	class 1: 0.45782543119206265
	class 2: 0.7427557457572693
	class 3: 0.06172455772215985
	class 4: 0.08188170642119581
	class 5: 0.03454345840515441
	class 6: 0.0423544616101399
	class 7: 0.16640840499689108
	class 8: 0.7686166191359349
	class 9: 0.4067285018932841
	class 10: 0.805766063384968
	class 11: 0.3769571730755259
	class 12: 0.11425423673769208
	class 13: 0.6779011567020958
	class 14: 0.1379122644197159
	class 15: 0.13923431138880088
	class 16: 0.3623842872733752
	class 17: 0.0
	class 18: 0.3971639142438588
Class Acc:
	class 0: 0.9557278517290795
	class 1: 0.6524957045123593
	class 2: 0.9005636198140639
	class 3: 0.0638115555232493
	class 4: 0.1007419841805199
	class 5: 0.03638056075921634
	class 6: 0.04515068493079999
	class 7: 0.19257273759920115
	class 8: 0.9054563712810845
	class 9: 0.5047876300189702
	class 10: 0.9015650083639926
	class 11: 0.5370547009222678
	class 12: 0.1282088575360797
	class 13: 0.8466290846496647
	class 14: 0.14412809728462792
	class 15: 0.14452628904924086
	class 16: 0.43254822253673936
	class 17: 0.0
	class 18: 0.5480315307987997

...from 0 to 18 : best/test_before_mIoU : 0.353384
...from 0 to 18 : best/test_before_acc : 0.423178
[1, 1, 1, 1, 1, 1]
[1, 0, 1, 1, 1, 1, 1]
==============================================
  task : 1-1
  step : 5
  Device: cuda
Namespace(amp=True, batch_size=6, bn_freeze=True, buffer=16384, cil_step=0, ckpt=None, crop_size=513, crop_val=True, curr_itrs=0, curr_step=5, data_root='/data/yt/BARM2/data_root/cityscapes', dataset='cityscapes_domain', gamma=10, gpu_id='1', initial=False, local_rank=0, loss_type='bce_loss', lr=0.01, lr_policy='poly', method='acil', model='deeplabv3_resnet101', num_classes=[1, 0, 1, 1, 1, 1, 1], output_stride=16, overlap=False, print_interval=10, pseudo=True, pseudo_thresh=0.7, random_seed=1, separable_conv=False, setting='overlap', step_size=10000, subpath='BARM', target_cls=[[0], [1], [2], [3], [4], [5]], task='1-1', test_only=False, train_epoch=50, unknown=0, val_batch_size=2, val_interval=100, weight_decay=0.0001)
==============================================
Category components: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
checkpoints/BARM/1-1/overlap/step4/final.pth
Model restored from checkpoints/BARM/1-1/overlap/step4/final.pth
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
Dataset: cityscapes_domain, Train set: 79, Val set: 196, Test set: 196
... train epoch : 50 , iterations : 650 , val_interval : 100

... Training Done
[Testing Best Model]
  0%|          | 0/98 [00:00<?, ?it/s]  1%|          | 1/98 [00:00<01:00,  1.59it/s]  3%|▎         | 3/98 [00:00<00:21,  4.51it/s]  5%|▌         | 5/98 [00:00<00:13,  6.94it/s]  7%|▋         | 7/98 [00:01<00:10,  8.88it/s]  9%|▉         | 9/98 [00:01<00:09,  9.83it/s] 11%|█         | 11/98 [00:01<00:07, 11.05it/s] 13%|█▎        | 13/98 [00:01<00:07, 11.43it/s] 15%|█▌        | 15/98 [00:01<00:06, 12.23it/s] 17%|█▋        | 17/98 [00:01<00:06, 11.72it/s] 19%|█▉        | 19/98 [00:02<00:06, 12.43it/s] 21%|██▏       | 21/98 [00:02<00:06, 11.90it/s] 23%|██▎       | 23/98 [00:02<00:05, 12.55it/s] 26%|██▌       | 25/98 [00:02<00:06, 12.04it/s] 28%|██▊       | 27/98 [00:02<00:05, 12.65it/s] 30%|██▉       | 29/98 [00:02<00:05, 12.19it/s] 32%|███▏      | 31/98 [00:02<00:05, 12.76it/s] 34%|███▎      | 33/98 [00:03<00:05, 12.17it/s] 36%|███▌      | 35/98 [00:03<00:04, 12.74it/s] 38%|███▊      | 37/98 [00:03<00:04, 12.46it/s] 40%|███▉      | 39/98 [00:03<00:04, 12.97it/s] 42%|████▏     | 41/98 [00:03<00:04, 12.63it/s] 44%|████▍     | 43/98 [00:03<00:04, 13.07it/s] 46%|████▌     | 45/98 [00:04<00:04, 12.29it/s] 48%|████▊     | 47/98 [00:04<00:03, 12.83it/s] 50%|█████     | 49/98 [00:04<00:04, 12.07it/s] 52%|█████▏    | 51/98 [00:04<00:03, 12.67it/s] 54%|█████▍    | 53/98 [00:04<00:03, 12.40it/s] 56%|█████▌    | 55/98 [00:04<00:03, 12.92it/s] 58%|█████▊    | 57/98 [00:05<00:03, 12.34it/s] 60%|██████    | 59/98 [00:05<00:03, 12.71it/s] 62%|██████▏   | 61/98 [00:05<00:02, 12.61it/s] 64%|██████▍   | 63/98 [00:05<00:02, 13.02it/s] 66%|██████▋   | 65/98 [00:05<00:02, 12.42it/s] 68%|██████▊   | 67/98 [00:05<00:02, 12.94it/s] 70%|███████   | 69/98 [00:05<00:02, 13.33it/s] 72%|███████▏  | 71/98 [00:06<00:02, 13.33it/s] 74%|███████▍  | 73/98 [00:06<00:01, 13.59it/s] 77%|███████▋  | 75/98 [00:06<00:01, 12.86it/s] 79%|███████▊  | 77/98 [00:06<00:01, 13.24it/s] 81%|████████  | 79/98 [00:06<00:01, 12.67it/s] 83%|████████▎ | 81/98 [00:06<00:01, 13.09it/s] 85%|████████▍ | 83/98 [00:07<00:01, 12.72it/s] 87%|████████▋ | 85/98 [00:07<00:00, 13.19it/s] 89%|████████▉ | 87/98 [00:07<00:00, 12.80it/s] 91%|█████████ | 89/98 [00:07<00:00, 13.20it/s] 93%|█████████▎| 91/98 [00:07<00:00, 12.58it/s] 95%|█████████▍| 93/98 [00:07<00:00, 13.06it/s] 97%|█████████▋| 95/98 [00:07<00:00, 12.38it/s] 99%|█████████▉| 97/98 [00:08<00:00, 12.92it/s]100%|██████████| 98/98 [00:08<00:00, 11.79it/s]
Total samples: 196.000000
Overall Acc: 0.880540
Mean Acc: 0.431102
FreqW Acc: 0.797559
Mean IoU: 0.359305
Class IoU:
	class 0: 0.9405242483480541
	class 1: 0.46709360677610523
	class 2: 0.7599255388953289
	class 3: 0.053306200544385576
	class 4: 0.06859074889096056
	class 5: 0.027838584421292577
	class 6: 0.0534944034936733
	class 7: 0.16486213682415504
	class 8: 0.7624540384207882
	class 9: 0.449904626877848
	class 10: 0.8032423179719338
	class 11: 0.3938648184846119
	class 12: 0.15612014369722513
	class 13: 0.6816940790986381
	class 14: 0.07791257059124737
	class 15: 0.1409298262614592
	class 16: 0.341833889584251
	class 17: 0.0
	class 18: 0.483208400751302
Class Acc:
	class 0: 0.955534347204853
	class 1: 0.669202938773175
	class 2: 0.9089576827384025
	class 3: 0.05470414004214337
	class 4: 0.08375416325584012
	class 5: 0.029311240720143312
	class 6: 0.05468804510047742
	class 7: 0.19049896581880446
	class 8: 0.9008061894125082
	class 9: 0.5487428896457658
	class 10: 0.8984354613358934
	class 11: 0.5686675318744532
	class 12: 0.18208442040722495
	class 13: 0.8375275542287961
	class 14: 0.08290366853293053
	class 15: 0.14657783161424232
	class 16: 0.40726050353101967
	class 17: 0.0
	class 18: 0.6712878009364389

...from 0 to 18 : best/test_before_mIoU : 0.359305
...from 0 to 18 : best/test_before_acc : 0.431102
[1, 1, 1, 1, 1, 1, 1]
[1, 0, 1, 1, 1, 1, 1, 1]
==============================================
  task : 1-1
  step : 6
  Device: cuda
Namespace(amp=True, batch_size=6, bn_freeze=True, buffer=16384, cil_step=0, ckpt=None, crop_size=513, crop_val=True, curr_itrs=0, curr_step=6, data_root='/data/yt/BARM2/data_root/cityscapes', dataset='cityscapes_domain', gamma=10, gpu_id='1', initial=False, local_rank=0, loss_type='bce_loss', lr=0.01, lr_policy='poly', method='acil', model='deeplabv3_resnet101', num_classes=[1, 0, 1, 1, 1, 1, 1, 1], output_stride=16, overlap=False, print_interval=10, pseudo=True, pseudo_thresh=0.7, random_seed=1, separable_conv=False, setting='overlap', step_size=10000, subpath='BARM', target_cls=[[0], [1], [2], [3], [4], [5], [6]], task='1-1', test_only=False, train_epoch=50, unknown=0, val_batch_size=2, val_interval=100, weight_decay=0.0001)
==============================================
Category components: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
checkpoints/BARM/1-1/overlap/step5/final.pth
Model restored from checkpoints/BARM/1-1/overlap/step5/final.pth
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
Dataset: cityscapes_domain, Train set: 292, Val set: 269, Test set: 269
... train epoch : 50 , iterations : 2400 , val_interval : 100

... Training Done
[Testing Best Model]
  0%|          | 0/135 [00:00<?, ?it/s]  1%|          | 1/135 [00:00<01:29,  1.50it/s]  2%|▏         | 3/135 [00:00<00:30,  4.29it/s]  4%|▎         | 5/135 [00:00<00:19,  6.62it/s]  5%|▌         | 7/135 [00:01<00:15,  8.49it/s]  7%|▋         | 9/135 [00:01<00:12,  9.80it/s]  8%|▊         | 11/135 [00:01<00:11, 10.93it/s] 10%|▉         | 13/135 [00:01<00:10, 11.14it/s] 11%|█         | 15/135 [00:01<00:09, 12.05it/s] 13%|█▎        | 17/135 [00:01<00:10, 11.72it/s] 14%|█▍        | 19/135 [00:02<00:09, 12.51it/s] 16%|█▌        | 21/135 [00:02<00:09, 12.05it/s] 17%|█▋        | 23/135 [00:02<00:08, 12.73it/s] 19%|█▊        | 25/135 [00:02<00:08, 12.44it/s] 20%|██        | 27/135 [00:02<00:08, 13.02it/s] 21%|██▏       | 29/135 [00:02<00:08, 12.20it/s] 23%|██▎       | 31/135 [00:02<00:08, 12.84it/s] 24%|██▍       | 33/135 [00:03<00:08, 12.18it/s] 26%|██▌       | 35/135 [00:03<00:07, 12.81it/s] 27%|██▋       | 37/135 [00:03<00:07, 12.27it/s] 29%|██▉       | 39/135 [00:03<00:07, 12.89it/s] 30%|███       | 41/135 [00:03<00:07, 12.43it/s] 32%|███▏      | 43/135 [00:03<00:07, 13.02it/s] 33%|███▎      | 45/135 [00:04<00:07, 12.17it/s] 35%|███▍      | 47/135 [00:04<00:06, 12.78it/s] 36%|███▋      | 49/135 [00:04<00:06, 12.48it/s] 38%|███▊      | 51/135 [00:04<00:06, 13.03it/s] 39%|███▉      | 53/135 [00:04<00:06, 12.43it/s] 41%|████      | 55/135 [00:04<00:06, 12.98it/s] 42%|████▏     | 57/135 [00:05<00:06, 12.54it/s] 44%|████▎     | 59/135 [00:05<00:05, 13.08it/s] 45%|████▌     | 61/135 [00:05<00:06, 12.33it/s] 47%|████▋     | 63/135 [00:05<00:05, 12.94it/s] 48%|████▊     | 65/135 [00:05<00:05, 12.16it/s] 50%|████▉     | 67/135 [00:05<00:05, 12.72it/s] 51%|█████     | 69/135 [00:06<00:05, 12.11it/s] 53%|█████▎    | 71/135 [00:06<00:05, 12.69it/s] 54%|█████▍    | 73/135 [00:06<00:05, 12.29it/s] 56%|█████▌    | 75/135 [00:06<00:04, 12.81it/s] 57%|█████▋    | 77/135 [00:06<00:04, 12.61it/s] 59%|█████▊    | 79/135 [00:06<00:04, 13.06it/s] 60%|██████    | 81/135 [00:06<00:04, 12.64it/s] 61%|██████▏   | 83/135 [00:07<00:03, 13.09it/s] 63%|██████▎   | 85/135 [00:07<00:03, 12.57it/s] 64%|██████▍   | 87/135 [00:07<00:03, 13.00it/s] 66%|██████▌   | 89/135 [00:07<00:03, 12.50it/s] 67%|██████▋   | 91/135 [00:07<00:03, 12.96it/s] 69%|██████▉   | 93/135 [00:07<00:03, 12.43it/s] 70%|███████   | 95/135 [00:08<00:03, 12.93it/s] 72%|███████▏  | 97/135 [00:08<00:03, 12.51it/s] 73%|███████▎  | 99/135 [00:08<00:02, 12.96it/s] 75%|███████▍  | 101/135 [00:08<00:02, 12.31it/s] 76%|███████▋  | 103/135 [00:08<00:02, 12.80it/s] 78%|███████▊  | 105/135 [00:08<00:02, 12.61it/s] 79%|███████▉  | 107/135 [00:08<00:02, 13.06it/s] 81%|████████  | 109/135 [00:09<00:02, 12.43it/s] 82%|████████▏ | 111/135 [00:09<00:01, 12.90it/s] 84%|████████▎ | 113/135 [00:09<00:01, 12.36it/s] 85%|████████▌ | 115/135 [00:09<00:01, 12.86it/s] 87%|████████▋ | 117/135 [00:09<00:01, 12.33it/s] 88%|████████▊ | 119/135 [00:09<00:01, 12.84it/s] 90%|████████▉ | 121/135 [00:10<00:01, 12.34it/s] 91%|█████████ | 123/135 [00:10<00:00, 12.85it/s] 93%|█████████▎| 125/135 [00:10<00:00, 12.65it/s] 94%|█████████▍| 127/135 [00:10<00:00, 13.07it/s] 96%|█████████▌| 129/135 [00:10<00:00, 11.59it/s] 97%|█████████▋| 131/135 [00:10<00:00, 12.27it/s] 99%|█████████▊| 133/135 [00:11<00:00, 12.84it/s]100%|██████████| 135/135 [00:11<00:00, 14.01it/s]100%|██████████| 135/135 [00:11<00:00, 11.97it/s]
Total samples: 269.000000
Overall Acc: 0.872543
Mean Acc: 0.408305
FreqW Acc: 0.785266
Mean IoU: 0.336971
Class IoU:
	class 0: 0.9306585784408665
	class 1: 0.4524042473418744
	class 2: 0.7588652824971157
	class 3: 0.022464923394739957
	class 4: 0.0648334738184543
	class 5: 0.023878743930943393
	class 6: 0.04092621291086359
	class 7: 0.13664798377127724
	class 8: 0.7652585168584307
	class 9: 0.4049333243010579
	class 10: 0.7888195163502943
	class 11: 0.40104688891098333
	class 12: 0.08971135298903184
	class 13: 0.6814200370536242
	class 14: 0.07257321076225101
	class 15: 0.2398552765543698
	class 16: 0.21370237103483256
	class 17: 0.0
	class 18: 0.314441433864915
Class Acc:
	class 0: 0.9489429587014943
	class 1: 0.6519207267953596
	class 2: 0.9180952602131134
	class 3: 0.02261761867766896
	class 4: 0.07638094235954618
	class 5: 0.024889553304441172
	class 6: 0.04159481271939488
	class 7: 0.15514389458883407
	class 8: 0.900238055413258
	class 9: 0.4773942096397515
	class 10: 0.8927029750287072
	class 11: 0.5910235682397771
	class 12: 0.10204121610932808
	class 13: 0.8439464343100752
	class 14: 0.07572876632245194
	class 15: 0.2503278614370858
	class 16: 0.28394730686343517
	class 17: 0.0
	class 18: 0.5008656655678376

...from 0 to 18 : best/test_before_mIoU : 0.336971
...from 0 to 18 : best/test_before_acc : 0.408305
[1, 1, 1, 1, 1, 1, 1, 1]
[1, 0, 1, 1, 1, 1, 1, 1, 1]
==============================================
  task : 1-1
  step : 7
  Device: cuda
Namespace(amp=True, batch_size=6, bn_freeze=True, buffer=16384, cil_step=0, ckpt=None, crop_size=513, crop_val=True, curr_itrs=0, curr_step=7, data_root='/data/yt/BARM2/data_root/cityscapes', dataset='cityscapes_domain', gamma=10, gpu_id='1', initial=False, local_rank=0, loss_type='bce_loss', lr=0.01, lr_policy='poly', method='acil', model='deeplabv3_resnet101', num_classes=[1, 0, 1, 1, 1, 1, 1, 1, 1], output_stride=16, overlap=False, print_interval=10, pseudo=True, pseudo_thresh=0.7, random_seed=1, separable_conv=False, setting='overlap', step_size=10000, subpath='BARM', target_cls=[[0], [1], [2], [3], [4], [5], [6], [7]], task='1-1', test_only=False, train_epoch=50, unknown=0, val_batch_size=2, val_interval=100, weight_decay=0.0001)
==============================================
Category components: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
checkpoints/BARM/1-1/overlap/step6/final.pth
Model restored from checkpoints/BARM/1-1/overlap/step6/final.pth
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
Dataset: cityscapes_domain, Train set: 115, Val set: 298, Test set: 298
... train epoch : 50 , iterations : 950 , val_interval : 100

... Training Done
[Testing Best Model]
  0%|          | 0/149 [00:00<?, ?it/s]  1%|          | 1/149 [00:00<01:31,  1.62it/s]  2%|▏         | 3/149 [00:00<00:31,  4.61it/s]  3%|▎         | 5/149 [00:00<00:20,  7.11it/s]  5%|▍         | 7/149 [00:01<00:15,  9.07it/s]  6%|▌         | 9/149 [00:01<00:14,  9.83it/s]  7%|▋         | 11/149 [00:01<00:12, 11.10it/s]  9%|▊         | 13/149 [00:01<00:12, 11.22it/s] 10%|█         | 15/149 [00:01<00:11, 12.12it/s] 11%|█▏        | 17/149 [00:01<00:11, 11.87it/s] 13%|█▎        | 19/149 [00:01<00:10, 12.58it/s] 14%|█▍        | 21/149 [00:02<00:10, 12.09it/s] 15%|█▌        | 23/149 [00:02<00:09, 12.70it/s] 17%|█▋        | 25/149 [00:02<00:10, 12.10it/s] 18%|█▊        | 27/149 [00:02<00:09, 12.45it/s] 19%|█▉        | 29/149 [00:02<00:09, 12.40it/s] 21%|██        | 31/149 [00:02<00:09, 12.55it/s] 22%|██▏       | 33/149 [00:03<00:09, 12.32it/s] 23%|██▎       | 35/149 [00:03<00:08, 12.73it/s] 25%|██▍       | 37/149 [00:03<00:09, 12.14it/s] 26%|██▌       | 39/149 [00:03<00:08, 12.72it/s] 28%|██▊       | 41/149 [00:03<00:08, 12.22it/s] 29%|██▉       | 43/149 [00:03<00:08, 12.79it/s] 30%|███       | 45/149 [00:04<00:08, 12.19it/s] 32%|███▏      | 47/149 [00:04<00:08, 12.71it/s] 33%|███▎      | 49/149 [00:04<00:08, 12.15it/s] 34%|███▍      | 51/149 [00:04<00:07, 12.74it/s] 36%|███▌      | 53/149 [00:04<00:07, 12.11it/s] 37%|███▋      | 55/149 [00:04<00:07, 12.65it/s] 38%|███▊      | 57/149 [00:05<00:07, 12.19it/s] 40%|███▉      | 59/149 [00:05<00:07, 12.72it/s] 41%|████      | 61/149 [00:05<00:07, 12.28it/s] 42%|████▏     | 63/149 [00:05<00:06, 12.72it/s] 44%|████▎     | 65/149 [00:05<00:06, 12.45it/s] 45%|████▍     | 67/149 [00:05<00:06, 12.60it/s] 46%|████▋     | 69/149 [00:06<00:06, 12.55it/s] 48%|████▊     | 71/149 [00:06<00:06, 12.50it/s] 49%|████▉     | 73/149 [00:06<00:06, 12.40it/s] 50%|█████     | 75/149 [00:06<00:05, 12.51it/s] 52%|█████▏    | 77/149 [00:06<00:05, 12.56it/s] 53%|█████▎    | 79/149 [00:06<00:05, 12.75it/s] 54%|█████▍    | 81/149 [00:06<00:05, 12.84it/s] 56%|█████▌    | 83/149 [00:07<00:05, 12.61it/s] 57%|█████▋    | 85/149 [00:07<00:05, 12.77it/s] 58%|█████▊    | 87/149 [00:07<00:04, 12.67it/s] 60%|█████▉    | 89/149 [00:07<00:04, 12.63it/s] 61%|██████    | 91/149 [00:07<00:04, 12.62it/s] 62%|██████▏   | 93/149 [00:07<00:04, 12.56it/s] 64%|██████▍   | 95/149 [00:08<00:04, 12.51it/s] 65%|██████▌   | 97/149 [00:08<00:04, 12.47it/s] 66%|██████▋   | 99/149 [00:08<00:03, 12.73it/s] 68%|██████▊   | 101/149 [00:08<00:03, 12.35it/s] 69%|██████▉   | 103/149 [00:08<00:03, 12.86it/s] 70%|███████   | 105/149 [00:08<00:03, 12.25it/s] 72%|███████▏  | 107/149 [00:09<00:03, 12.81it/s] 73%|███████▎  | 109/149 [00:09<00:03, 12.24it/s] 74%|███████▍  | 111/149 [00:09<00:02, 12.78it/s] 76%|███████▌  | 113/149 [00:09<00:02, 12.43it/s] 77%|███████▋  | 115/149 [00:09<00:02, 12.87it/s] 79%|███████▊  | 117/149 [00:09<00:02, 12.34it/s] 80%|███████▉  | 119/149 [00:09<00:02, 12.86it/s] 81%|████████  | 121/149 [00:10<00:02, 12.12it/s] 83%|████████▎ | 123/149 [00:10<00:02, 12.66it/s] 84%|████████▍ | 125/149 [00:10<00:01, 12.30it/s] 85%|████████▌ | 127/149 [00:10<00:01, 12.81it/s] 87%|████████▋ | 129/149 [00:10<00:01, 12.21it/s] 88%|████████▊ | 131/149 [00:10<00:01, 12.76it/s] 89%|████████▉ | 133/149 [00:11<00:01, 12.48it/s] 91%|█████████ | 135/149 [00:11<00:01, 12.85it/s] 92%|█████████▏| 137/149 [00:11<00:00, 12.39it/s] 93%|█████████▎| 139/149 [00:11<00:00, 12.91it/s] 95%|█████████▍| 141/149 [00:11<00:00, 12.39it/s] 96%|█████████▌| 143/149 [00:11<00:00, 12.78it/s] 97%|█████████▋| 145/149 [00:12<00:00, 12.63it/s] 99%|█████████▊| 147/149 [00:12<00:00, 13.10it/s]100%|██████████| 149/149 [00:12<00:00, 12.44it/s]100%|██████████| 149/149 [00:12<00:00, 11.92it/s]
Total samples: 298.000000
Overall Acc: 0.878371
Mean Acc: 0.411198
FreqW Acc: 0.793929
Mean IoU: 0.340098
Class IoU:
	class 0: 0.9356710487546255
	class 1: 0.46054055319891446
	class 2: 0.7655851433971751
	class 3: 0.04353132628134129
	class 4: 0.08665063297814898
	class 5: 0.019519552853731307
	class 6: 0.02785867237657539
	class 7: 0.12192958799798174
	class 8: 0.7765462169723275
	class 9: 0.3786975450941254
	class 10: 0.7943526174852016
	class 11: 0.44151738466100104
	class 12: 0.08148448288626171
	class 13: 0.6848019239854148
	class 14: 0.08174622250615461
	class 15: 0.2411964150390626
	class 16: 0.2136306950622722
	class 17: 0.0008313934153515828
	class 18: 0.30577861515487553
Class Acc:
	class 0: 0.9531631264676362
	class 1: 0.656664900079087
	class 2: 0.919439657060918
	class 3: 0.044109005113258534
	class 4: 0.10275531076883605
	class 5: 0.020124866536575872
	class 6: 0.028233200594305258
	class 7: 0.13833172993474432
	class 8: 0.9059863961861775
	class 9: 0.453377375070915
	class 10: 0.8924554938715911
	class 11: 0.6284493848878258
	class 12: 0.09289128118991251
	class 13: 0.8409857351197119
	class 14: 0.08489592147535582
	class 15: 0.25058842238986495
	class 16: 0.2942204635506599
	class 17: 0.0008313934153515828
	class 18: 0.5052655288027165

...from 0 to 18 : best/test_before_mIoU : 0.340098
...from 0 to 18 : best/test_before_acc : 0.411198
[1, 1, 1, 1, 1, 1, 1, 1, 1]
[1, 0, 1, 1, 1, 1, 1, 1, 1, 1]
==============================================
  task : 1-1
  step : 8
  Device: cuda
Namespace(amp=True, batch_size=6, bn_freeze=True, buffer=16384, cil_step=0, ckpt=None, crop_size=513, crop_val=True, curr_itrs=0, curr_step=8, data_root='/data/yt/BARM2/data_root/cityscapes', dataset='cityscapes_domain', gamma=10, gpu_id='1', initial=False, local_rank=0, loss_type='bce_loss', lr=0.01, lr_policy='poly', method='acil', model='deeplabv3_resnet101', num_classes=[1, 0, 1, 1, 1, 1, 1, 1, 1, 1], output_stride=16, overlap=False, print_interval=10, pseudo=True, pseudo_thresh=0.7, random_seed=1, separable_conv=False, setting='overlap', step_size=10000, subpath='BARM', target_cls=[[0], [1], [2], [3], [4], [5], [6], [7], [8]], task='1-1', test_only=False, train_epoch=50, unknown=0, val_batch_size=2, val_interval=100, weight_decay=0.0001)
==============================================
Category components: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
checkpoints/BARM/1-1/overlap/step7/final.pth
Model restored from checkpoints/BARM/1-1/overlap/step7/final.pth
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
Dataset: cityscapes_domain, Train set: 113, Val set: 326, Test set: 326
... train epoch : 50 , iterations : 900 , val_interval : 100

... Training Done
[Testing Best Model]
  0%|          | 0/163 [00:00<?, ?it/s]  1%|          | 1/163 [00:00<01:41,  1.60it/s]  2%|▏         | 3/163 [00:00<00:35,  4.54it/s]  3%|▎         | 5/163 [00:00<00:22,  7.00it/s]  4%|▍         | 7/163 [00:01<00:17,  8.91it/s]  6%|▌         | 9/163 [00:01<00:15,  9.90it/s]  7%|▋         | 11/163 [00:01<00:13, 11.12it/s]  8%|▊         | 13/163 [00:01<00:13, 11.51it/s]  9%|▉         | 15/163 [00:01<00:12, 12.30it/s] 10%|█         | 17/163 [00:01<00:12, 11.73it/s] 12%|█▏        | 19/163 [00:01<00:11, 12.47it/s] 13%|█▎        | 21/163 [00:02<00:11, 11.93it/s] 14%|█▍        | 23/163 [00:02<00:11, 12.66it/s] 15%|█▌        | 25/163 [00:02<00:11, 12.14it/s] 17%|█▋        | 27/163 [00:02<00:10, 12.81it/s] 18%|█▊        | 29/163 [00:02<00:11, 11.88it/s] 19%|█▉        | 31/163 [00:02<00:10, 12.60it/s] 20%|██        | 33/163 [00:03<00:10, 11.99it/s] 21%|██▏       | 35/163 [00:03<00:10, 12.69it/s] 23%|██▎       | 37/163 [00:03<00:10, 12.26it/s] 24%|██▍       | 39/163 [00:03<00:09, 12.86it/s] 25%|██▌       | 41/163 [00:03<00:09, 12.33it/s] 26%|██▋       | 43/163 [00:03<00:09, 12.95it/s] 28%|██▊       | 45/163 [00:04<00:09, 12.47it/s] 29%|██▉       | 47/163 [00:04<00:08, 13.06it/s] 30%|███       | 49/163 [00:04<00:08, 12.99it/s] 31%|███▏      | 51/163 [00:04<00:08, 13.42it/s] 33%|███▎      | 53/163 [00:04<00:08, 13.72it/s] 34%|███▎      | 55/163 [00:04<00:07, 13.78it/s] 35%|███▍      | 57/163 [00:04<00:07, 13.99it/s] 36%|███▌      | 59/163 [00:05<00:08, 12.96it/s] 37%|███▋      | 61/163 [00:05<00:07, 13.41it/s] 39%|███▊      | 63/163 [00:05<00:07, 12.61it/s] 40%|███▉      | 65/163 [00:05<00:07, 13.15it/s] 41%|████      | 67/163 [00:05<00:07, 12.49it/s] 42%|████▏     | 69/163 [00:05<00:07, 13.04it/s] 44%|████▎     | 71/163 [00:06<00:07, 12.42it/s] 45%|████▍     | 73/163 [00:06<00:06, 12.97it/s] 46%|████▌     | 75/163 [00:06<00:06, 12.80it/s] 47%|████▋     | 77/163 [00:06<00:06, 13.29it/s] 48%|████▊     | 79/163 [00:06<00:06, 13.65it/s] 50%|████▉     | 81/163 [00:06<00:05, 13.92it/s] 51%|█████     | 83/163 [00:06<00:05, 14.12it/s] 52%|█████▏    | 85/163 [00:07<00:05, 14.24it/s] 53%|█████▎    | 87/163 [00:07<00:05, 14.31it/s] 55%|█████▍    | 89/163 [00:07<00:05, 14.07it/s] 56%|█████▌    | 91/163 [00:07<00:05, 14.13it/s] 57%|█████▋    | 93/163 [00:07<00:05, 13.45it/s] 58%|█████▊    | 95/163 [00:07<00:04, 13.69it/s] 60%|█████▉    | 97/163 [00:07<00:05, 12.75it/s] 61%|██████    | 99/163 [00:08<00:04, 13.15it/s] 62%|██████▏   | 101/163 [00:08<00:04, 12.60it/s] 63%|██████▎   | 103/163 [00:08<00:04, 13.06it/s] 64%|██████▍   | 105/163 [00:08<00:04, 12.62it/s] 66%|██████▌   | 107/163 [00:08<00:04, 13.07it/s] 67%|██████▋   | 109/163 [00:08<00:04, 12.35it/s] 68%|██████▊   | 111/163 [00:09<00:04, 12.88it/s] 69%|██████▉   | 113/163 [00:09<00:04, 12.23it/s] 71%|███████   | 115/163 [00:09<00:03, 12.74it/s] 72%|███████▏  | 117/163 [00:09<00:03, 12.42it/s] 73%|███████▎  | 119/163 [00:09<00:03, 12.97it/s] 74%|███████▍  | 121/163 [00:09<00:03, 12.01it/s] 75%|███████▌  | 123/163 [00:10<00:03, 12.61it/s] 77%|███████▋  | 125/163 [00:10<00:03, 11.94it/s] 78%|███████▊  | 127/163 [00:10<00:02, 12.57it/s] 79%|███████▉  | 129/163 [00:10<00:02, 12.33it/s] 80%|████████  | 131/163 [00:10<00:02, 12.86it/s] 82%|████████▏ | 133/163 [00:10<00:02, 12.37it/s] 83%|████████▎ | 135/163 [00:10<00:02, 12.86it/s] 84%|████████▍ | 137/163 [00:11<00:02, 12.62it/s] 85%|████████▌ | 139/163 [00:11<00:01, 13.07it/s] 87%|████████▋ | 141/163 [00:11<00:01, 12.57it/s] 88%|████████▊ | 143/163 [00:11<00:01, 13.00it/s] 89%|████████▉ | 145/163 [00:11<00:01, 12.59it/s] 90%|█████████ | 147/163 [00:11<00:01, 13.03it/s] 91%|█████████▏| 149/163 [00:12<00:01, 12.52it/s] 93%|█████████▎| 151/163 [00:12<00:00, 13.02it/s] 94%|█████████▍| 153/163 [00:12<00:00, 12.61it/s] 95%|█████████▌| 155/163 [00:12<00:00, 13.06it/s] 96%|█████████▋| 157/163 [00:12<00:00, 12.63it/s] 98%|█████████▊| 159/163 [00:12<00:00, 13.11it/s] 99%|█████████▉| 161/163 [00:13<00:00, 12.29it/s]100%|██████████| 163/163 [00:13<00:00, 12.87it/s]100%|██████████| 163/163 [00:13<00:00, 12.29it/s]
Total samples: 326.000000
Overall Acc: 0.879934
Mean Acc: 0.424069
FreqW Acc: 0.796340
Mean IoU: 0.352694
Class IoU:
	class 0: 0.934741615350774
	class 1: 0.45881733252667156
	class 2: 0.776658830179913
	class 3: 0.04581721564472388
	class 4: 0.09707550279682621
	class 5: 0.01873427044078379
	class 6: 0.04974613272171656
	class 7: 0.12797636337948345
	class 8: 0.7746859504669453
	class 9: 0.3995686917859607
	class 10: 0.7894710800768198
	class 11: 0.4239923638263125
	class 12: 0.08293163971885421
	class 13: 0.6824046862208432
	class 14: 0.08181971472883785
	class 15: 0.35980327284529173
	class 16: 0.2746358029841476
	class 17: 0.01675897494738774
	class 18: 0.3055528938938
Class Acc:
	class 0: 0.9528410492802759
	class 1: 0.6457103535244876
	class 2: 0.9213188811193606
	class 3: 0.046549479166481875
	class 4: 0.12111374625232546
	class 5: 0.019270882654773287
	class 6: 0.05075794226686464
	class 7: 0.1428972999016372
	class 8: 0.9073419094929772
	class 9: 0.4809612536419645
	class 10: 0.8879247541870764
	class 11: 0.6011199316339002
	class 12: 0.09535535078063484
	class 13: 0.8422377179559686
	class 14: 0.0845236500063222
	class 15: 0.39562200052891644
	class 16: 0.3488419136221865
	class 17: 0.01684040543828539
	class 18: 0.4960730715358976

...from 0 to 18 : best/test_before_mIoU : 0.352694
...from 0 to 18 : best/test_before_acc : 0.424069
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1]
==============================================
  task : 1-1
  step : 9
  Device: cuda
Namespace(amp=True, batch_size=6, bn_freeze=True, buffer=16384, cil_step=0, ckpt=None, crop_size=513, crop_val=True, curr_itrs=0, curr_step=9, data_root='/data/yt/BARM2/data_root/cityscapes', dataset='cityscapes_domain', gamma=10, gpu_id='1', initial=False, local_rank=0, loss_type='bce_loss', lr=0.01, lr_policy='poly', method='acil', model='deeplabv3_resnet101', num_classes=[1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1], output_stride=16, overlap=False, print_interval=10, pseudo=True, pseudo_thresh=0.7, random_seed=1, separable_conv=False, setting='overlap', step_size=10000, subpath='BARM', target_cls=[[0], [1], [2], [3], [4], [5], [6], [7], [8], [9]], task='1-1', test_only=False, train_epoch=50, unknown=0, val_batch_size=2, val_interval=100, weight_decay=0.0001)
==============================================
Category components: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
checkpoints/BARM/1-1/overlap/step8/final.pth
Model restored from checkpoints/BARM/1-1/overlap/step8/final.pth
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
Dataset: cityscapes_domain, Train set: 76, Val set: 346, Test set: 346
... train epoch : 50 , iterations : 600 , val_interval : 100

... Training Done
[Testing Best Model]
  0%|          | 0/173 [00:00<?, ?it/s]  1%|          | 1/173 [00:00<01:43,  1.66it/s]  2%|▏         | 3/173 [00:00<00:36,  4.69it/s]  3%|▎         | 5/173 [00:00<00:24,  6.99it/s]  4%|▍         | 7/173 [00:01<00:18,  8.99it/s]  5%|▌         | 9/173 [00:01<00:16,  9.73it/s]  6%|▋         | 11/173 [00:01<00:14, 11.02it/s]  8%|▊         | 13/173 [00:01<00:14, 11.14it/s]  9%|▊         | 15/173 [00:01<00:13, 12.07it/s] 10%|▉         | 17/173 [00:01<00:13, 11.62it/s] 11%|█         | 19/173 [00:01<00:12, 12.41it/s] 12%|█▏        | 21/173 [00:02<00:12, 11.87it/s] 13%|█▎        | 23/173 [00:02<00:12, 12.49it/s] 14%|█▍        | 25/173 [00:02<00:12, 11.99it/s] 16%|█▌        | 27/173 [00:02<00:11, 12.61it/s] 17%|█▋        | 29/173 [00:02<00:11, 12.12it/s] 18%|█▊        | 31/173 [00:02<00:11, 12.72it/s] 19%|█▉        | 33/173 [00:03<00:11, 12.32it/s] 20%|██        | 35/173 [00:03<00:10, 12.88it/s] 21%|██▏       | 37/173 [00:03<00:11, 12.11it/s] 23%|██▎       | 39/173 [00:03<00:10, 12.71it/s] 24%|██▎       | 41/173 [00:03<00:10, 12.23it/s] 25%|██▍       | 43/173 [00:03<00:10, 12.80it/s] 26%|██▌       | 45/173 [00:04<00:10, 12.37it/s] 27%|██▋       | 47/173 [00:04<00:09, 12.90it/s] 28%|██▊       | 49/173 [00:04<00:10, 12.25it/s] 29%|██▉       | 51/173 [00:04<00:09, 12.84it/s] 31%|███       | 53/173 [00:04<00:09, 12.45it/s] 32%|███▏      | 55/173 [00:04<00:09, 12.98it/s] 33%|███▎      | 57/173 [00:05<00:09, 12.64it/s] 34%|███▍      | 59/173 [00:05<00:08, 13.09it/s] 35%|███▌      | 61/173 [00:05<00:08, 12.49it/s] 36%|███▋      | 63/173 [00:05<00:08, 12.99it/s] 38%|███▊      | 65/173 [00:05<00:08, 12.39it/s] 39%|███▊      | 67/173 [00:05<00:08, 12.89it/s] 40%|███▉      | 69/173 [00:05<00:08, 12.35it/s] 41%|████      | 71/173 [00:06<00:07, 12.95it/s] 42%|████▏     | 73/173 [00:06<00:08, 12.25it/s] 43%|████▎     | 75/173 [00:06<00:07, 12.86it/s] 45%|████▍     | 77/173 [00:06<00:07, 12.26it/s] 46%|████▌     | 79/173 [00:06<00:07, 12.79it/s] 47%|████▋     | 81/173 [00:06<00:07, 12.26it/s] 48%|████▊     | 83/173 [00:07<00:07, 12.81it/s] 49%|████▉     | 85/173 [00:07<00:07, 12.14it/s] 50%|█████     | 87/173 [00:07<00:06, 12.71it/s] 51%|█████▏    | 89/173 [00:07<00:06, 12.21it/s] 53%|█████▎    | 91/173 [00:07<00:06, 12.78it/s] 54%|█████▍    | 93/173 [00:07<00:06, 12.08it/s] 55%|█████▍    | 95/173 [00:08<00:06, 12.66it/s] 56%|█████▌    | 97/173 [00:08<00:06, 12.20it/s] 57%|█████▋    | 99/173 [00:08<00:05, 12.74it/s] 58%|█████▊    | 101/173 [00:08<00:05, 12.57it/s] 60%|█████▉    | 103/173 [00:08<00:05, 13.05it/s] 61%|██████    | 105/173 [00:08<00:05, 12.40it/s] 62%|██████▏   | 107/173 [00:08<00:05, 12.94it/s] 63%|██████▎   | 109/173 [00:09<00:05, 12.67it/s] 64%|██████▍   | 111/173 [00:09<00:04, 13.13it/s] 65%|██████▌   | 113/173 [00:09<00:04, 12.61it/s] 66%|██████▋   | 115/173 [00:09<00:04, 13.10it/s] 68%|██████▊   | 117/173 [00:09<00:04, 13.44it/s] 69%|██████▉   | 119/173 [00:09<00:03, 13.69it/s] 70%|██████▉   | 121/173 [00:10<00:03, 13.87it/s] 71%|███████   | 123/173 [00:10<00:03, 14.00it/s] 72%|███████▏  | 125/173 [00:10<00:03, 14.11it/s] 73%|███████▎  | 127/173 [00:10<00:03, 14.16it/s] 75%|███████▍  | 129/173 [00:10<00:03, 14.20it/s] 76%|███████▌  | 131/173 [00:10<00:02, 14.21it/s] 77%|███████▋  | 133/173 [00:10<00:02, 14.21it/s] 78%|███████▊  | 135/173 [00:11<00:02, 13.25it/s] 79%|███████▉  | 137/173 [00:11<00:02, 13.51it/s] 80%|████████  | 139/173 [00:11<00:02, 13.72it/s] 82%|████████▏ | 141/173 [00:11<00:02, 13.79it/s] 83%|████████▎ | 143/173 [00:11<00:02, 13.92it/s] 84%|████████▍ | 145/173 [00:11<00:02, 13.80it/s] 85%|████████▍ | 147/173 [00:11<00:01, 13.71it/s] 86%|████████▌ | 149/173 [00:12<00:01, 13.14it/s] 87%|████████▋ | 151/173 [00:12<00:01, 13.27it/s] 88%|████████▊ | 153/173 [00:12<00:01, 13.01it/s] 90%|████████▉ | 155/173 [00:12<00:01, 12.99it/s] 91%|█████████ | 157/173 [00:12<00:01, 12.63it/s] 92%|█████████▏| 159/173 [00:12<00:01, 12.99it/s] 93%|█████████▎| 161/173 [00:13<00:00, 12.62it/s] 94%|█████████▍| 163/173 [00:13<00:00, 13.07it/s] 95%|█████████▌| 165/173 [00:13<00:00, 12.54it/s] 97%|█████████▋| 167/173 [00:13<00:00, 12.97it/s] 98%|█████████▊| 169/173 [00:13<00:00, 12.57it/s] 99%|█████████▉| 171/173 [00:13<00:00, 12.92it/s]100%|██████████| 173/173 [00:13<00:00, 12.44it/s]100%|██████████| 173/173 [00:14<00:00, 12.30it/s]
Total samples: 346.000000
Overall Acc: 0.881425
Mean Acc: 0.421023
FreqW Acc: 0.798225
Mean IoU: 0.348249
Class IoU:
	class 0: 0.9305150009551969
	class 1: 0.44856667407498174
	class 2: 0.7688736933191818
	class 3: 0.022348818316777593
	class 4: 0.05683605538379231
	class 5: 0.014769011530887506
	class 6: 0.04991987568550867
	class 7: 0.17393981424432084
	class 8: 0.7892120744175122
	class 9: 0.4529259633230801
	class 10: 0.7983005217501885
	class 11: 0.4382831886384797
	class 12: 0.10761221671297079
	class 13: 0.6977364278330398
	class 14: 0.02150463915153416
	class 15: 0.20070632117374893
	class 16: 0.27662630125110155
	class 17: 0.003909281669437045
	class 18: 0.36413721680347416
Class Acc:
	class 0: 0.9487419330257267
	class 1: 0.6253447705254519
	class 2: 0.9180453860205264
	class 3: 0.022799303710919396
	class 4: 0.07116816315464701
	class 5: 0.015282546434053905
	class 6: 0.05130465884189128
	class 7: 0.20071749817957718
	class 8: 0.916454470722621
	class 9: 0.5511433268797931
	class 10: 0.8944943020157596
	class 11: 0.6431623285006951
	class 12: 0.12129755166662148
	class 13: 0.8425898025164278
	class 14: 0.022035062522268955
	class 15: 0.24628119293374848
	class 16: 0.32656500802240607
	class 17: 0.003910855499584316
	class 18: 0.5780950864451336

...from 0 to 18 : best/test_before_mIoU : 0.348249
...from 0 to 18 : best/test_before_acc : 0.421023
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
==============================================
  task : 1-1
  step : 10
  Device: cuda
Namespace(amp=True, batch_size=6, bn_freeze=True, buffer=16384, cil_step=0, ckpt=None, crop_size=513, crop_val=True, curr_itrs=0, curr_step=10, data_root='/data/yt/BARM2/data_root/cityscapes', dataset='cityscapes_domain', gamma=10, gpu_id='1', initial=False, local_rank=0, loss_type='bce_loss', lr=0.01, lr_policy='poly', method='acil', model='deeplabv3_resnet101', num_classes=[1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], output_stride=16, overlap=False, print_interval=10, pseudo=True, pseudo_thresh=0.7, random_seed=1, separable_conv=False, setting='overlap', step_size=10000, subpath='BARM', target_cls=[[0], [1], [2], [3], [4], [5], [6], [7], [8], [9], [10]], task='1-1', test_only=False, train_epoch=50, unknown=0, val_batch_size=2, val_interval=100, weight_decay=0.0001)
==============================================
Category components: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
checkpoints/BARM/1-1/overlap/step9/final.pth
Model restored from checkpoints/BARM/1-1/overlap/step9/final.pth
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
Dataset: cityscapes_domain, Train set: 123, Val set: 376, Test set: 376
... train epoch : 50 , iterations : 1000 , val_interval : 100

... Training Done
[Testing Best Model]
  0%|          | 0/188 [00:00<?, ?it/s]  1%|          | 1/188 [00:00<01:50,  1.70it/s]  2%|▏         | 3/188 [00:00<00:38,  4.79it/s]  3%|▎         | 5/188 [00:00<00:25,  7.04it/s]  4%|▎         | 7/188 [00:01<00:20,  9.04it/s]  5%|▍         | 9/188 [00:01<00:18,  9.77it/s]  6%|▌         | 11/188 [00:01<00:15, 11.06it/s]  7%|▋         | 13/188 [00:01<00:15, 11.21it/s]  8%|▊         | 15/188 [00:01<00:14, 12.05it/s]  9%|▉         | 17/188 [00:01<00:14, 11.57it/s] 10%|█         | 19/188 [00:01<00:13, 12.31it/s] 11%|█         | 21/188 [00:02<00:13, 12.31it/s] 12%|█▏        | 23/188 [00:02<00:13, 12.41it/s] 13%|█▎        | 25/188 [00:02<00:13, 12.37it/s] 14%|█▍        | 27/188 [00:02<00:12, 12.42it/s] 15%|█▌        | 29/188 [00:02<00:12, 12.83it/s] 16%|█▋        | 31/188 [00:02<00:12, 12.95it/s] 18%|█▊        | 33/188 [00:03<00:12, 12.84it/s] 19%|█▊        | 35/188 [00:03<00:11, 12.76it/s] 20%|█▉        | 37/188 [00:03<00:11, 12.63it/s] 21%|██        | 39/188 [00:03<00:11, 12.49it/s] 22%|██▏       | 41/188 [00:03<00:11, 12.65it/s] 23%|██▎       | 43/188 [00:03<00:11, 12.21it/s] 24%|██▍       | 45/188 [00:04<00:11, 12.53it/s] 25%|██▌       | 47/188 [00:04<00:11, 12.45it/s] 26%|██▌       | 49/188 [00:04<00:11, 12.63it/s] 27%|██▋       | 51/188 [00:04<00:10, 12.56it/s] 28%|██▊       | 53/188 [00:04<00:10, 12.64it/s] 29%|██▉       | 55/188 [00:04<00:10, 12.71it/s] 30%|███       | 57/188 [00:05<00:10, 12.62it/s] 31%|███▏      | 59/188 [00:05<00:10, 12.72it/s] 32%|███▏      | 61/188 [00:05<00:10, 12.67it/s] 34%|███▎      | 63/188 [00:05<00:09, 12.57it/s] 35%|███▍      | 65/188 [00:05<00:09, 12.68it/s] 36%|███▌      | 67/188 [00:05<00:09, 12.59it/s] 37%|███▋      | 69/188 [00:05<00:09, 12.82it/s] 38%|███▊      | 71/188 [00:06<00:09, 12.43it/s] 39%|███▉      | 73/188 [00:06<00:08, 12.84it/s] 40%|███▉      | 75/188 [00:06<00:09, 12.11it/s] 41%|████      | 77/188 [00:06<00:08, 12.70it/s] 42%|████▏     | 79/188 [00:06<00:09, 12.07it/s] 43%|████▎     | 81/188 [00:06<00:08, 12.67it/s] 44%|████▍     | 83/188 [00:07<00:08, 12.22it/s] 45%|████▌     | 85/188 [00:07<00:08, 12.78it/s] 46%|████▋     | 87/188 [00:07<00:08, 12.20it/s] 47%|████▋     | 89/188 [00:07<00:07, 12.78it/s] 48%|████▊     | 91/188 [00:07<00:07, 12.20it/s] 49%|████▉     | 93/188 [00:07<00:07, 12.70it/s] 51%|█████     | 95/188 [00:08<00:07, 12.32it/s] 52%|█████▏    | 97/188 [00:08<00:07, 12.83it/s] 53%|█████▎    | 99/188 [00:08<00:07, 12.24it/s] 54%|█████▎    | 101/188 [00:08<00:06, 12.63it/s] 55%|█████▍    | 103/188 [00:08<00:06, 12.20it/s] 56%|█████▌    | 105/188 [00:08<00:06, 12.77it/s] 57%|█████▋    | 107/188 [00:09<00:06, 12.15it/s] 58%|█████▊    | 109/188 [00:09<00:06, 12.74it/s] 59%|█████▉    | 111/188 [00:09<00:06, 12.28it/s] 60%|██████    | 113/188 [00:09<00:05, 12.83it/s] 61%|██████    | 115/188 [00:09<00:05, 12.34it/s] 62%|██████▏   | 117/188 [00:09<00:05, 12.87it/s] 63%|██████▎   | 119/188 [00:09<00:05, 12.28it/s] 64%|██████▍   | 121/188 [00:10<00:05, 12.82it/s] 65%|██████▌   | 123/188 [00:10<00:05, 12.39it/s] 66%|██████▋   | 125/188 [00:10<00:04, 12.90it/s] 68%|██████▊   | 127/188 [00:10<00:04, 12.38it/s] 69%|██████▊   | 129/188 [00:10<00:04, 12.89it/s] 70%|██████▉   | 131/188 [00:10<00:04, 12.18it/s] 71%|███████   | 133/188 [00:11<00:04, 12.74it/s] 72%|███████▏  | 135/188 [00:11<00:04, 12.12it/s] 73%|███████▎  | 137/188 [00:11<00:04, 12.71it/s] 74%|███████▍  | 139/188 [00:11<00:04, 12.24it/s] 75%|███████▌  | 141/188 [00:11<00:03, 12.77it/s] 76%|███████▌  | 143/188 [00:11<00:03, 12.19it/s] 77%|███████▋  | 145/188 [00:12<00:03, 12.74it/s] 78%|███████▊  | 147/188 [00:12<00:03, 12.22it/s] 79%|███████▉  | 149/188 [00:12<00:03, 12.78it/s] 80%|████████  | 151/188 [00:12<00:03, 12.20it/s] 81%|████████▏ | 153/188 [00:12<00:02, 12.75it/s] 82%|████████▏ | 155/188 [00:12<00:02, 12.19it/s] 84%|████████▎ | 157/188 [00:12<00:02, 12.76it/s] 85%|████████▍ | 159/188 [00:13<00:02, 12.30it/s] 86%|████████▌ | 161/188 [00:13<00:02, 12.90it/s] 87%|████████▋ | 163/188 [00:13<00:01, 13.11it/s] 88%|████████▊ | 165/188 [00:13<00:01, 13.53it/s] 89%|████████▉ | 167/188 [00:13<00:01, 13.82it/s] 90%|████████▉ | 169/188 [00:13<00:01, 14.02it/s] 91%|█████████ | 171/188 [00:13<00:01, 14.16it/s] 92%|█████████▏| 173/188 [00:14<00:01, 14.26it/s] 93%|█████████▎| 175/188 [00:14<00:00, 14.32it/s] 94%|█████████▍| 177/188 [00:14<00:00, 14.36it/s] 95%|█████████▌| 179/188 [00:14<00:00, 14.41it/s] 96%|█████████▋| 181/188 [00:14<00:00, 14.50it/s] 97%|█████████▋| 183/188 [00:14<00:00, 14.55it/s] 98%|█████████▊| 185/188 [00:14<00:00, 14.61it/s] 99%|█████████▉| 187/188 [00:15<00:00, 14.68it/s]100%|██████████| 188/188 [00:15<00:00, 12.34it/s]
Total samples: 376.000000
Overall Acc: 0.880916
Mean Acc: 0.423933
FreqW Acc: 0.797340
Mean IoU: 0.353012
Class IoU:
	class 0: 0.9342900276007704
	class 1: 0.4563986894443451
	class 2: 0.7670723663555492
	class 3: 0.029176529119882794
	class 4: 0.09279912751471917
	class 5: 0.028225432032681387
	class 6: 0.031900363764000184
	class 7: 0.2040777118261985
	class 8: 0.7896405994565495
	class 9: 0.4197939285161414
	class 10: 0.7913946999673053
	class 11: 0.4480505991875246
	class 12: 0.07543517515294015
	class 13: 0.6798454535830186
	class 14: 0.0031519777593330732
	class 15: 0.4068987291782548
	class 16: 0.10483113551075623
	class 17: 0.061762096497605445
	class 18: 0.38247540596312163
Class Acc:
	class 0: 0.952587021000566
	class 1: 0.6276942264334583
	class 2: 0.9143805376637952
	class 3: 0.029814588003182065
	class 4: 0.11072491361903643
	class 5: 0.02958835933551761
	class 6: 0.03236183799852964
	class 7: 0.24689431369369277
	class 8: 0.9228960769609843
	class 9: 0.5269307482530915
	class 10: 0.8861068869881437
	class 11: 0.6181835344848008
	class 12: 0.08233151758269547
	class 13: 0.8408464341653533
	class 14: 0.003184831086888692
	class 15: 0.4618637613856642
	class 16: 0.12694288540903975
	class 17: 0.06417074381185632
	class 18: 0.5772233013574014

...from 0 to 18 : best/test_before_mIoU : 0.353012
...from 0 to 18 : best/test_before_acc : 0.423933
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
==============================================
  task : 1-1
  step : 11
  Device: cuda
Namespace(amp=True, batch_size=6, bn_freeze=True, buffer=16384, cil_step=0, ckpt=None, crop_size=513, crop_val=True, curr_itrs=0, curr_step=11, data_root='/data/yt/BARM2/data_root/cityscapes', dataset='cityscapes_domain', gamma=10, gpu_id='1', initial=False, local_rank=0, loss_type='bce_loss', lr=0.01, lr_policy='poly', method='acil', model='deeplabv3_resnet101', num_classes=[1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], output_stride=16, overlap=False, print_interval=10, pseudo=True, pseudo_thresh=0.7, random_seed=1, separable_conv=False, setting='overlap', step_size=10000, subpath='BARM', target_cls=[[0], [1], [2], [3], [4], [5], [6], [7], [8], [9], [10], [11]], task='1-1', test_only=False, train_epoch=50, unknown=0, val_batch_size=2, val_interval=100, weight_decay=0.0001)
==============================================
Category components: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
checkpoints/BARM/1-1/overlap/step10/final.pth
Model restored from checkpoints/BARM/1-1/overlap/step10/final.pth
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
Dataset: cityscapes_domain, Train set: 176, Val set: 421, Test set: 421
... train epoch : 50 , iterations : 1450 , val_interval : 100

... Training Done
[Testing Best Model]
  0%|          | 0/211 [00:00<?, ?it/s]  0%|          | 1/211 [00:00<02:09,  1.63it/s]  1%|▏         | 3/211 [00:00<00:45,  4.55it/s]  2%|▏         | 5/211 [00:00<00:29,  6.91it/s]  3%|▎         | 7/211 [00:01<00:23,  8.84it/s]  4%|▍         | 9/211 [00:01<00:20,  9.94it/s]  5%|▌         | 11/211 [00:01<00:17, 11.14it/s]  6%|▌         | 13/211 [00:01<00:17, 11.09it/s]  7%|▋         | 15/211 [00:01<00:16, 11.96it/s]  8%|▊         | 17/211 [00:01<00:16, 12.01it/s]  9%|▉         | 19/211 [00:01<00:15, 12.65it/s] 10%|▉         | 21/211 [00:02<00:14, 13.12it/s] 11%|█         | 23/211 [00:02<00:13, 13.47it/s] 12%|█▏        | 25/211 [00:02<00:13, 13.71it/s] 13%|█▎        | 27/211 [00:02<00:13, 13.32it/s] 14%|█▎        | 29/211 [00:02<00:13, 13.59it/s] 15%|█▍        | 31/211 [00:02<00:13, 13.08it/s] 16%|█▌        | 33/211 [00:03<00:13, 13.44it/s] 17%|█▋        | 35/211 [00:03<00:13, 12.82it/s] 18%|█▊        | 37/211 [00:03<00:13, 13.22it/s] 18%|█▊        | 39/211 [00:03<00:13, 12.61it/s] 19%|█▉        | 41/211 [00:03<00:12, 13.08it/s] 20%|██        | 43/211 [00:03<00:13, 12.39it/s] 21%|██▏       | 45/211 [00:03<00:12, 12.92it/s] 22%|██▏       | 47/211 [00:04<00:12, 12.62it/s] 23%|██▎       | 49/211 [00:04<00:12, 13.02it/s] 24%|██▍       | 51/211 [00:04<00:12, 12.90it/s] 25%|██▌       | 53/211 [00:04<00:11, 13.30it/s] 26%|██▌       | 55/211 [00:04<00:12, 12.64it/s] 27%|██▋       | 57/211 [00:04<00:11, 13.10it/s] 28%|██▊       | 59/211 [00:05<00:12, 12.40it/s] 29%|██▉       | 61/211 [00:05<00:11, 12.93it/s] 30%|██▉       | 63/211 [00:05<00:12, 12.30it/s] 31%|███       | 65/211 [00:05<00:11, 12.84it/s] 32%|███▏      | 67/211 [00:05<00:11, 12.32it/s] 33%|███▎      | 69/211 [00:05<00:11, 12.87it/s] 34%|███▎      | 71/211 [00:06<00:11, 12.31it/s] 35%|███▍      | 73/211 [00:06<00:10, 12.84it/s] 36%|███▌      | 75/211 [00:06<00:11, 11.59it/s] 36%|███▋      | 77/211 [00:06<00:10, 12.23it/s] 37%|███▋      | 79/211 [00:06<00:11, 11.76it/s] 38%|███▊      | 81/211 [00:06<00:10, 12.42it/s] 39%|███▉      | 83/211 [00:07<00:10, 11.90it/s] 40%|████      | 85/211 [00:07<00:10, 12.55it/s] 41%|████      | 87/211 [00:07<00:10, 12.18it/s] 42%|████▏     | 89/211 [00:07<00:09, 12.76it/s] 43%|████▎     | 91/211 [00:07<00:09, 12.25it/s] 44%|████▍     | 93/211 [00:07<00:09, 12.89it/s] 45%|████▌     | 95/211 [00:07<00:09, 12.21it/s] 46%|████▌     | 97/211 [00:08<00:08, 12.87it/s] 47%|████▋     | 99/211 [00:08<00:08, 12.49it/s] 48%|████▊     | 101/211 [00:08<00:08, 13.02it/s] 49%|████▉     | 103/211 [00:08<00:08, 12.57it/s] 50%|████▉     | 105/211 [00:08<00:08, 13.10it/s] 51%|█████     | 107/211 [00:08<00:08, 12.51it/s] 52%|█████▏    | 109/211 [00:09<00:07, 13.05it/s] 53%|█████▎    | 111/211 [00:09<00:08, 12.47it/s] 54%|█████▎    | 113/211 [00:09<00:07, 13.01it/s] 55%|█████▍    | 115/211 [00:09<00:07, 12.43it/s] 55%|█████▌    | 117/211 [00:09<00:07, 13.03it/s] 56%|█████▋    | 119/211 [00:09<00:07, 12.41it/s] 57%|█████▋    | 121/211 [00:09<00:06, 12.97it/s] 58%|█████▊    | 123/211 [00:10<00:07, 12.39it/s] 59%|█████▉    | 125/211 [00:10<00:06, 12.88it/s] 60%|██████    | 127/211 [00:10<00:06, 12.30it/s] 61%|██████    | 129/211 [00:10<00:06, 12.88it/s] 62%|██████▏   | 131/211 [00:10<00:06, 12.29it/s] 63%|██████▎   | 133/211 [00:10<00:06, 12.59it/s] 64%|██████▍   | 135/211 [00:11<00:06, 12.17it/s] 65%|██████▍   | 137/211 [00:11<00:05, 12.70it/s] 66%|██████▌   | 139/211 [00:11<00:05, 12.30it/s] 67%|██████▋   | 141/211 [00:11<00:05, 12.81it/s] 68%|██████▊   | 143/211 [00:11<00:05, 12.30it/s] 69%|██████▊   | 145/211 [00:11<00:05, 12.84it/s] 70%|██████▉   | 147/211 [00:12<00:05, 12.42it/s] 71%|███████   | 149/211 [00:12<00:04, 12.93it/s] 72%|███████▏  | 151/211 [00:12<00:04, 12.46it/s] 73%|███████▎  | 153/211 [00:12<00:04, 12.88it/s] 73%|███████▎  | 155/211 [00:12<00:04, 12.31it/s] 74%|███████▍  | 157/211 [00:12<00:04, 12.84it/s] 75%|███████▌  | 159/211 [00:13<00:04, 12.44it/s] 76%|███████▋  | 161/211 [00:13<00:03, 12.92it/s] 77%|███████▋  | 163/211 [00:13<00:03, 12.62it/s] 78%|███████▊  | 165/211 [00:13<00:03, 12.84it/s] 79%|███████▉  | 167/211 [00:13<00:03, 12.70it/s] 80%|████████  | 169/211 [00:13<00:03, 13.13it/s] 81%|████████  | 171/211 [00:13<00:03, 12.60it/s] 82%|████████▏ | 173/211 [00:14<00:02, 13.02it/s] 83%|████████▎ | 175/211 [00:14<00:02, 13.36it/s] 84%|████████▍ | 177/211 [00:14<00:02, 12.79it/s] 85%|████████▍ | 179/211 [00:14<00:02, 13.18it/s] 86%|████████▌ | 181/211 [00:14<00:02, 12.60it/s] 87%|████████▋ | 183/211 [00:14<00:02, 13.05it/s] 88%|████████▊ | 185/211 [00:15<00:02, 12.65it/s] 89%|████████▊ | 187/211 [00:15<00:01, 13.08it/s] 90%|████████▉ | 189/211 [00:15<00:01, 12.62it/s] 91%|█████████ | 191/211 [00:15<00:01, 13.06it/s] 91%|█████████▏| 193/211 [00:15<00:01, 12.74it/s] 92%|█████████▏| 195/211 [00:15<00:01, 13.17it/s] 93%|█████████▎| 197/211 [00:15<00:01, 12.51it/s] 94%|█████████▍| 199/211 [00:16<00:00, 12.99it/s] 95%|█████████▌| 201/211 [00:16<00:00, 12.82it/s] 96%|█████████▌| 203/211 [00:16<00:00, 13.25it/s] 97%|█████████▋| 205/211 [00:16<00:00, 13.07it/s] 98%|█████████▊| 207/211 [00:16<00:00, 13.42it/s] 99%|█████████▉| 209/211 [00:16<00:00, 13.16it/s]100%|██████████| 211/211 [00:16<00:00, 14.30it/s]100%|██████████| 211/211 [00:17<00:00, 12.35it/s]
Total samples: 421.000000
Overall Acc: 0.882088
Mean Acc: 0.410220
FreqW Acc: 0.799178
Mean IoU: 0.342359
Class IoU:
	class 0: 0.9388056821476685
	class 1: 0.45605440077385406
	class 2: 0.7549122663269244
	class 3: 0.030584581881932058
	class 4: 0.06081838676846848
	class 5: 0.02251353273621278
	class 6: 0.04510642643162211
	class 7: 0.1749811843513338
	class 8: 0.7901997641353141
	class 9: 0.46372727272683356
	class 10: 0.7911436004355131
	class 11: 0.419380510313616
	class 12: 0.06979401097000121
	class 13: 0.6822663562503398
	class 14: 0.01381584396216138
	class 15: 0.11556282134803052
	class 16: 0.24604484277590688
	class 17: 0.004910174973504143
	class 18: 0.4242037261051976
Class Acc:
	class 0: 0.9543952148878379
	class 1: 0.6390055918141745
	class 2: 0.9081481637297437
	class 3: 0.03143233954111401
	class 4: 0.06996803498544059
	class 5: 0.02353757320146658
	class 6: 0.04671837358219214
	class 7: 0.1980729841982381
	class 8: 0.9239003025148855
	class 9: 0.5495983757697194
	class 10: 0.8874156561365893
	class 11: 0.5805577313982443
	class 12: 0.07975305729165387
	class 13: 0.8464733939328737
	class 14: 0.014051140042779634
	class 15: 0.12635098215243662
	class 16: 0.2842004022008901
	class 17: 0.004965517241183625
	class 18: 0.625632181624042

...from 0 to 18 : best/test_before_mIoU : 0.342359
...from 0 to 18 : best/test_before_acc : 0.410220
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
==============================================
  task : 1-1
  step : 12
  Device: cuda
Namespace(amp=True, batch_size=6, bn_freeze=True, buffer=16384, cil_step=0, ckpt=None, crop_size=513, crop_val=True, curr_itrs=0, curr_step=12, data_root='/data/yt/BARM2/data_root/cityscapes', dataset='cityscapes_domain', gamma=10, gpu_id='1', initial=False, local_rank=0, loss_type='bce_loss', lr=0.01, lr_policy='poly', method='acil', model='deeplabv3_resnet101', num_classes=[1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], output_stride=16, overlap=False, print_interval=10, pseudo=True, pseudo_thresh=0.7, random_seed=1, separable_conv=False, setting='overlap', step_size=10000, subpath='BARM', target_cls=[[0], [1], [2], [3], [4], [5], [6], [7], [8], [9], [10], [11], [12]], task='1-1', test_only=False, train_epoch=50, unknown=0, val_batch_size=2, val_interval=100, weight_decay=0.0001)
==============================================
Category components: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
checkpoints/BARM/1-1/overlap/step11/final.pth
Model restored from checkpoints/BARM/1-1/overlap/step11/final.pth
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
Dataset: cityscapes_domain, Train set: 198, Val set: 470, Test set: 470
... train epoch : 50 , iterations : 1650 , val_interval : 100

... Training Done
[Testing Best Model]
  0%|          | 0/235 [00:00<?, ?it/s]  0%|          | 1/235 [00:00<02:21,  1.66it/s]  1%|▏         | 3/235 [00:00<00:50,  4.60it/s]  2%|▏         | 5/235 [00:00<00:32,  7.03it/s]  3%|▎         | 7/235 [00:01<00:25,  8.98it/s]  4%|▍         | 9/235 [00:01<00:22,  9.99it/s]  5%|▍         | 11/235 [00:01<00:20, 11.17it/s]  6%|▌         | 13/235 [00:01<00:19, 11.32it/s]  6%|▋         | 15/235 [00:01<00:18, 12.15it/s]  7%|▋         | 17/235 [00:01<00:18, 12.07it/s]  8%|▊         | 19/235 [00:01<00:17, 12.69it/s]  9%|▉         | 21/235 [00:02<00:17, 11.92it/s] 10%|▉         | 23/235 [00:02<00:16, 12.57it/s] 11%|█         | 25/235 [00:02<00:16, 13.08it/s] 11%|█▏        | 27/235 [00:02<00:15, 13.45it/s] 12%|█▏        | 29/235 [00:02<00:15, 13.72it/s] 13%|█▎        | 31/235 [00:02<00:15, 13.40it/s] 14%|█▍        | 33/235 [00:03<00:14, 13.70it/s] 15%|█▍        | 35/235 [00:03<00:15, 12.92it/s] 16%|█▌        | 37/235 [00:03<00:14, 13.32it/s] 17%|█▋        | 39/235 [00:03<00:15, 12.55it/s] 17%|█▋        | 41/235 [00:03<00:14, 13.05it/s] 18%|█▊        | 43/235 [00:03<00:15, 12.35it/s] 19%|█▉        | 45/235 [00:03<00:14, 12.88it/s] 20%|██        | 47/235 [00:04<00:15, 12.09it/s] 21%|██        | 49/235 [00:04<00:14, 12.71it/s] 22%|██▏       | 51/235 [00:04<00:15, 12.10it/s] 23%|██▎       | 53/235 [00:04<00:14, 12.71it/s] 23%|██▎       | 55/235 [00:04<00:14, 12.40it/s] 24%|██▍       | 57/235 [00:04<00:13, 12.91it/s] 25%|██▌       | 59/235 [00:05<00:14, 12.30it/s] 26%|██▌       | 61/235 [00:05<00:13, 12.55it/s] 27%|██▋       | 63/235 [00:05<00:13, 12.40it/s] 28%|██▊       | 65/235 [00:05<00:13, 12.85it/s] 29%|██▊       | 67/235 [00:05<00:13, 12.38it/s] 29%|██▉       | 69/235 [00:05<00:12, 12.90it/s] 30%|███       | 71/235 [00:06<00:13, 12.48it/s] 31%|███       | 73/235 [00:06<00:12, 12.96it/s] 32%|███▏      | 75/235 [00:06<00:13, 11.49it/s] 33%|███▎      | 77/235 [00:06<00:12, 12.21it/s] 34%|███▎      | 79/235 [00:06<00:13, 11.81it/s] 34%|███▍      | 81/235 [00:06<00:12, 12.46it/s] 35%|███▌      | 83/235 [00:07<00:12, 11.77it/s] 36%|███▌      | 85/235 [00:07<00:12, 12.41it/s] 37%|███▋      | 87/235 [00:07<00:12, 11.77it/s] 38%|███▊      | 89/235 [00:07<00:11, 12.43it/s] 39%|███▊      | 91/235 [00:07<00:12, 11.70it/s] 40%|███▉      | 93/235 [00:07<00:11, 12.37it/s] 40%|████      | 95/235 [00:08<00:11, 11.97it/s] 41%|████▏     | 97/235 [00:08<00:10, 12.58it/s] 42%|████▏     | 99/235 [00:08<00:11, 12.09it/s] 43%|████▎     | 101/235 [00:08<00:10, 12.69it/s] 44%|████▍     | 103/235 [00:08<00:10, 12.15it/s] 45%|████▍     | 105/235 [00:08<00:10, 12.68it/s] 46%|████▌     | 107/235 [00:09<00:10, 12.21it/s] 46%|████▋     | 109/235 [00:09<00:09, 12.74it/s] 47%|████▋     | 111/235 [00:09<00:10, 12.30it/s] 48%|████▊     | 113/235 [00:09<00:09, 12.83it/s] 49%|████▉     | 115/235 [00:09<00:09, 12.19it/s] 50%|████▉     | 117/235 [00:09<00:09, 12.74it/s] 51%|█████     | 119/235 [00:09<00:09, 12.14it/s] 51%|█████▏    | 121/235 [00:10<00:08, 12.71it/s] 52%|█████▏    | 123/235 [00:10<00:09, 12.31it/s] 53%|█████▎    | 125/235 [00:10<00:08, 12.84it/s] 54%|█████▍    | 127/235 [00:10<00:08, 12.40it/s] 55%|█████▍    | 129/235 [00:10<00:08, 12.94it/s] 56%|█████▌    | 131/235 [00:10<00:08, 12.55it/s] 57%|█████▋    | 133/235 [00:11<00:07, 12.95it/s] 57%|█████▋    | 135/235 [00:11<00:08, 12.17it/s] 58%|█████▊    | 137/235 [00:11<00:07, 12.73it/s] 59%|█████▉    | 139/235 [00:11<00:07, 12.30it/s] 60%|██████    | 141/235 [00:11<00:07, 12.82it/s] 61%|██████    | 143/235 [00:11<00:07, 12.40it/s] 62%|██████▏   | 145/235 [00:12<00:06, 12.93it/s] 63%|██████▎   | 147/235 [00:12<00:07, 12.28it/s] 63%|██████▎   | 149/235 [00:12<00:06, 12.84it/s] 64%|██████▍   | 151/235 [00:12<00:06, 12.29it/s] 65%|██████▌   | 153/235 [00:12<00:06, 12.83it/s] 66%|██████▌   | 155/235 [00:12<00:06, 12.31it/s] 67%|██████▋   | 157/235 [00:12<00:06, 12.85it/s] 68%|██████▊   | 159/235 [00:13<00:06, 12.23it/s] 69%|██████▊   | 161/235 [00:13<00:05, 12.79it/s] 69%|██████▉   | 163/235 [00:13<00:05, 12.25it/s] 70%|███████   | 165/235 [00:13<00:05, 12.80it/s] 71%|███████   | 167/235 [00:13<00:05, 12.31it/s] 72%|███████▏  | 169/235 [00:13<00:05, 12.85it/s] 73%|███████▎  | 171/235 [00:14<00:05, 12.49it/s] 74%|███████▎  | 173/235 [00:14<00:04, 12.99it/s] 74%|███████▍  | 175/235 [00:14<00:04, 12.40it/s] 75%|███████▌  | 177/235 [00:14<00:04, 12.92it/s] 76%|███████▌  | 179/235 [00:14<00:04, 12.21it/s] 77%|███████▋  | 181/235 [00:14<00:04, 12.75it/s] 78%|███████▊  | 183/235 [00:15<00:04, 12.20it/s] 79%|███████▊  | 185/235 [00:15<00:03, 12.75it/s] 80%|███████▉  | 187/235 [00:15<00:03, 12.33it/s] 80%|████████  | 189/235 [00:15<00:03, 12.89it/s] 81%|████████▏ | 191/235 [00:15<00:03, 12.46it/s] 82%|████████▏ | 193/235 [00:15<00:03, 12.97it/s] 83%|████████▎ | 195/235 [00:16<00:03, 12.57it/s] 84%|████████▍ | 197/235 [00:16<00:02, 13.05it/s] 85%|████████▍ | 199/235 [00:16<00:02, 12.53it/s] 86%|████████▌ | 201/235 [00:16<00:02, 13.00it/s] 86%|████████▋ | 203/235 [00:16<00:02, 12.44it/s] 87%|████████▋ | 205/235 [00:16<00:02, 12.94it/s] 88%|████████▊ | 207/235 [00:16<00:02, 12.40it/s] 89%|████████▉ | 209/235 [00:17<00:02, 12.90it/s] 90%|████████▉ | 211/235 [00:17<00:01, 12.56it/s] 91%|█████████ | 213/235 [00:17<00:01, 13.03it/s] 91%|█████████▏| 215/235 [00:17<00:01, 12.66it/s] 92%|█████████▏| 217/235 [00:17<00:01, 13.05it/s] 93%|█████████▎| 219/235 [00:17<00:01, 12.57it/s] 94%|█████████▍| 221/235 [00:18<00:01, 13.05it/s] 95%|█████████▍| 223/235 [00:18<00:00, 12.38it/s] 96%|█████████▌| 225/235 [00:18<00:00, 12.88it/s] 97%|█████████▋| 227/235 [00:18<00:00, 12.36it/s] 97%|█████████▋| 229/235 [00:18<00:00, 12.87it/s] 98%|█████████▊| 231/235 [00:18<00:00, 12.32it/s] 99%|█████████▉| 233/235 [00:18<00:00, 12.87it/s]100%|██████████| 235/235 [00:19<00:00, 12.49it/s]100%|██████████| 235/235 [00:19<00:00, 12.21it/s]
Total samples: 470.000000
Overall Acc: 0.879160
Mean Acc: 0.430618
FreqW Acc: 0.794968
Mean IoU: 0.354610
Class IoU:
	class 0: 0.9374462300597112
	class 1: 0.442940989974086
	class 2: 0.7544725940601738
	class 3: 0.022043693896730353
	class 4: 0.052060395517434646
	class 5: 0.023922819512591374
	class 6: 0.053384533275197946
	class 7: 0.1838994603549955
	class 8: 0.787270206170212
	class 9: 0.4124888768932329
	class 10: 0.7874579685449042
	class 11: 0.45071859281473087
	class 12: 0.04681662354243919
	class 13: 0.6878443808913037
	class 14: 0.011762909683070628
	class 15: 0.34040675116289315
	class 16: 0.21922388240776913
	class 17: 0.11462037863595666
	class 18: 0.40881581178361237
Class Acc:
	class 0: 0.9552841469833884
	class 1: 0.6152704493446461
	class 2: 0.9055694348071638
	class 3: 0.022359391110507113
	class 4: 0.060481382114854314
	class 5: 0.025163528560249705
	class 6: 0.055710004011725815
	class 7: 0.21603342404539802
	class 8: 0.9225508944317679
	class 9: 0.5052280850278367
	class 10: 0.8913798815187338
	class 11: 0.6203584808715071
	class 12: 0.053677743457087826
	class 13: 0.8510061913921815
	class 14: 0.012025625995012067
	class 15: 0.5028778593478943
	class 16: 0.23093399830436903
	class 17: 0.12453345171534334
	class 18: 0.6112958978990922

...from 0 to 18 : best/test_before_mIoU : 0.354610
...from 0 to 18 : best/test_before_acc : 0.430618
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
==============================================
  task : 1-1
  step : 13
  Device: cuda
Namespace(amp=True, batch_size=6, bn_freeze=True, buffer=16384, cil_step=0, ckpt=None, crop_size=513, crop_val=True, curr_itrs=0, curr_step=13, data_root='/data/yt/BARM2/data_root/cityscapes', dataset='cityscapes_domain', gamma=10, gpu_id='1', initial=False, local_rank=0, loss_type='bce_loss', lr=0.01, lr_policy='poly', method='acil', model='deeplabv3_resnet101', num_classes=[1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], output_stride=16, overlap=False, print_interval=10, pseudo=True, pseudo_thresh=0.7, random_seed=1, separable_conv=False, setting='overlap', step_size=10000, subpath='BARM', target_cls=[[0], [1], [2], [3], [4], [5], [6], [7], [8], [9], [10], [11], [12], [13]], task='1-1', test_only=False, train_epoch=50, unknown=0, val_batch_size=2, val_interval=100, weight_decay=0.0001)
==============================================
Category components: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
checkpoints/BARM/1-1/overlap/step12/final.pth
Model restored from checkpoints/BARM/1-1/overlap/step12/final.pth
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
Dataset: cityscapes_domain, Train set: 95, Val set: 494, Test set: 494
... train epoch : 50 , iterations : 750 , val_interval : 100

... Training Done
[Testing Best Model]
  0%|          | 0/247 [00:00<?, ?it/s]  0%|          | 1/247 [00:00<02:34,  1.60it/s]  1%|          | 2/247 [00:00<01:30,  2.69it/s]  2%|▏         | 4/247 [00:00<00:45,  5.39it/s]  2%|▏         | 6/247 [00:01<00:34,  7.04it/s]  3%|▎         | 8/247 [00:01<00:27,  8.83it/s]  4%|▍         | 10/247 [00:01<00:24,  9.72it/s]  5%|▍         | 12/247 [00:01<00:21, 10.88it/s]  6%|▌         | 14/247 [00:01<00:20, 11.24it/s]  6%|▋         | 16/247 [00:01<00:19, 12.06it/s]  7%|▋         | 18/247 [00:02<00:19, 11.53it/s]  8%|▊         | 20/247 [00:02<00:18, 12.26it/s]  9%|▉         | 22/247 [00:02<00:17, 12.81it/s] 10%|▉         | 24/247 [00:02<00:16, 13.24it/s] 11%|█         | 26/247 [00:02<00:16, 13.55it/s] 11%|█▏        | 28/247 [00:02<00:16, 13.65it/s] 12%|█▏        | 30/247 [00:02<00:15, 13.81it/s] 13%|█▎        | 32/247 [00:03<00:15, 13.96it/s] 14%|█▍        | 34/247 [00:03<00:15, 13.43it/s] 15%|█▍        | 36/247 [00:03<00:15, 13.70it/s] 15%|█▌        | 38/247 [00:03<00:16, 12.90it/s] 16%|█▌        | 40/247 [00:03<00:15, 13.29it/s] 17%|█▋        | 42/247 [00:03<00:16, 12.58it/s] 18%|█▊        | 44/247 [00:04<00:15, 13.05it/s] 19%|█▊        | 46/247 [00:04<00:15, 12.70it/s] 19%|█▉        | 48/247 [00:04<00:15, 13.13it/s] 20%|██        | 50/247 [00:04<00:15, 12.54it/s] 21%|██        | 52/247 [00:04<00:14, 13.03it/s] 22%|██▏       | 54/247 [00:04<00:15, 12.64it/s] 23%|██▎       | 56/247 [00:04<00:14, 13.08it/s] 23%|██▎       | 58/247 [00:05<00:15, 12.46it/s] 24%|██▍       | 60/247 [00:05<00:14, 12.96it/s] 25%|██▌       | 62/247 [00:05<00:15, 12.27it/s] 26%|██▌       | 64/247 [00:05<00:14, 12.82it/s] 27%|██▋       | 66/247 [00:05<00:15, 12.04it/s] 28%|██▊       | 68/247 [00:05<00:14, 12.65it/s] 28%|██▊       | 70/247 [00:06<00:14, 12.11it/s] 29%|██▉       | 72/247 [00:06<00:13, 12.71it/s] 30%|██▉       | 74/247 [00:06<00:13, 12.50it/s] 31%|███       | 76/247 [00:06<00:13, 12.99it/s] 32%|███▏      | 78/247 [00:06<00:13, 12.53it/s] 32%|███▏      | 80/247 [00:06<00:12, 13.02it/s] 33%|███▎      | 82/247 [00:07<00:13, 12.49it/s] 34%|███▍      | 84/247 [00:07<00:12, 13.00it/s] 35%|███▍      | 86/247 [00:07<00:12, 12.55it/s] 36%|███▌      | 88/247 [00:07<00:12, 13.04it/s] 36%|███▋      | 90/247 [00:07<00:12, 12.62it/s] 37%|███▋      | 92/247 [00:07<00:11, 13.13it/s] 38%|███▊      | 94/247 [00:07<00:11, 13.45it/s] 39%|███▉      | 96/247 [00:08<00:11, 13.73it/s] 40%|███▉      | 98/247 [00:08<00:10, 13.90it/s] 40%|████      | 100/247 [00:08<00:10, 13.97it/s] 41%|████▏     | 102/247 [00:08<00:10, 14.07it/s] 42%|████▏     | 104/247 [00:08<00:10, 14.17it/s] 43%|████▎     | 106/247 [00:08<00:09, 14.25it/s] 44%|████▎     | 108/247 [00:08<00:09, 14.24it/s] 45%|████▍     | 110/247 [00:09<00:09, 14.25it/s] 45%|████▌     | 112/247 [00:09<00:10, 13.47it/s] 46%|████▌     | 114/247 [00:09<00:09, 13.72it/s] 47%|████▋     | 116/247 [00:09<00:10, 12.85it/s] 48%|████▊     | 118/247 [00:09<00:09, 13.26it/s] 49%|████▊     | 120/247 [00:09<00:09, 12.72it/s] 49%|████▉     | 122/247 [00:09<00:09, 13.09it/s] 50%|█████     | 124/247 [00:10<00:09, 12.51it/s] 51%|█████     | 126/247 [00:10<00:09, 13.00it/s] 52%|█████▏    | 128/247 [00:10<00:10, 11.82it/s] 53%|█████▎    | 130/247 [00:10<00:09, 12.48it/s] 53%|█████▎    | 132/247 [00:10<00:09, 12.64it/s] 54%|█████▍    | 134/247 [00:10<00:08, 13.10it/s] 55%|█████▌    | 136/247 [00:11<00:08, 12.56it/s] 56%|█████▌    | 138/247 [00:11<00:08, 13.04it/s] 57%|█████▋    | 140/247 [00:11<00:08, 12.45it/s] 57%|█████▋    | 142/247 [00:11<00:08, 12.94it/s] 58%|█████▊    | 144/247 [00:11<00:08, 12.32it/s] 59%|█████▉    | 146/247 [00:11<00:07, 12.87it/s] 60%|█████▉    | 148/247 [00:12<00:08, 12.34it/s] 61%|██████    | 150/247 [00:12<00:07, 12.87it/s] 62%|██████▏   | 152/247 [00:12<00:07, 12.43it/s] 62%|██████▏   | 154/247 [00:12<00:07, 12.95it/s] 63%|██████▎   | 156/247 [00:12<00:07, 12.62it/s] 64%|██████▍   | 158/247 [00:12<00:06, 13.09it/s] 65%|██████▍   | 160/247 [00:13<00:06, 12.45it/s] 66%|██████▌   | 162/247 [00:13<00:06, 12.95it/s] 66%|██████▋   | 164/247 [00:13<00:06, 12.41it/s] 67%|██████▋   | 166/247 [00:13<00:06, 12.94it/s] 68%|██████▊   | 168/247 [00:13<00:06, 12.36it/s] 69%|██████▉   | 170/247 [00:13<00:05, 12.88it/s] 70%|██████▉   | 172/247 [00:13<00:06, 12.40it/s] 70%|███████   | 174/247 [00:14<00:05, 12.93it/s] 71%|███████▏  | 176/247 [00:14<00:05, 12.42it/s] 72%|███████▏  | 178/247 [00:14<00:05, 12.94it/s] 73%|███████▎  | 180/247 [00:14<00:05, 12.33it/s] 74%|███████▎  | 182/247 [00:14<00:05, 12.87it/s] 74%|███████▍  | 184/247 [00:14<00:05, 12.42it/s] 75%|███████▌  | 186/247 [00:15<00:04, 12.94it/s] 76%|███████▌  | 188/247 [00:15<00:04, 12.51it/s] 77%|███████▋  | 190/247 [00:15<00:04, 12.93it/s] 78%|███████▊  | 192/247 [00:15<00:04, 12.65it/s] 79%|███████▊  | 194/247 [00:15<00:04, 13.12it/s] 79%|███████▉  | 196/247 [00:15<00:04, 12.48it/s] 80%|████████  | 198/247 [00:15<00:03, 13.01it/s] 81%|████████  | 200/247 [00:16<00:03, 12.39it/s] 82%|████████▏ | 202/247 [00:16<00:03, 12.94it/s] 83%|████████▎ | 204/247 [00:16<00:03, 12.40it/s] 83%|████████▎ | 206/247 [00:16<00:03, 12.92it/s] 84%|████████▍ | 208/247 [00:16<00:03, 12.42it/s] 85%|████████▌ | 210/247 [00:16<00:02, 12.95it/s] 86%|████████▌ | 212/247 [00:17<00:02, 12.37it/s] 87%|████████▋ | 214/247 [00:17<00:02, 12.92it/s] 87%|████████▋ | 216/247 [00:17<00:02, 12.52it/s] 88%|████████▊ | 218/247 [00:17<00:02, 13.03it/s] 89%|████████▉ | 220/247 [00:17<00:02, 12.64it/s] 90%|████████▉ | 222/247 [00:17<00:01, 13.10it/s] 91%|█████████ | 224/247 [00:18<00:01, 12.46it/s] 91%|█████████▏| 226/247 [00:18<00:01, 12.96it/s] 92%|█████████▏| 228/247 [00:18<00:01, 12.42it/s] 93%|█████████▎| 230/247 [00:18<00:01, 12.96it/s] 94%|█████████▍| 232/247 [00:18<00:01, 12.82it/s] 95%|█████████▍| 234/247 [00:18<00:00, 13.26it/s] 96%|█████████▌| 236/247 [00:18<00:00, 12.47it/s] 96%|█████████▋| 238/247 [00:19<00:00, 13.00it/s] 97%|█████████▋| 240/247 [00:19<00:00, 12.82it/s] 98%|█████████▊| 242/247 [00:19<00:00, 13.27it/s] 99%|█████████▉| 244/247 [00:19<00:00, 12.57it/s]100%|█████████▉| 246/247 [00:19<00:00, 13.13it/s]100%|██████████| 247/247 [00:19<00:00, 12.41it/s]
Total samples: 494.000000
Overall Acc: 0.879236
Mean Acc: 0.435795
FreqW Acc: 0.795192
Mean IoU: 0.358819
Class IoU:
	class 0: 0.9377507494831221
	class 1: 0.4638727095358115
	class 2: 0.7594640346341852
	class 3: 0.06492568797120096
	class 4: 0.06529706114406779
	class 5: 0.028603085985591938
	class 6: 0.0595625592006391
	class 7: 0.19881446321578403
	class 8: 0.7882702616264293
	class 9: 0.4272575883366732
	class 10: 0.7893094963011152
	class 11: 0.461334661233168
	class 12: 0.07228380609886353
	class 13: 0.6823871569035537
	class 14: 0.024924205624612908
	class 15: 0.25686507295257194
	class 16: 0.2197721295718974
	class 17: 0.11931096280483998
	class 18: 0.3975634979973745
Class Acc:
	class 0: 0.9556860525990318
	class 1: 0.6436055269615649
	class 2: 0.907927353707817
	class 3: 0.06674477615790471
	class 4: 0.0757917104357063
	class 5: 0.030301722084581102
	class 6: 0.06188629277190161
	class 7: 0.2346413227355303
	class 8: 0.9210959892933009
	class 9: 0.5118970448696116
	class 10: 0.8925219090923614
	class 11: 0.6483674343249896
	class 12: 0.07881141202371718
	class 13: 0.8479810314358457
	class 14: 0.025682803567887925
	class 15: 0.4345423430677956
	class 16: 0.2323644370804392
	class 17: 0.12750843290653038
	class 18: 0.5827543687505353

...from 0 to 18 : best/test_before_mIoU : 0.358819
...from 0 to 18 : best/test_before_acc : 0.435795
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
==============================================
  task : 1-1
  step : 14
  Device: cuda
Namespace(amp=True, batch_size=6, bn_freeze=True, buffer=16384, cil_step=0, ckpt=None, crop_size=513, crop_val=True, curr_itrs=0, curr_step=14, data_root='/data/yt/BARM2/data_root/cityscapes', dataset='cityscapes_domain', gamma=10, gpu_id='1', initial=False, local_rank=0, loss_type='bce_loss', lr=0.01, lr_policy='poly', method='acil', model='deeplabv3_resnet101', num_classes=[1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], output_stride=16, overlap=False, print_interval=10, pseudo=True, pseudo_thresh=0.7, random_seed=1, separable_conv=False, setting='overlap', step_size=10000, subpath='BARM', target_cls=[[0], [1], [2], [3], [4], [5], [6], [7], [8], [9], [10], [11], [12], [13], [14]], task='1-1', test_only=False, train_epoch=50, unknown=0, val_batch_size=2, val_interval=100, weight_decay=0.0001)
==============================================
Category components: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
checkpoints/BARM/1-1/overlap/step13/final.pth
Model restored from checkpoints/BARM/1-1/overlap/step13/final.pth
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
Dataset: cityscapes_domain, Train set: 75, Val set: 513, Test set: 513
... train epoch : 50 , iterations : 600 , val_interval : 100

... Training Done
[Testing Best Model]
  0%|          | 0/257 [00:00<?, ?it/s]  0%|          | 1/257 [00:00<02:38,  1.61it/s]  1%|          | 3/257 [00:00<00:54,  4.62it/s]  2%|▏         | 5/257 [00:00<00:35,  7.06it/s]  3%|▎         | 7/257 [00:01<00:27,  9.01it/s]  4%|▎         | 9/257 [00:01<00:25,  9.85it/s]  4%|▍         | 11/257 [00:01<00:22, 11.01it/s]  5%|▌         | 13/257 [00:01<00:21, 11.10it/s]  6%|▌         | 15/257 [00:01<00:20, 11.97it/s]  7%|▋         | 17/257 [00:01<00:20, 11.90it/s]  7%|▋         | 19/257 [00:01<00:18, 12.57it/s]  8%|▊         | 21/257 [00:02<00:19, 12.37it/s]  9%|▉         | 23/257 [00:02<00:18, 12.91it/s] 10%|▉         | 25/257 [00:02<00:17, 13.31it/s] 11%|█         | 27/257 [00:02<00:16, 13.60it/s] 11%|█▏        | 29/257 [00:02<00:16, 13.81it/s] 12%|█▏        | 31/257 [00:02<00:16, 13.96it/s] 13%|█▎        | 33/257 [00:02<00:16, 13.99it/s] 14%|█▎        | 35/257 [00:03<00:16, 13.35it/s] 14%|█▍        | 37/257 [00:03<00:16, 13.55it/s] 15%|█▌        | 39/257 [00:03<00:17, 12.76it/s] 16%|█▌        | 41/257 [00:03<00:16, 13.23it/s] 17%|█▋        | 43/257 [00:03<00:16, 12.68it/s] 18%|█▊        | 45/257 [00:03<00:16, 13.19it/s] 18%|█▊        | 47/257 [00:04<00:16, 12.67it/s] 19%|█▉        | 49/257 [00:04<00:15, 13.15it/s] 20%|█▉        | 51/257 [00:04<00:16, 12.42it/s] 21%|██        | 53/257 [00:04<00:15, 12.95it/s] 21%|██▏       | 55/257 [00:04<00:16, 12.44it/s] 22%|██▏       | 57/257 [00:04<00:15, 13.00it/s] 23%|██▎       | 59/257 [00:05<00:15, 12.42it/s] 24%|██▎       | 61/257 [00:05<00:15, 12.98it/s] 25%|██▍       | 63/257 [00:05<00:15, 12.37it/s] 25%|██▌       | 65/257 [00:05<00:14, 12.94it/s] 26%|██▌       | 67/257 [00:05<00:15, 12.51it/s] 27%|██▋       | 69/257 [00:05<00:14, 13.05it/s] 28%|██▊       | 71/257 [00:05<00:14, 12.51it/s] 28%|██▊       | 73/257 [00:06<00:14, 13.06it/s] 29%|██▉       | 75/257 [00:06<00:14, 12.36it/s] 30%|██▉       | 77/257 [00:06<00:13, 12.96it/s] 31%|███       | 79/257 [00:06<00:14, 12.38it/s] 32%|███▏      | 81/257 [00:06<00:13, 12.96it/s] 32%|███▏      | 83/257 [00:06<00:14, 12.31it/s] 33%|███▎      | 85/257 [00:07<00:13, 12.87it/s] 34%|███▍      | 87/257 [00:07<00:13, 12.23it/s] 35%|███▍      | 89/257 [00:07<00:13, 12.78it/s] 35%|███▌      | 91/257 [00:07<00:13, 12.42it/s] 36%|███▌      | 93/257 [00:07<00:12, 12.93it/s] 37%|███▋      | 95/257 [00:07<00:13, 12.33it/s] 38%|███▊      | 97/257 [00:08<00:12, 12.88it/s] 39%|███▊      | 99/257 [00:08<00:12, 12.34it/s] 39%|███▉      | 101/257 [00:08<00:12, 12.87it/s] 40%|████      | 103/257 [00:08<00:12, 12.39it/s] 41%|████      | 105/257 [00:08<00:11, 12.90it/s] 42%|████▏     | 107/257 [00:08<00:12, 12.30it/s] 42%|████▏     | 109/257 [00:08<00:11, 12.82it/s] 43%|████▎     | 111/257 [00:09<00:11, 12.39it/s] 44%|████▍     | 113/257 [00:09<00:11, 12.92it/s] 45%|████▍     | 115/257 [00:09<00:11, 12.33it/s] 46%|████▌     | 117/257 [00:09<00:10, 12.84it/s] 46%|████▋     | 119/257 [00:09<00:10, 12.63it/s] 47%|████▋     | 121/257 [00:09<00:10, 13.08it/s] 48%|████▊     | 123/257 [00:10<00:10, 12.86it/s] 49%|████▊     | 125/257 [00:10<00:09, 13.25it/s] 49%|████▉     | 127/257 [00:10<00:10, 12.53it/s] 50%|█████     | 129/257 [00:10<00:10, 11.90it/s] 51%|█████     | 131/257 [00:10<00:10, 12.51it/s] 52%|█████▏    | 133/257 [00:10<00:09, 12.99it/s] 53%|█████▎    | 135/257 [00:11<00:09, 12.88it/s] 53%|█████▎    | 137/257 [00:11<00:09, 13.28it/s] 54%|█████▍    | 139/257 [00:11<00:09, 12.37it/s] 55%|█████▍    | 141/257 [00:11<00:08, 12.91it/s] 56%|█████▌    | 143/257 [00:11<00:09, 12.63it/s] 56%|█████▋    | 145/257 [00:11<00:08, 13.11it/s] 57%|█████▋    | 147/257 [00:11<00:08, 12.38it/s] 58%|█████▊    | 149/257 [00:12<00:08, 12.91it/s] 59%|█████▉    | 151/257 [00:12<00:08, 12.32it/s] 60%|█████▉    | 153/257 [00:12<00:08, 12.87it/s] 60%|██████    | 155/257 [00:12<00:08, 12.53it/s] 61%|██████    | 157/257 [00:12<00:07, 13.03it/s] 62%|██████▏   | 159/257 [00:12<00:07, 12.54it/s] 63%|██████▎   | 161/257 [00:13<00:07, 13.03it/s] 63%|██████▎   | 163/257 [00:13<00:07, 12.62it/s] 64%|██████▍   | 165/257 [00:13<00:07, 13.10it/s] 65%|██████▍   | 167/257 [00:13<00:07, 12.58it/s] 66%|██████▌   | 169/257 [00:13<00:06, 13.05it/s] 67%|██████▋   | 171/257 [00:13<00:06, 12.31it/s] 67%|██████▋   | 173/257 [00:14<00:06, 12.87it/s] 68%|██████▊   | 175/257 [00:14<00:06, 12.25it/s] 69%|██████▉   | 177/257 [00:14<00:06, 12.80it/s] 70%|██████▉   | 179/257 [00:14<00:06, 12.48it/s] 70%|███████   | 181/257 [00:14<00:05, 12.99it/s] 71%|███████   | 183/257 [00:14<00:05, 12.35it/s] 72%|███████▏  | 185/257 [00:14<00:05, 12.91it/s] 73%|███████▎  | 187/257 [00:15<00:05, 12.29it/s] 74%|███████▎  | 189/257 [00:15<00:05, 12.83it/s] 74%|███████▍  | 191/257 [00:15<00:05, 12.48it/s] 75%|███████▌  | 193/257 [00:15<00:04, 13.01it/s] 76%|███████▌  | 195/257 [00:15<00:04, 12.60it/s] 77%|███████▋  | 197/257 [00:15<00:04, 13.07it/s] 77%|███████▋  | 199/257 [00:16<00:04, 12.38it/s] 78%|███████▊  | 201/257 [00:16<00:04, 12.93it/s] 79%|███████▉  | 203/257 [00:16<00:04, 12.33it/s] 80%|███████▉  | 205/257 [00:16<00:04, 12.89it/s] 81%|████████  | 207/257 [00:16<00:04, 12.41it/s] 81%|████████▏ | 209/257 [00:16<00:03, 12.93it/s] 82%|████████▏ | 211/257 [00:17<00:03, 12.47it/s] 83%|████████▎ | 213/257 [00:17<00:03, 12.96it/s] 84%|████████▎ | 215/257 [00:17<00:03, 12.53it/s] 84%|████████▍ | 217/257 [00:17<00:03, 13.02it/s] 85%|████████▌ | 219/257 [00:17<00:03, 12.60it/s] 86%|████████▌ | 221/257 [00:17<00:02, 13.07it/s] 87%|████████▋ | 223/257 [00:17<00:02, 12.47it/s] 88%|████████▊ | 225/257 [00:18<00:02, 12.98it/s] 88%|████████▊ | 227/257 [00:18<00:02, 12.40it/s] 89%|████████▉ | 229/257 [00:18<00:02, 12.93it/s] 90%|████████▉ | 231/257 [00:18<00:02, 12.51it/s] 91%|█████████ | 233/257 [00:18<00:01, 13.00it/s] 91%|█████████▏| 235/257 [00:18<00:01, 12.41it/s] 92%|█████████▏| 237/257 [00:19<00:01, 12.94it/s] 93%|█████████▎| 239/257 [00:19<00:01, 13.33it/s] 94%|█████████▍| 241/257 [00:19<00:01, 13.63it/s] 95%|█████████▍| 243/257 [00:19<00:01, 13.83it/s] 95%|█████████▌| 245/257 [00:19<00:00, 13.94it/s] 96%|█████████▌| 247/257 [00:19<00:00, 14.04it/s] 97%|█████████▋| 249/257 [00:19<00:00, 14.12it/s] 98%|█████████▊| 251/257 [00:20<00:00, 14.19it/s] 98%|█████████▊| 253/257 [00:20<00:00, 14.24it/s] 99%|█████████▉| 255/257 [00:20<00:00, 14.29it/s]100%|██████████| 257/257 [00:20<00:00, 15.23it/s]100%|██████████| 257/257 [00:20<00:00, 12.53it/s]
Total samples: 513.000000
Overall Acc: 0.878581
Mean Acc: 0.429000
FreqW Acc: 0.794382
Mean IoU: 0.353788
Class IoU:
	class 0: 0.9362597358087733
	class 1: 0.4500120524035445
	class 2: 0.7534587527131391
	class 3: 0.055802431905446905
	class 4: 0.0544852171289037
	class 5: 0.02281433450758807
	class 6: 0.05020003729487616
	class 7: 0.19121463462493143
	class 8: 0.78614010626177
	class 9: 0.42654105156798827
	class 10: 0.7904815881204673
	class 11: 0.4609025268134356
	class 12: 0.06809687059734658
	class 13: 0.682966434391317
	class 14: 0.019442348641015902
	class 15: 0.23420193846308532
	class 16: 0.21335196513889396
	class 17: 0.11107348883733292
	class 18: 0.4145285432919946
Class Acc:
	class 0: 0.9537824899227317
	class 1: 0.6340683597601725
	class 2: 0.9055860677592231
	class 3: 0.0578317018449223
	class 4: 0.061639366478286196
	class 5: 0.024067256038842664
	class 6: 0.052257737189013484
	class 7: 0.22650594516651953
	class 8: 0.9193554251307381
	class 9: 0.5155263616450356
	class 10: 0.893338577992181
	class 11: 0.6509128947013131
	class 12: 0.07363527096426484
	class 13: 0.8466550928718568
	class 14: 0.020477646942408022
	class 15: 0.34864971704212794
	class 16: 0.22990580080675713
	class 17: 0.11801151201676156
	class 18: 0.6187974852233521

...from 0 to 18 : best/test_before_mIoU : 0.353788
...from 0 to 18 : best/test_before_acc : 0.429000
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
==============================================
  task : 1-1
  step : 15
  Device: cuda
Namespace(amp=True, batch_size=6, bn_freeze=True, buffer=16384, cil_step=0, ckpt=None, crop_size=513, crop_val=True, curr_itrs=0, curr_step=15, data_root='/data/yt/BARM2/data_root/cityscapes', dataset='cityscapes_domain', gamma=10, gpu_id='1', initial=False, local_rank=0, loss_type='bce_loss', lr=0.01, lr_policy='poly', method='acil', model='deeplabv3_resnet101', num_classes=[1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], output_stride=16, overlap=False, print_interval=10, pseudo=True, pseudo_thresh=0.7, random_seed=1, separable_conv=False, setting='overlap', step_size=10000, subpath='BARM', target_cls=[[0], [1], [2], [3], [4], [5], [6], [7], [8], [9], [10], [11], [12], [13], [14], [15]], task='1-1', test_only=False, train_epoch=50, unknown=0, val_batch_size=2, val_interval=100, weight_decay=0.0001)
==============================================
Category components: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
checkpoints/BARM/1-1/overlap/step14/final.pth
Model restored from checkpoints/BARM/1-1/overlap/step14/final.pth
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
Dataset: cityscapes_domain, Train set: 156, Val set: 552, Test set: 552
... train epoch : 50 , iterations : 1300 , val_interval : 100

... Training Done
[Testing Best Model]
  0%|          | 0/276 [00:00<?, ?it/s]  0%|          | 1/276 [00:00<02:48,  1.63it/s]  1%|          | 3/276 [00:00<00:58,  4.67it/s]  2%|▏         | 5/276 [00:00<00:37,  7.15it/s]  3%|▎         | 7/276 [00:01<00:29,  9.10it/s]  3%|▎         | 9/276 [00:01<00:27,  9.67it/s]  4%|▍         | 11/276 [00:01<00:24, 10.91it/s]  5%|▍         | 13/276 [00:01<00:23, 11.35it/s]  5%|▌         | 15/276 [00:01<00:21, 12.16it/s]  6%|▌         | 17/276 [00:01<00:21, 11.84it/s]  7%|▋         | 19/276 [00:01<00:20, 12.53it/s]  8%|▊         | 21/276 [00:02<00:20, 12.57it/s]  8%|▊         | 23/276 [00:02<00:19, 13.08it/s]  9%|▉         | 25/276 [00:02<00:18, 13.45it/s] 10%|▉         | 27/276 [00:02<00:18, 13.31it/s] 11%|█         | 29/276 [00:02<00:18, 13.62it/s] 11%|█         | 31/276 [00:02<00:19, 12.32it/s] 12%|█▏        | 33/276 [00:03<00:18, 12.88it/s] 13%|█▎        | 35/276 [00:03<00:20, 11.88it/s] 13%|█▎        | 37/276 [00:03<00:19, 12.52it/s] 14%|█▍        | 39/276 [00:03<00:19, 12.25it/s] 15%|█▍        | 41/276 [00:03<00:18, 12.81it/s] 16%|█▌        | 43/276 [00:03<00:18, 12.26it/s] 16%|█▋        | 45/276 [00:04<00:18, 12.83it/s] 17%|█▋        | 47/276 [00:04<00:18, 12.24it/s] 18%|█▊        | 49/276 [00:04<00:17, 12.81it/s] 18%|█▊        | 51/276 [00:04<00:18, 12.30it/s] 19%|█▉        | 53/276 [00:04<00:17, 12.85it/s] 20%|█▉        | 55/276 [00:04<00:18, 12.12it/s] 21%|██        | 57/276 [00:04<00:17, 12.73it/s] 21%|██▏       | 59/276 [00:05<00:17, 12.21it/s] 22%|██▏       | 61/276 [00:05<00:16, 12.77it/s] 23%|██▎       | 63/276 [00:05<00:17, 12.37it/s] 24%|██▎       | 65/276 [00:05<00:16, 12.91it/s] 24%|██▍       | 67/276 [00:05<00:16, 12.39it/s] 25%|██▌       | 69/276 [00:05<00:16, 12.93it/s] 26%|██▌       | 71/276 [00:06<00:16, 12.25it/s] 26%|██▋       | 73/276 [00:06<00:15, 12.83it/s] 27%|██▋       | 75/276 [00:06<00:16, 12.03it/s] 28%|██▊       | 77/276 [00:06<00:15, 12.64it/s] 29%|██▊       | 79/276 [00:07<00:28,  6.87it/s] 29%|██▉       | 81/276 [00:07<00:23,  8.14it/s] 30%|███       | 83/276 [00:07<00:21,  9.02it/s] 31%|███       | 85/276 [00:07<00:18, 10.14it/s] 32%|███▏      | 87/276 [00:07<00:18, 10.38it/s] 32%|███▏      | 89/276 [00:07<00:16, 11.31it/s] 33%|███▎      | 91/276 [00:08<00:16, 11.37it/s] 34%|███▎      | 93/276 [00:08<00:15, 12.12it/s] 34%|███▍      | 95/276 [00:08<00:15, 11.73it/s] 35%|███▌      | 97/276 [00:08<00:14, 12.38it/s] 36%|███▌      | 99/276 [00:08<00:14, 11.95it/s] 37%|███▋      | 101/276 [00:08<00:13, 12.58it/s] 37%|███▋      | 103/276 [00:09<00:13, 13.04it/s] 38%|███▊      | 105/276 [00:09<00:12, 13.39it/s] 39%|███▉      | 107/276 [00:09<00:12, 13.62it/s] 39%|███▉      | 109/276 [00:09<00:12, 13.77it/s] 40%|████      | 111/276 [00:09<00:11, 13.89it/s] 41%|████      | 113/276 [00:09<00:11, 14.00it/s] 42%|████▏     | 115/276 [00:09<00:11, 14.10it/s] 42%|████▏     | 117/276 [00:10<00:11, 14.15it/s] 43%|████▎     | 119/276 [00:10<00:11, 14.22it/s] 44%|████▍     | 121/276 [00:10<00:10, 14.26it/s] 45%|████▍     | 123/276 [00:10<00:10, 14.28it/s] 45%|████▌     | 125/276 [00:10<00:10, 14.25it/s] 46%|████▌     | 127/276 [00:10<00:10, 14.24it/s] 47%|████▋     | 129/276 [00:10<00:10, 14.26it/s] 47%|████▋     | 131/276 [00:11<00:10, 13.20it/s] 48%|████▊     | 133/276 [00:11<00:10, 13.50it/s] 49%|████▉     | 135/276 [00:11<00:10, 12.98it/s] 50%|████▉     | 137/276 [00:11<00:10, 13.36it/s] 50%|█████     | 139/276 [00:11<00:10, 12.79it/s] 51%|█████     | 141/276 [00:11<00:10, 13.22it/s] 52%|█████▏    | 143/276 [00:11<00:10, 12.78it/s] 53%|█████▎    | 145/276 [00:12<00:09, 13.23it/s] 53%|█████▎    | 147/276 [00:12<00:10, 12.81it/s] 54%|█████▍    | 149/276 [00:12<00:09, 13.22it/s] 55%|█████▍    | 151/276 [00:12<00:09, 12.97it/s] 55%|█████▌    | 153/276 [00:12<00:09, 13.34it/s] 56%|█████▌    | 155/276 [00:12<00:08, 13.60it/s] 57%|█████▋    | 157/276 [00:13<00:08, 13.80it/s] 58%|█████▊    | 159/276 [00:13<00:08, 13.84it/s] 58%|█████▊    | 161/276 [00:13<00:08, 13.89it/s] 59%|█████▉    | 163/276 [00:13<00:08, 13.51it/s] 60%|█████▉    | 165/276 [00:13<00:08, 13.59it/s] 61%|██████    | 167/276 [00:13<00:08, 13.12it/s] 61%|██████    | 169/276 [00:13<00:08, 13.18it/s] 62%|██████▏   | 171/276 [00:14<00:08, 12.94it/s] 63%|██████▎   | 173/276 [00:14<00:07, 13.32it/s] 63%|██████▎   | 175/276 [00:14<00:07, 12.82it/s] 64%|██████▍   | 177/276 [00:14<00:07, 13.25it/s] 65%|██████▍   | 179/276 [00:14<00:07, 12.77it/s] 66%|██████▌   | 181/276 [00:14<00:07, 13.15it/s] 66%|██████▋   | 183/276 [00:15<00:07, 12.62it/s] 67%|██████▋   | 185/276 [00:15<00:07, 12.88it/s] 68%|██████▊   | 187/276 [00:15<00:07, 12.60it/s] 68%|██████▊   | 189/276 [00:15<00:06, 13.07it/s] 69%|██████▉   | 191/276 [00:15<00:06, 13.41it/s] 70%|██████▉   | 193/276 [00:15<00:06, 13.09it/s] 71%|███████   | 195/276 [00:15<00:06, 13.45it/s] 71%|███████▏  | 197/276 [00:16<00:06, 12.96it/s] 72%|███████▏  | 199/276 [00:16<00:05, 13.36it/s] 73%|███████▎  | 201/276 [00:16<00:05, 12.81it/s] 74%|███████▎  | 203/276 [00:16<00:05, 13.31it/s] 74%|███████▍  | 205/276 [00:16<00:05, 12.81it/s] 75%|███████▌  | 207/276 [00:16<00:05, 13.31it/s] 76%|███████▌  | 209/276 [00:16<00:05, 12.92it/s] 76%|███████▋  | 211/276 [00:17<00:04, 13.37it/s] 77%|███████▋  | 213/276 [00:17<00:04, 12.68it/s] 78%|███████▊  | 215/276 [00:17<00:04, 13.17it/s] 79%|███████▊  | 217/276 [00:17<00:04, 13.52it/s] 79%|███████▉  | 219/276 [00:17<00:04, 13.80it/s] 80%|████████  | 221/276 [00:17<00:03, 14.04it/s] 81%|████████  | 223/276 [00:17<00:03, 14.21it/s] 82%|████████▏ | 225/276 [00:18<00:03, 14.27it/s] 82%|████████▏ | 227/276 [00:18<00:03, 14.30it/s] 83%|████████▎ | 229/276 [00:18<00:03, 14.34it/s] 84%|████████▎ | 231/276 [00:18<00:03, 14.39it/s] 84%|████████▍ | 233/276 [00:18<00:02, 14.41it/s] 85%|████████▌ | 235/276 [00:18<00:02, 14.41it/s] 86%|████████▌ | 237/276 [00:18<00:02, 14.43it/s] 87%|████████▋ | 239/276 [00:19<00:02, 14.44it/s] 87%|████████▋ | 241/276 [00:19<00:02, 14.43it/s] 88%|████████▊ | 243/276 [00:19<00:02, 14.45it/s] 89%|████████▉ | 245/276 [00:19<00:02, 14.47it/s] 89%|████████▉ | 247/276 [00:19<00:02, 14.47it/s] 90%|█████████ | 249/276 [00:19<00:01, 14.48it/s] 91%|█████████ | 251/276 [00:19<00:01, 13.84it/s] 92%|█████████▏| 253/276 [00:20<00:01, 14.02it/s] 92%|█████████▏| 255/276 [00:20<00:01, 13.21it/s] 93%|█████████▎| 257/276 [00:20<00:01, 13.58it/s] 94%|█████████▍| 259/276 [00:20<00:01, 13.12it/s] 95%|█████████▍| 261/276 [00:20<00:01, 13.49it/s] 95%|█████████▌| 263/276 [00:20<00:01, 12.78it/s] 96%|█████████▌| 265/276 [00:21<00:00, 13.28it/s] 97%|█████████▋| 267/276 [00:21<00:00, 12.94it/s] 97%|█████████▋| 269/276 [00:21<00:00, 13.25it/s] 98%|█████████▊| 271/276 [00:21<00:00, 12.79it/s] 99%|█████████▉| 273/276 [00:21<00:00, 13.28it/s]100%|█████████▉| 275/276 [00:21<00:00, 13.14it/s]100%|██████████| 276/276 [00:21<00:00, 12.59it/s]
Total samples: 552.000000
Overall Acc: 0.879950
Mean Acc: 0.434849
FreqW Acc: 0.796142
Mean IoU: 0.360357
Class IoU:
	class 0: 0.9374186361817349
	class 1: 0.44709048023486636
	class 2: 0.7596960754201616
	class 3: 0.039544028721739746
	class 4: 0.05419956667643537
	class 5: 0.026524748041028348
	class 6: 0.04240767193692505
	class 7: 0.20071065940287933
	class 8: 0.7852469036859967
	class 9: 0.40048888881615885
	class 10: 0.7948261458116187
	class 11: 0.48251767118093297
	class 12: 0.08289305347111521
	class 13: 0.6884067727224223
	class 14: 0.0384811832337928
	class 15: 0.2868985470775303
	class 16: 0.2096758852578445
	class 17: 0.16694822390458694
	class 18: 0.40279921145102016
Class Acc:
	class 0: 0.9555005377144431
	class 1: 0.6210261144307232
	class 2: 0.9103211253078606
	class 3: 0.04089518836246412
	class 4: 0.0608383027775169
	class 5: 0.02796891362450236
	class 6: 0.04379102370639266
	class 7: 0.24018982445144443
	class 8: 0.9178263051918687
	class 9: 0.4892541275926925
	class 10: 0.8938598878807212
	class 11: 0.6753663908688443
	class 12: 0.09061669978319939
	class 13: 0.8521475544878201
	class 14: 0.04228425744305542
	class 15: 0.4065563834699697
	class 16: 0.21800793475225413
	class 17: 0.17906464250515347
	class 18: 0.5966124824390997

...from 0 to 18 : best/test_before_mIoU : 0.360357
...from 0 to 18 : best/test_before_acc : 0.434849
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
==============================================
  task : 1-1
  step : 16
  Device: cuda
Namespace(amp=True, batch_size=6, bn_freeze=True, buffer=16384, cil_step=0, ckpt=None, crop_size=513, crop_val=True, curr_itrs=0, curr_step=16, data_root='/data/yt/BARM2/data_root/cityscapes', dataset='cityscapes_domain', gamma=10, gpu_id='1', initial=False, local_rank=0, loss_type='bce_loss', lr=0.01, lr_policy='poly', method='acil', model='deeplabv3_resnet101', num_classes=[1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], output_stride=16, overlap=False, print_interval=10, pseudo=True, pseudo_thresh=0.7, random_seed=1, separable_conv=False, setting='overlap', step_size=10000, subpath='BARM', target_cls=[[0], [1], [2], [3], [4], [5], [6], [7], [8], [9], [10], [11], [12], [13], [14], [15], [16]], task='1-1', test_only=False, train_epoch=50, unknown=0, val_batch_size=2, val_interval=100, weight_decay=0.0001)
==============================================
Category components: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
checkpoints/BARM/1-1/overlap/step15/final.pth
Model restored from checkpoints/BARM/1-1/overlap/step15/final.pth
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
Dataset: cityscapes_domain, Train set: 76, Val set: 571, Test set: 571
... train epoch : 50 , iterations : 600 , val_interval : 100

... Training Done
[Testing Best Model]
  0%|          | 0/286 [00:00<?, ?it/s]  0%|          | 1/286 [00:00<02:55,  1.63it/s]  1%|          | 3/286 [00:00<01:01,  4.63it/s]  2%|▏         | 5/286 [00:00<00:39,  7.09it/s]  2%|▏         | 7/286 [00:01<00:30,  9.07it/s]  3%|▎         | 9/286 [00:01<00:28,  9.57it/s]  4%|▍         | 11/286 [00:01<00:25, 10.89it/s]  5%|▍         | 13/286 [00:01<00:24, 11.34it/s]  5%|▌         | 15/286 [00:01<00:22, 12.23it/s]  6%|▌         | 17/286 [00:01<00:23, 11.65it/s]  7%|▋         | 19/286 [00:01<00:21, 12.42it/s]  7%|▋         | 21/286 [00:02<00:21, 12.22it/s]  8%|▊         | 23/286 [00:02<00:20, 12.85it/s]  9%|▊         | 25/286 [00:02<00:21, 12.21it/s]  9%|▉         | 27/286 [00:02<00:20, 12.71it/s] 10%|█         | 29/286 [00:02<00:20, 12.65it/s] 11%|█         | 31/286 [00:02<00:19, 13.11it/s] 12%|█▏        | 33/286 [00:03<00:19, 12.66it/s] 12%|█▏        | 35/286 [00:03<00:19, 13.11it/s] 13%|█▎        | 37/286 [00:03<00:19, 12.55it/s] 14%|█▎        | 39/286 [00:03<00:18, 13.01it/s] 14%|█▍        | 41/286 [00:03<00:19, 12.29it/s] 15%|█▌        | 43/286 [00:03<00:18, 12.82it/s] 16%|█▌        | 45/286 [00:04<00:19, 12.11it/s] 16%|█▋        | 47/286 [00:04<00:18, 12.69it/s] 17%|█▋        | 49/286 [00:04<00:19, 12.29it/s] 18%|█▊        | 51/286 [00:04<00:18, 12.83it/s] 19%|█▊        | 53/286 [00:04<00:18, 12.58it/s] 19%|█▉        | 55/286 [00:04<00:17, 13.05it/s] 20%|█▉        | 57/286 [00:04<00:18, 12.69it/s] 21%|██        | 59/286 [00:05<00:17, 13.16it/s] 21%|██▏       | 61/286 [00:05<00:16, 13.51it/s] 22%|██▏       | 63/286 [00:05<00:16, 13.77it/s] 23%|██▎       | 65/286 [00:05<00:15, 13.91it/s] 23%|██▎       | 67/286 [00:05<00:16, 13.00it/s] 24%|██▍       | 69/286 [00:05<00:16, 13.38it/s] 25%|██▍       | 71/286 [00:06<00:17, 12.38it/s] 26%|██▌       | 73/286 [00:06<00:16, 12.91it/s] 26%|██▌       | 75/286 [00:06<00:17, 12.41it/s] 27%|██▋       | 77/286 [00:06<00:16, 12.94it/s] 28%|██▊       | 79/286 [00:06<00:16, 12.54it/s] 28%|██▊       | 81/286 [00:06<00:15, 13.03it/s] 29%|██▉       | 83/286 [00:06<00:16, 12.63it/s] 30%|██▉       | 85/286 [00:07<00:15, 13.09it/s] 30%|███       | 87/286 [00:07<00:15, 12.53it/s] 31%|███       | 89/286 [00:07<00:15, 13.03it/s] 32%|███▏      | 91/286 [00:07<00:15, 12.47it/s] 33%|███▎      | 93/286 [00:07<00:14, 12.98it/s] 33%|███▎      | 95/286 [00:07<00:15, 12.41it/s] 34%|███▍      | 97/286 [00:08<00:14, 12.93it/s] 35%|███▍      | 99/286 [00:08<00:14, 12.52it/s] 35%|███▌      | 101/286 [00:08<00:14, 12.96it/s] 36%|███▌      | 103/286 [00:08<00:14, 12.69it/s] 37%|███▋      | 105/286 [00:08<00:13, 13.13it/s] 37%|███▋      | 107/286 [00:08<00:14, 12.62it/s] 38%|███▊      | 109/286 [00:09<00:13, 13.09it/s] 39%|███▉      | 111/286 [00:09<00:14, 12.42it/s] 40%|███▉      | 113/286 [00:09<00:13, 12.94it/s] 40%|████      | 115/286 [00:09<00:13, 12.47it/s] 41%|████      | 117/286 [00:09<00:13, 12.97it/s] 42%|████▏     | 119/286 [00:09<00:13, 12.35it/s] 42%|████▏     | 121/286 [00:09<00:12, 12.89it/s] 43%|████▎     | 123/286 [00:10<00:13, 12.22it/s] 44%|████▎     | 125/286 [00:10<00:12, 12.80it/s] 44%|████▍     | 127/286 [00:10<00:12, 12.36it/s] 45%|████▌     | 129/286 [00:10<00:13, 11.71it/s] 46%|████▌     | 131/286 [00:10<00:12, 12.38it/s] 47%|████▋     | 133/286 [00:10<00:11, 12.91it/s] 47%|████▋     | 135/286 [00:11<00:11, 12.71it/s] 48%|████▊     | 137/286 [00:11<00:11, 13.16it/s] 49%|████▊     | 139/286 [00:11<00:11, 12.62it/s] 49%|████▉     | 141/286 [00:11<00:11, 13.10it/s] 50%|█████     | 143/286 [00:11<00:12, 11.71it/s] 51%|█████     | 145/286 [00:11<00:11, 12.40it/s] 51%|█████▏    | 147/286 [00:12<00:11, 12.27it/s] 52%|█████▏    | 149/286 [00:12<00:10, 12.81it/s] 53%|█████▎    | 151/286 [00:12<00:10, 12.36it/s] 53%|█████▎    | 153/286 [00:12<00:10, 12.90it/s] 54%|█████▍    | 155/286 [00:12<00:10, 12.32it/s] 55%|█████▍    | 157/286 [00:12<00:10, 12.86it/s] 56%|█████▌    | 159/286 [00:13<00:10, 11.71it/s] 56%|█████▋    | 161/286 [00:13<00:10, 12.39it/s] 57%|█████▋    | 163/286 [00:13<00:10, 12.06it/s] 58%|█████▊    | 165/286 [00:13<00:09, 12.68it/s] 58%|█████▊    | 167/286 [00:13<00:09, 12.27it/s] 59%|█████▉    | 169/286 [00:13<00:09, 12.82it/s] 60%|█████▉    | 171/286 [00:13<00:09, 12.52it/s] 60%|██████    | 173/286 [00:14<00:08, 13.01it/s] 61%|██████    | 175/286 [00:14<00:08, 12.42it/s] 62%|██████▏   | 177/286 [00:14<00:08, 12.97it/s] 63%|██████▎   | 179/286 [00:14<00:08, 12.45it/s] 63%|██████▎   | 181/286 [00:14<00:08, 13.03it/s] 64%|██████▍   | 183/286 [00:14<00:08, 12.56it/s] 65%|██████▍   | 185/286 [00:15<00:07, 13.12it/s] 65%|██████▌   | 187/286 [00:15<00:07, 12.40it/s] 66%|██████▌   | 189/286 [00:15<00:07, 12.99it/s] 67%|██████▋   | 191/286 [00:15<00:07, 12.31it/s] 67%|██████▋   | 193/286 [00:15<00:07, 12.92it/s] 68%|██████▊   | 195/286 [00:15<00:07, 12.26it/s] 69%|██████▉   | 197/286 [00:16<00:06, 12.89it/s] 70%|██████▉   | 199/286 [00:16<00:07, 12.34it/s] 70%|███████   | 201/286 [00:16<00:06, 12.94it/s] 71%|███████   | 203/286 [00:16<00:06, 12.30it/s] 72%|███████▏  | 205/286 [00:16<00:06, 12.93it/s] 72%|███████▏  | 207/286 [00:16<00:06, 12.39it/s] 73%|███████▎  | 209/286 [00:16<00:05, 12.98it/s] 74%|███████▍  | 211/286 [00:17<00:06, 12.38it/s] 74%|███████▍  | 213/286 [00:17<00:05, 12.99it/s] 75%|███████▌  | 215/286 [00:17<00:05, 12.48it/s] 76%|███████▌  | 217/286 [00:17<00:05, 13.05it/s] 77%|███████▋  | 219/286 [00:17<00:05, 12.37it/s] 77%|███████▋  | 221/286 [00:17<00:05, 12.97it/s] 78%|███████▊  | 223/286 [00:18<00:05, 12.38it/s] 79%|███████▊  | 225/286 [00:18<00:04, 12.99it/s] 79%|███████▉  | 227/286 [00:18<00:04, 12.39it/s] 80%|████████  | 229/286 [00:18<00:04, 12.97it/s] 81%|████████  | 231/286 [00:18<00:04, 12.41it/s] 81%|████████▏ | 233/286 [00:18<00:04, 13.00it/s] 82%|████████▏ | 235/286 [00:19<00:04, 12.31it/s] 83%|████████▎ | 237/286 [00:19<00:03, 12.94it/s] 84%|████████▎ | 239/286 [00:19<00:03, 12.36it/s] 84%|████████▍ | 241/286 [00:19<00:03, 12.95it/s] 85%|████████▍ | 243/286 [00:19<00:03, 12.38it/s] 86%|████████▌ | 245/286 [00:19<00:03, 12.97it/s] 86%|████████▋ | 247/286 [00:19<00:03, 12.28it/s] 87%|████████▋ | 249/286 [00:20<00:02, 12.87it/s] 88%|████████▊ | 251/286 [00:20<00:02, 12.13it/s] 88%|████████▊ | 253/286 [00:20<00:02, 12.75it/s] 89%|████████▉ | 255/286 [00:20<00:02, 12.41it/s] 90%|████████▉ | 257/286 [00:20<00:02, 12.96it/s] 91%|█████████ | 259/286 [00:20<00:02, 12.45it/s] 91%|█████████▏| 261/286 [00:21<00:01, 12.99it/s] 92%|█████████▏| 263/286 [00:21<00:01, 12.37it/s] 93%|█████████▎| 265/286 [00:21<00:01, 12.94it/s] 93%|█████████▎| 267/286 [00:21<00:01, 12.54it/s] 94%|█████████▍| 269/286 [00:21<00:01, 13.05it/s] 95%|█████████▍| 271/286 [00:21<00:01, 12.46it/s] 95%|█████████▌| 273/286 [00:22<00:01, 13.00it/s] 96%|█████████▌| 275/286 [00:22<00:00, 12.63it/s] 97%|█████████▋| 277/286 [00:22<00:00, 13.13it/s] 98%|█████████▊| 279/286 [00:22<00:00, 12.45it/s] 98%|█████████▊| 281/286 [00:22<00:00, 13.03it/s] 99%|█████████▉| 283/286 [00:22<00:00, 12.83it/s]100%|█████████▉| 285/286 [00:22<00:00, 13.35it/s]100%|██████████| 286/286 [00:23<00:00, 12.42it/s]
Total samples: 571.000000
Overall Acc: 0.878643
Mean Acc: 0.426843
FreqW Acc: 0.794458
Mean IoU: 0.351871
Class IoU:
	class 0: 0.9371976905744743
	class 1: 0.45184999103557455
	class 2: 0.757574640880001
	class 3: 0.04191298036202687
	class 4: 0.05372374591984321
	class 5: 0.026592722488464095
	class 6: 0.054432443137465786
	class 7: 0.20580397672458123
	class 8: 0.7853451655453422
	class 9: 0.4011235291463252
	class 10: 0.7929614127779249
	class 11: 0.4797214486196551
	class 12: 0.07221163089508044
	class 13: 0.6788565757679522
	class 14: 0.04926768943464018
	class 15: 0.24139030804060263
	class 16: 0.1768055257712673
	class 17: 0.09583102313289156
	class 18: 0.3829402432982626
Class Acc:
	class 0: 0.9548956753116469
	class 1: 0.6314566614183548
	class 2: 0.909259726550217
	class 3: 0.04317987321044231
	class 4: 0.060073719354476356
	class 5: 0.02809639355158511
	class 6: 0.056887431189147575
	class 7: 0.24442380480140166
	class 8: 0.9187569658992433
	class 9: 0.49046401009422874
	class 10: 0.891619179376888
	class 11: 0.6756574263309102
	class 12: 0.07819866175458659
	class 13: 0.8462445279153004
	class 14: 0.05566591472774299
	class 15: 0.34242155222307497
	class 16: 0.1822608230260133
	class 17: 0.10085478574425422
	class 18: 0.5996045195429198

...from 0 to 18 : best/test_before_mIoU : 0.351871
...from 0 to 18 : best/test_before_acc : 0.426843
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
==============================================
  task : 1-1
  step : 17
  Device: cuda
Namespace(amp=True, batch_size=6, bn_freeze=True, buffer=16384, cil_step=0, ckpt=None, crop_size=513, crop_val=True, curr_itrs=0, curr_step=17, data_root='/data/yt/BARM2/data_root/cityscapes', dataset='cityscapes_domain', gamma=10, gpu_id='1', initial=False, local_rank=0, loss_type='bce_loss', lr=0.01, lr_policy='poly', method='acil', model='deeplabv3_resnet101', num_classes=[1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], output_stride=16, overlap=False, print_interval=10, pseudo=True, pseudo_thresh=0.7, random_seed=1, separable_conv=False, setting='overlap', step_size=10000, subpath='BARM', target_cls=[[0], [1], [2], [3], [4], [5], [6], [7], [8], [9], [10], [11], [12], [13], [14], [15], [16], [17]], task='1-1', test_only=False, train_epoch=50, unknown=0, val_batch_size=2, val_interval=100, weight_decay=0.0001)
==============================================
Category components: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
checkpoints/BARM/1-1/overlap/step16/final.pth
Model restored from checkpoints/BARM/1-1/overlap/step16/final.pth
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
Dataset: cityscapes_domain, Train set: 97, Val set: 595, Test set: 595
... train epoch : 50 , iterations : 800 , val_interval : 100

... Training Done
[Testing Best Model]
  0%|          | 0/298 [00:00<?, ?it/s]  0%|          | 1/298 [00:00<02:58,  1.66it/s]  1%|          | 3/298 [00:00<01:03,  4.67it/s]  2%|▏         | 5/298 [00:00<00:40,  7.18it/s]  2%|▏         | 7/298 [00:01<00:31,  9.17it/s]  3%|▎         | 9/298 [00:01<00:28,  9.97it/s]  4%|▎         | 11/298 [00:01<00:25, 11.18it/s]  4%|▍         | 13/298 [00:01<00:25, 11.35it/s]  5%|▌         | 15/298 [00:01<00:23, 12.21it/s]  6%|▌         | 17/298 [00:01<00:23, 11.74it/s]  6%|▋         | 19/298 [00:01<00:22, 12.50it/s]  7%|▋         | 21/298 [00:02<00:23, 12.03it/s]  8%|▊         | 23/298 [00:02<00:21, 12.70it/s]  8%|▊         | 25/298 [00:02<00:20, 13.21it/s]  9%|▉         | 27/298 [00:02<00:19, 13.58it/s] 10%|▉         | 29/298 [00:02<00:19, 13.88it/s] 10%|█         | 31/298 [00:02<00:18, 14.10it/s] 11%|█         | 33/298 [00:02<00:18, 14.27it/s] 12%|█▏        | 35/298 [00:03<00:20, 13.12it/s] 12%|█▏        | 37/298 [00:03<00:19, 13.54it/s] 13%|█▎        | 39/298 [00:03<00:20, 12.59it/s] 14%|█▍        | 41/298 [00:03<00:19, 13.12it/s] 14%|█▍        | 43/298 [00:03<00:20, 12.36it/s] 15%|█▌        | 45/298 [00:03<00:19, 12.97it/s] 16%|█▌        | 47/298 [00:04<00:20, 12.39it/s] 16%|█▋        | 49/298 [00:04<00:19, 12.98it/s] 17%|█▋        | 51/298 [00:04<00:20, 12.26it/s] 18%|█▊        | 53/298 [00:04<00:19, 12.87it/s] 18%|█▊        | 55/298 [00:04<00:19, 12.27it/s] 19%|█▉        | 57/298 [00:04<00:18, 12.88it/s] 20%|█▉        | 59/298 [00:05<00:19, 12.40it/s] 20%|██        | 61/298 [00:05<00:18, 12.91it/s] 21%|██        | 63/298 [00:05<00:19, 12.33it/s] 22%|██▏       | 65/298 [00:05<00:18, 12.86it/s] 22%|██▏       | 67/298 [00:05<00:18, 12.25it/s] 23%|██▎       | 69/298 [00:05<00:17, 12.80it/s] 24%|██▍       | 71/298 [00:06<00:18, 12.33it/s] 24%|██▍       | 73/298 [00:06<00:17, 12.87it/s] 25%|██▌       | 75/298 [00:06<00:18, 12.38it/s] 26%|██▌       | 77/298 [00:06<00:17, 12.90it/s] 27%|██▋       | 79/298 [00:06<00:17, 12.61it/s] 27%|██▋       | 81/298 [00:06<00:16, 13.08it/s] 28%|██▊       | 83/298 [00:06<00:17, 12.46it/s] 29%|██▊       | 85/298 [00:07<00:16, 12.94it/s] 29%|██▉       | 87/298 [00:07<00:17, 12.30it/s] 30%|██▉       | 89/298 [00:07<00:16, 12.84it/s] 31%|███       | 91/298 [00:07<00:16, 12.72it/s] 31%|███       | 93/298 [00:07<00:15, 13.16it/s] 32%|███▏      | 95/298 [00:07<00:16, 12.54it/s] 33%|███▎      | 97/298 [00:08<00:15, 13.02it/s] 33%|███▎      | 99/298 [00:08<00:15, 13.05it/s] 34%|███▍      | 101/298 [00:08<00:14, 13.40it/s] 35%|███▍      | 103/298 [00:08<00:14, 13.09it/s] 35%|███▌      | 105/298 [00:08<00:14, 13.44it/s] 36%|███▌      | 107/298 [00:08<00:14, 13.01it/s] 37%|███▋      | 109/298 [00:08<00:14, 13.40it/s] 37%|███▋      | 111/298 [00:09<00:14, 12.96it/s] 38%|███▊      | 113/298 [00:09<00:13, 13.36it/s] 39%|███▊      | 115/298 [00:09<00:14, 12.70it/s] 39%|███▉      | 117/298 [00:09<00:13, 13.15it/s] 40%|███▉      | 119/298 [00:09<00:13, 12.89it/s] 41%|████      | 121/298 [00:09<00:13, 13.28it/s] 41%|████▏     | 123/298 [00:10<00:13, 12.50it/s] 42%|████▏     | 125/298 [00:10<00:13, 12.99it/s] 43%|████▎     | 127/298 [00:10<00:13, 12.45it/s] 43%|████▎     | 129/298 [00:10<00:13, 13.00it/s] 44%|████▍     | 131/298 [00:10<00:13, 12.54it/s] 45%|████▍     | 133/298 [00:10<00:12, 13.02it/s] 45%|████▌     | 135/298 [00:10<00:13, 12.42it/s] 46%|████▌     | 137/298 [00:11<00:12, 12.94it/s] 47%|████▋     | 139/298 [00:11<00:12, 12.77it/s] 47%|████▋     | 141/298 [00:11<00:11, 13.12it/s] 48%|████▊     | 143/298 [00:11<00:12, 12.11it/s] 49%|████▊     | 145/298 [00:11<00:12, 12.69it/s] 49%|████▉     | 147/298 [00:11<00:12, 12.16it/s] 50%|█████     | 149/298 [00:12<00:11, 12.75it/s] 51%|█████     | 151/298 [00:12<00:11, 12.33it/s] 51%|█████▏    | 153/298 [00:12<00:11, 12.86it/s] 52%|█████▏    | 155/298 [00:12<00:11, 12.43it/s] 53%|█████▎    | 157/298 [00:12<00:10, 12.98it/s] 53%|█████▎    | 159/298 [00:12<00:11, 12.40it/s] 54%|█████▍    | 161/298 [00:13<00:10, 12.92it/s] 55%|█████▍    | 163/298 [00:13<00:10, 13.33it/s] 55%|█████▌    | 165/298 [00:13<00:10, 12.80it/s] 56%|█████▌    | 167/298 [00:13<00:09, 13.22it/s] 57%|█████▋    | 169/298 [00:13<00:10, 12.60it/s] 57%|█████▋    | 171/298 [00:13<00:09, 13.09it/s] 58%|█████▊    | 173/298 [00:13<00:10, 12.50it/s] 59%|█████▊    | 175/298 [00:14<00:09, 13.06it/s] 59%|█████▉    | 177/298 [00:14<00:09, 12.83it/s] 60%|██████    | 179/298 [00:14<00:08, 13.29it/s] 61%|██████    | 181/298 [00:14<00:09, 12.51it/s] 61%|██████▏   | 183/298 [00:14<00:08, 13.05it/s] 62%|██████▏   | 185/298 [00:14<00:09, 12.49it/s] 63%|██████▎   | 187/298 [00:15<00:08, 13.07it/s] 63%|██████▎   | 189/298 [00:15<00:08, 12.42it/s] 64%|██████▍   | 191/298 [00:15<00:08, 12.99it/s] 65%|██████▍   | 193/298 [00:15<00:08, 12.50it/s] 65%|██████▌   | 195/298 [00:15<00:07, 13.04it/s] 66%|██████▌   | 197/298 [00:15<00:08, 12.37it/s] 67%|██████▋   | 199/298 [00:15<00:07, 12.94it/s] 67%|██████▋   | 201/298 [00:16<00:07, 12.24it/s] 68%|██████▊   | 203/298 [00:16<00:07, 12.85it/s] 69%|██████▉   | 205/298 [00:16<00:07, 12.52it/s] 69%|██████▉   | 207/298 [00:16<00:06, 13.07it/s] 70%|███████   | 209/298 [00:16<00:07, 12.50it/s] 71%|███████   | 211/298 [00:16<00:06, 13.06it/s] 71%|███████▏  | 213/298 [00:17<00:06, 12.52it/s] 72%|███████▏  | 215/298 [00:17<00:06, 13.07it/s] 73%|███████▎  | 217/298 [00:17<00:06, 12.46it/s] 73%|███████▎  | 219/298 [00:17<00:06, 13.04it/s] 74%|███████▍  | 221/298 [00:17<00:06, 12.28it/s] 75%|███████▍  | 223/298 [00:17<00:05, 12.86it/s] 76%|███████▌  | 225/298 [00:18<00:05, 12.43it/s] 76%|███████▌  | 227/298 [00:18<00:05, 12.99it/s] 77%|███████▋  | 229/298 [00:18<00:05, 12.30it/s] 78%|███████▊  | 231/298 [00:18<00:05, 12.91it/s] 78%|███████▊  | 233/298 [00:18<00:05, 12.14it/s] 79%|███████▉  | 235/298 [00:18<00:04, 12.76it/s] 80%|███████▉  | 237/298 [00:19<00:04, 12.28it/s] 80%|████████  | 239/298 [00:19<00:04, 12.88it/s] 81%|████████  | 241/298 [00:19<00:04, 12.37it/s] 82%|████████▏ | 243/298 [00:19<00:04, 12.94it/s] 82%|████████▏ | 245/298 [00:19<00:04, 12.28it/s] 83%|████████▎ | 247/298 [00:19<00:03, 12.87it/s] 84%|████████▎ | 249/298 [00:19<00:03, 12.32it/s] 84%|████████▍ | 251/298 [00:20<00:03, 12.88it/s] 85%|████████▍ | 253/298 [00:20<00:03, 12.16it/s] 86%|████████▌ | 255/298 [00:20<00:03, 12.78it/s] 86%|████████▌ | 257/298 [00:20<00:03, 12.23it/s] 87%|████████▋ | 259/298 [00:20<00:03, 12.82it/s] 88%|████████▊ | 261/298 [00:20<00:03, 12.07it/s] 88%|████████▊ | 263/298 [00:21<00:02, 12.71it/s] 89%|████████▉ | 265/298 [00:21<00:02, 12.31it/s] 90%|████████▉ | 267/298 [00:21<00:02, 12.88it/s] 90%|█████████ | 269/298 [00:21<00:02, 12.39it/s] 91%|█████████ | 271/298 [00:21<00:02, 12.96it/s] 92%|█████████▏| 273/298 [00:21<00:02, 12.22it/s] 92%|█████████▏| 275/298 [00:22<00:01, 12.83it/s] 93%|█████████▎| 277/298 [00:22<00:01, 12.27it/s] 94%|█████████▎| 279/298 [00:22<00:01, 12.81it/s] 94%|█████████▍| 281/298 [00:22<00:01, 12.21it/s] 95%|█████████▍| 283/298 [00:22<00:01, 12.75it/s] 96%|█████████▌| 285/298 [00:22<00:01, 12.12it/s] 96%|█████████▋| 287/298 [00:22<00:00, 12.67it/s] 97%|█████████▋| 289/298 [00:23<00:00, 12.42it/s] 98%|█████████▊| 291/298 [00:23<00:00, 12.90it/s] 98%|█████████▊| 293/298 [00:23<00:00, 12.45it/s] 99%|█████████▉| 295/298 [00:23<00:00, 12.97it/s]100%|█████████▉| 297/298 [00:23<00:00, 12.66it/s]100%|██████████| 298/298 [00:23<00:00, 12.47it/s]
Total samples: 595.000000
Overall Acc: 0.878897
Mean Acc: 0.439228
FreqW Acc: 0.794687
Mean IoU: 0.363316
Class IoU:
	class 0: 0.936700306642906
	class 1: 0.4466984830800544
	class 2: 0.753856568793525
	class 3: 0.044371128338609976
	class 4: 0.05359136654454713
	class 5: 0.028017422865724565
	class 6: 0.04170841137764186
	class 7: 0.21163902356019207
	class 8: 0.7855076544620616
	class 9: 0.3932563339697336
	class 10: 0.7963138012612895
	class 11: 0.4880855133766392
	class 12: 0.07672097219069968
	class 13: 0.6833352060421871
	class 14: 0.05176219079425868
	class 15: 0.34192136636231485
	class 16: 0.21672390606550085
	class 17: 0.1497507436219413
	class 18: 0.4030503574251981
Class Acc:
	class 0: 0.9545492749591395
	class 1: 0.6301601976678
	class 2: 0.907433260065958
	class 3: 0.04591650823818537
	class 4: 0.05948196740719413
	class 5: 0.02980060452764231
	class 6: 0.04314698891079896
	class 7: 0.25122740887793055
	class 8: 0.9186781763772621
	class 9: 0.471308974046944
	class 10: 0.8941876915230269
	class 11: 0.6799696316647057
	class 12: 0.08374684138497233
	class 13: 0.8466075981992705
	class 14: 0.056115674950255184
	class 15: 0.47936957812106945
	class 16: 0.23177460850299517
	class 17: 0.16221708280759142
	class 18: 0.5996434563746956

...from 0 to 18 : best/test_before_mIoU : 0.363316
...from 0 to 18 : best/test_before_acc : 0.439228
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
==============================================
  task : 1-1
  step : 18
  Device: cuda
Namespace(amp=True, batch_size=6, bn_freeze=True, buffer=16384, cil_step=0, ckpt=None, crop_size=513, crop_val=True, curr_itrs=0, curr_step=18, data_root='/data/yt/BARM2/data_root/cityscapes', dataset='cityscapes_domain', gamma=10, gpu_id='1', initial=False, local_rank=0, loss_type='bce_loss', lr=0.01, lr_policy='poly', method='acil', model='deeplabv3_resnet101', num_classes=[1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], output_stride=16, overlap=False, print_interval=10, pseudo=True, pseudo_thresh=0.7, random_seed=1, separable_conv=False, setting='overlap', step_size=10000, subpath='BARM', target_cls=[[0], [1], [2], [3], [4], [5], [6], [7], [8], [9], [10], [11], [12], [13], [14], [15], [16], [17], [18]], task='1-1', test_only=False, train_epoch=50, unknown=0, val_batch_size=2, val_interval=100, weight_decay=0.0001)
==============================================
Category components: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
checkpoints/BARM/1-1/overlap/step17/final.pth
Model restored from checkpoints/BARM/1-1/overlap/step17/final.pth
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
Dataset: cityscapes_domain, Train set: 213, Val set: 649, Test set: 649
... train epoch : 50 , iterations : 1750 , val_interval : 100

... Training Done
[Testing Best Model]
  0%|          | 0/325 [00:00<?, ?it/s]  0%|          | 1/325 [00:00<03:16,  1.65it/s]  1%|          | 3/325 [00:00<01:08,  4.70it/s]  2%|▏         | 5/325 [00:00<00:44,  7.19it/s]  2%|▏         | 7/325 [00:01<00:34,  9.13it/s]  3%|▎         | 9/325 [00:01<00:32,  9.74it/s]  3%|▎         | 11/325 [00:01<00:28, 10.99it/s]  4%|▍         | 13/325 [00:01<00:27, 11.20it/s]  5%|▍         | 15/325 [00:01<00:25, 12.03it/s]  5%|▌         | 17/325 [00:01<00:25, 12.01it/s]  6%|▌         | 19/325 [00:01<00:24, 12.66it/s]  6%|▋         | 21/325 [00:02<00:26, 11.47it/s]  7%|▋         | 23/325 [00:02<00:24, 12.23it/s]  8%|▊         | 25/325 [00:02<00:25, 11.74it/s]  8%|▊         | 27/325 [00:02<00:23, 12.42it/s]  9%|▉         | 29/325 [00:02<00:24, 12.03it/s] 10%|▉         | 31/325 [00:02<00:23, 12.63it/s] 10%|█         | 33/325 [00:03<00:24, 12.02it/s] 11%|█         | 35/325 [00:03<00:22, 12.64it/s] 11%|█▏        | 37/325 [00:03<00:23, 12.36it/s] 12%|█▏        | 39/325 [00:03<00:22, 12.89it/s] 13%|█▎        | 41/325 [00:03<00:23, 12.06it/s] 13%|█▎        | 43/325 [00:03<00:22, 12.65it/s] 14%|█▍        | 45/325 [00:04<00:22, 12.35it/s] 14%|█▍        | 47/325 [00:04<00:21, 12.90it/s] 15%|█▌        | 49/325 [00:04<00:22, 12.23it/s] 16%|█▌        | 51/325 [00:04<00:21, 12.79it/s] 16%|█▋        | 53/325 [00:04<00:22, 12.10it/s] 17%|█▋        | 55/325 [00:04<00:21, 12.70it/s] 18%|█▊        | 57/325 [00:05<00:21, 12.33it/s] 18%|█▊        | 59/325 [00:05<00:20, 12.86it/s] 19%|█▉        | 61/325 [00:05<00:21, 12.30it/s] 19%|█▉        | 63/325 [00:05<00:20, 12.84it/s] 20%|██        | 65/325 [00:05<00:20, 12.43it/s] 21%|██        | 67/325 [00:05<00:19, 12.93it/s] 21%|██        | 69/325 [00:05<00:20, 12.75it/s] 22%|██▏       | 71/325 [00:06<00:19, 13.17it/s] 22%|██▏       | 73/325 [00:06<00:18, 13.48it/s] 23%|██▎       | 75/325 [00:06<00:18, 13.16it/s] 24%|██▎       | 77/325 [00:06<00:18, 13.50it/s] 24%|██▍       | 79/325 [00:06<00:19, 12.52it/s] 25%|██▍       | 81/325 [00:06<00:18, 13.01it/s] 26%|██▌       | 83/325 [00:07<00:19, 12.57it/s] 26%|██▌       | 85/325 [00:07<00:18, 13.05it/s] 27%|██▋       | 87/325 [00:07<00:18, 12.82it/s] 27%|██▋       | 89/325 [00:07<00:23, 10.16it/s] 28%|██▊       | 91/325 [00:07<00:20, 11.15it/s] 29%|██▊       | 93/325 [00:07<00:20, 11.32it/s] 29%|██▉       | 95/325 [00:08<00:19, 12.10it/s] 30%|██▉       | 97/325 [00:08<00:19, 11.78it/s] 30%|███       | 99/325 [00:08<00:18, 12.46it/s] 31%|███       | 101/325 [00:08<00:18, 12.01it/s] 32%|███▏      | 103/325 [00:08<00:17, 12.62it/s] 32%|███▏      | 105/325 [00:08<00:17, 12.51it/s] 33%|███▎      | 107/325 [00:09<00:16, 13.08it/s] 34%|███▎      | 109/325 [00:09<00:17, 12.32it/s] 34%|███▍      | 111/325 [00:09<00:16, 12.85it/s] 35%|███▍      | 113/325 [00:09<00:17, 12.20it/s] 35%|███▌      | 115/325 [00:09<00:16, 12.77it/s] 36%|███▌      | 117/325 [00:09<00:17, 12.08it/s] 37%|███▋      | 119/325 [00:10<00:16, 12.69it/s] 37%|███▋      | 121/325 [00:10<00:17, 11.95it/s] 38%|███▊      | 123/325 [00:10<00:16, 12.56it/s] 38%|███▊      | 125/325 [00:10<00:16, 11.87it/s] 39%|███▉      | 127/325 [00:10<00:16, 12.16it/s] 40%|███▉      | 129/325 [00:10<00:15, 12.29it/s] 40%|████      | 131/325 [00:11<00:15, 12.83it/s] 41%|████      | 133/325 [00:11<00:15, 12.19it/s] 42%|████▏     | 135/325 [00:11<00:14, 12.75it/s] 42%|████▏     | 137/325 [00:11<00:15, 12.51it/s] 43%|████▎     | 139/325 [00:11<00:14, 13.00it/s] 43%|████▎     | 141/325 [00:11<00:14, 12.64it/s] 44%|████▍     | 143/325 [00:11<00:13, 13.10it/s] 45%|████▍     | 145/325 [00:12<00:14, 12.46it/s] 45%|████▌     | 147/325 [00:12<00:13, 12.97it/s] 46%|████▌     | 149/325 [00:12<00:14, 12.33it/s] 46%|████▋     | 151/325 [00:12<00:13, 12.87it/s] 47%|████▋     | 153/325 [00:12<00:13, 12.48it/s] 48%|████▊     | 155/325 [00:12<00:13, 12.97it/s] 48%|████▊     | 157/325 [00:13<00:13, 12.41it/s] 49%|████▉     | 159/325 [00:13<00:12, 12.91it/s] 50%|████▉     | 161/325 [00:13<00:13, 12.42it/s] 50%|█████     | 163/325 [00:13<00:12, 12.95it/s] 51%|█████     | 165/325 [00:13<00:13, 12.28it/s] 51%|█████▏    | 167/325 [00:13<00:12, 12.82it/s] 52%|█████▏    | 169/325 [00:14<00:12, 12.14it/s] 53%|█████▎    | 171/325 [00:14<00:12, 12.73it/s] 53%|█████▎    | 173/325 [00:14<00:12, 12.33it/s] 54%|█████▍    | 175/325 [00:14<00:11, 12.86it/s] 54%|█████▍    | 177/325 [00:14<00:11, 12.35it/s] 55%|█████▌    | 179/325 [00:14<00:11, 12.87it/s] 56%|█████▌    | 181/325 [00:14<00:11, 12.20it/s] 56%|█████▋    | 183/325 [00:15<00:11, 12.75it/s] 57%|█████▋    | 185/325 [00:15<00:11, 12.34it/s] 58%|█████▊    | 187/325 [00:15<00:10, 12.86it/s] 58%|█████▊    | 189/325 [00:15<00:11, 12.31it/s] 59%|█████▉    | 191/325 [00:15<00:10, 12.87it/s] 59%|█████▉    | 193/325 [00:15<00:10, 12.65it/s] 60%|██████    | 195/325 [00:16<00:09, 13.08it/s] 61%|██████    | 197/325 [00:16<00:10, 11.66it/s] 61%|██████    | 199/325 [00:16<00:10, 12.36it/s] 62%|██████▏   | 201/325 [00:16<00:10, 11.43it/s] 62%|██████▏   | 203/325 [00:16<00:10, 12.15it/s] 63%|██████▎   | 205/325 [00:16<00:10, 11.75it/s] 64%|██████▎   | 207/325 [00:17<00:09, 12.41it/s] 64%|██████▍   | 209/325 [00:17<00:09, 12.18it/s] 65%|██████▍   | 211/325 [00:17<00:08, 12.74it/s] 66%|██████▌   | 213/325 [00:17<00:09, 12.27it/s] 66%|██████▌   | 215/325 [00:17<00:08, 12.81it/s] 67%|██████▋   | 217/325 [00:17<00:08, 12.24it/s] 67%|██████▋   | 219/325 [00:18<00:08, 12.80it/s] 68%|██████▊   | 221/325 [00:18<00:08, 12.28it/s] 69%|██████▊   | 223/325 [00:18<00:07, 12.81it/s] 69%|██████▉   | 225/325 [00:18<00:08, 12.10it/s] 70%|██████▉   | 227/325 [00:18<00:07, 12.53it/s] 70%|███████   | 229/325 [00:18<00:07, 12.25it/s] 71%|███████   | 231/325 [00:19<00:07, 12.70it/s] 72%|███████▏  | 233/325 [00:19<00:07, 12.47it/s] 72%|███████▏  | 235/325 [00:19<00:06, 12.95it/s] 73%|███████▎  | 237/325 [00:19<00:07, 12.43it/s] 74%|███████▎  | 239/325 [00:19<00:06, 12.94it/s] 74%|███████▍  | 241/325 [00:19<00:06, 12.37it/s] 75%|███████▍  | 243/325 [00:19<00:06, 12.87it/s] 75%|███████▌  | 245/325 [00:20<00:06, 12.33it/s] 76%|███████▌  | 247/325 [00:20<00:06, 12.87it/s] 77%|███████▋  | 249/325 [00:20<00:06, 12.22it/s] 77%|███████▋  | 251/325 [00:20<00:05, 12.79it/s] 78%|███████▊  | 253/325 [00:20<00:05, 12.25it/s] 78%|███████▊  | 255/325 [00:20<00:05, 12.69it/s] 79%|███████▉  | 257/325 [00:21<00:05, 12.31it/s] 80%|███████▉  | 259/325 [00:21<00:05, 12.84it/s] 80%|████████  | 261/325 [00:21<00:05, 12.18it/s] 81%|████████  | 263/325 [00:21<00:04, 12.73it/s] 82%|████████▏ | 265/325 [00:21<00:04, 12.31it/s] 82%|████████▏ | 267/325 [00:21<00:04, 12.85it/s] 83%|████████▎ | 269/325 [00:22<00:04, 12.27it/s] 83%|████████▎ | 271/325 [00:22<00:04, 12.82it/s] 84%|████████▍ | 273/325 [00:22<00:04, 11.65it/s] 85%|████████▍ | 275/325 [00:22<00:04, 12.35it/s] 85%|████████▌ | 277/325 [00:22<00:04, 11.98it/s] 86%|████████▌ | 279/325 [00:22<00:03, 12.60it/s] 86%|████████▋ | 281/325 [00:23<00:03, 12.25it/s] 87%|████████▋ | 283/325 [00:23<00:03, 12.80it/s] 88%|████████▊ | 285/325 [00:23<00:03, 12.38it/s] 88%|████████▊ | 287/325 [00:23<00:02, 12.80it/s] 89%|████████▉ | 289/325 [00:23<00:02, 13.00it/s] 90%|████████▉ | 291/325 [00:23<00:02, 13.42it/s] 90%|█████████ | 293/325 [00:23<00:02, 12.67it/s] 91%|█████████ | 295/325 [00:24<00:02, 13.14it/s] 91%|█████████▏| 297/325 [00:24<00:02, 12.48it/s] 92%|█████████▏| 299/325 [00:24<00:02, 13.00it/s] 93%|█████████▎| 301/325 [00:24<00:02, 11.91it/s] 93%|█████████▎| 303/325 [00:24<00:01, 12.58it/s] 94%|█████████▍| 305/325 [00:24<00:01, 12.17it/s] 94%|█████████▍| 307/325 [00:25<00:01, 12.77it/s] 95%|█████████▌| 309/325 [00:25<00:01, 12.30it/s] 96%|█████████▌| 311/325 [00:25<00:01, 12.86it/s] 96%|█████████▋| 313/325 [00:25<00:00, 12.60it/s] 97%|█████████▋| 315/325 [00:25<00:00, 13.09it/s] 98%|█████████▊| 317/325 [00:25<00:00, 12.36it/s] 98%|█████████▊| 319/325 [00:25<00:00, 12.93it/s] 99%|█████████▉| 321/325 [00:26<00:00, 12.58it/s] 99%|█████████▉| 323/325 [00:26<00:00, 13.12it/s]100%|██████████| 325/325 [00:26<00:00, 14.39it/s]100%|██████████| 325/325 [00:26<00:00, 12.26it/s]
Total samples: 649.000000
Overall Acc: 0.878246
Mean Acc: 0.428744
FreqW Acc: 0.793782
Mean IoU: 0.355559
Class IoU:
	class 0: 0.9367424417908758
	class 1: 0.44650190547482116
	class 2: 0.7547026133257286
	class 3: 0.03651049957720538
	class 4: 0.05036218220108373
	class 5: 0.028866340859974526
	class 6: 0.04284732955507058
	class 7: 0.19505391644823056
	class 8: 0.7835779825430298
	class 9: 0.3874182383701134
	class 10: 0.7924971098576294
	class 11: 0.49574703161733186
	class 12: 0.08109862887786061
	class 13: 0.6747795844293561
	class 14: 0.0463493585900045
	class 15: 0.2680598018898461
	class 16: 0.20651858466254483
	class 17: 0.14048433048299636
	class 18: 0.38751131055039306
Class Acc:
	class 0: 0.9540750307109348
	class 1: 0.6291669741656003
	class 2: 0.9104893181024797
	class 3: 0.03765048707634827
	class 4: 0.05553392383033668
	class 5: 0.030480853312097607
	class 6: 0.04417598207612755
	class 7: 0.23489919835071912
	class 8: 0.916950929623187
	class 9: 0.46445645766363897
	class 10: 0.88738191218521
	class 11: 0.6985888791153751
	class 12: 0.08927570016351166
	class 13: 0.8450833326905696
	class 14: 0.05014679113275594
	class 15: 0.3563435732149868
	class 16: 0.224642432188511
	class 17: 0.15056488549465075
	class 18: 0.5662319043883646

...from 0 to 18 : best/test_before_mIoU : 0.355559
...from 0 to 18 : best/test_before_acc : 0.428744
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
==============================================
  task : 1-1
  step : 19
  Device: cuda
Namespace(amp=True, batch_size=6, bn_freeze=True, buffer=16384, cil_step=0, ckpt=None, crop_size=513, crop_val=True, curr_itrs=0, curr_step=19, data_root='/data/yt/BARM2/data_root/cityscapes', dataset='cityscapes_domain', gamma=10, gpu_id='1', initial=False, local_rank=0, loss_type='bce_loss', lr=0.01, lr_policy='poly', method='acil', model='deeplabv3_resnet101', num_classes=[1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], output_stride=16, overlap=False, print_interval=10, pseudo=True, pseudo_thresh=0.7, random_seed=1, separable_conv=False, setting='overlap', step_size=10000, subpath='BARM', target_cls=[[0], [1], [2], [3], [4], [5], [6], [7], [8], [9], [10], [11], [12], [13], [14], [15], [16], [17], [18], [19]], task='1-1', test_only=False, train_epoch=50, unknown=0, val_batch_size=2, val_interval=100, weight_decay=0.0001)
==============================================
Category components: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
checkpoints/BARM/1-1/overlap/step18/final.pth
Model restored from checkpoints/BARM/1-1/overlap/step18/final.pth
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
Dataset: cityscapes_domain, Train set: 47, Val set: 661, Test set: 661
... train epoch : 50 , iterations : 350 , val_interval : 100

... Training Done
[Testing Best Model]
  0%|          | 0/331 [00:00<?, ?it/s]  0%|          | 1/331 [00:00<03:31,  1.56it/s]  1%|          | 3/331 [00:00<01:13,  4.45it/s]  2%|▏         | 5/331 [00:00<00:47,  6.85it/s]  2%|▏         | 7/331 [00:01<00:36,  8.80it/s]  3%|▎         | 9/331 [00:01<00:31, 10.30it/s]  3%|▎         | 11/331 [00:01<00:28, 11.43it/s]  4%|▍         | 13/331 [00:01<00:25, 12.27it/s]  5%|▍         | 15/331 [00:01<00:24, 12.86it/s]  5%|▌         | 17/331 [00:01<00:23, 13.23it/s]  6%|▌         | 19/331 [00:01<00:23, 13.53it/s]  6%|▋         | 21/331 [00:02<00:22, 13.77it/s]  7%|▋         | 23/331 [00:02<00:22, 13.55it/s]  8%|▊         | 25/331 [00:02<00:22, 13.78it/s]  8%|▊         | 27/331 [00:02<00:22, 13.29it/s]  9%|▉         | 29/331 [00:02<00:22, 13.59it/s]  9%|▉         | 31/331 [00:02<00:23, 12.53it/s] 10%|▉         | 33/331 [00:02<00:22, 13.02it/s] 11%|█         | 35/331 [00:03<00:23, 12.37it/s] 11%|█         | 37/331 [00:03<00:22, 12.91it/s] 12%|█▏        | 39/331 [00:03<00:23, 12.30it/s] 12%|█▏        | 41/331 [00:03<00:22, 12.86it/s] 13%|█▎        | 43/331 [00:03<00:22, 12.84it/s] 14%|█▎        | 45/331 [00:03<00:21, 13.14it/s] 14%|█▍        | 47/331 [00:04<00:22, 12.72it/s] 15%|█▍        | 49/331 [00:04<00:21, 13.14it/s] 15%|█▌        | 51/331 [00:04<00:23, 12.15it/s] 16%|█▌        | 53/331 [00:04<00:21, 12.74it/s] 17%|█▋        | 55/331 [00:04<00:22, 12.11it/s] 17%|█▋        | 57/331 [00:04<00:21, 12.71it/s] 18%|█▊        | 59/331 [00:05<00:22, 12.27it/s] 18%|█▊        | 61/331 [00:05<00:21, 12.84it/s] 19%|█▉        | 63/331 [00:05<00:21, 12.47it/s] 20%|█▉        | 65/331 [00:05<00:20, 12.97it/s] 20%|██        | 67/331 [00:05<00:21, 12.43it/s] 21%|██        | 69/331 [00:05<00:20, 12.97it/s] 21%|██▏       | 71/331 [00:06<00:21, 12.35it/s] 22%|██▏       | 73/331 [00:06<00:20, 12.89it/s] 23%|██▎       | 75/331 [00:06<00:20, 12.59it/s] 23%|██▎       | 77/331 [00:06<00:19, 13.07it/s] 24%|██▍       | 79/331 [00:07<00:35,  7.02it/s] 24%|██▍       | 81/331 [00:07<00:30,  8.29it/s] 25%|██▌       | 83/331 [00:07<00:28,  8.83it/s] 26%|██▌       | 85/331 [00:07<00:24,  9.98it/s] 26%|██▋       | 87/331 [00:07<00:23, 10.46it/s] 27%|██▋       | 89/331 [00:07<00:21, 11.33it/s] 27%|██▋       | 91/331 [00:08<00:21, 11.38it/s] 28%|██▊       | 93/331 [00:08<00:19, 12.12it/s] 29%|██▊       | 95/331 [00:08<00:19, 11.90it/s] 29%|██▉       | 97/331 [00:08<00:18, 12.53it/s] 30%|██▉       | 99/331 [00:08<00:18, 12.45it/s] 31%|███       | 101/331 [00:08<00:17, 12.97it/s] 31%|███       | 103/331 [00:08<00:18, 12.42it/s] 32%|███▏      | 105/331 [00:09<00:17, 12.94it/s] 32%|███▏      | 107/331 [00:09<00:18, 12.19it/s] 33%|███▎      | 109/331 [00:09<00:17, 12.74it/s] 34%|███▎      | 111/331 [00:09<00:17, 12.48it/s] 34%|███▍      | 113/331 [00:09<00:16, 12.99it/s] 35%|███▍      | 115/331 [00:09<00:17, 12.50it/s] 35%|███▌      | 117/331 [00:10<00:16, 12.97it/s] 36%|███▌      | 119/331 [00:10<00:16, 12.63it/s] 37%|███▋      | 121/331 [00:10<00:16, 13.11it/s] 37%|███▋      | 123/331 [00:10<00:16, 12.60it/s] 38%|███▊      | 125/331 [00:10<00:15, 13.07it/s] 38%|███▊      | 127/331 [00:10<00:16, 12.30it/s] 39%|███▉      | 129/331 [00:10<00:15, 12.85it/s] 40%|███▉      | 131/331 [00:11<00:16, 12.31it/s] 40%|████      | 133/331 [00:11<00:15, 12.87it/s] 41%|████      | 135/331 [00:11<00:15, 12.36it/s] 41%|████▏     | 137/331 [00:11<00:15, 12.90it/s] 42%|████▏     | 139/331 [00:11<00:15, 12.27it/s] 43%|████▎     | 141/331 [00:11<00:14, 12.82it/s] 43%|████▎     | 143/331 [00:12<00:15, 12.05it/s] 44%|████▍     | 145/331 [00:12<00:14, 12.64it/s] 44%|████▍     | 147/331 [00:12<00:14, 12.29it/s] 45%|████▌     | 149/331 [00:12<00:14, 12.82it/s] 46%|████▌     | 151/331 [00:12<00:14, 12.35it/s] 46%|████▌     | 153/331 [00:12<00:13, 12.88it/s] 47%|████▋     | 155/331 [00:13<00:14, 12.22it/s] 47%|████▋     | 157/331 [00:13<00:13, 12.78it/s] 48%|████▊     | 159/331 [00:13<00:13, 12.36it/s] 49%|████▊     | 161/331 [00:13<00:13, 12.91it/s] 49%|████▉     | 163/331 [00:13<00:13, 12.42it/s] 50%|████▉     | 165/331 [00:13<00:12, 12.94it/s] 50%|█████     | 167/331 [00:14<00:13, 12.32it/s] 51%|█████     | 169/331 [00:14<00:12, 12.86it/s] 52%|█████▏    | 171/331 [00:14<00:12, 12.49it/s] 52%|█████▏    | 173/331 [00:14<00:12, 12.99it/s] 53%|█████▎    | 175/331 [00:14<00:12, 12.43it/s] 53%|█████▎    | 177/331 [00:14<00:11, 12.97it/s] 54%|█████▍    | 179/331 [00:14<00:12, 12.34it/s] 55%|█████▍    | 181/331 [00:15<00:11, 12.90it/s] 55%|█████▌    | 183/331 [00:15<00:12, 11.86it/s] 56%|█████▌    | 185/331 [00:15<00:11, 12.49it/s] 56%|█████▋    | 187/331 [00:15<00:12, 11.68it/s] 57%|█████▋    | 189/331 [00:15<00:11, 12.37it/s] 58%|█████▊    | 191/331 [00:15<00:11, 12.09it/s] 58%|█████▊    | 193/331 [00:16<00:10, 12.70it/s] 59%|█████▉    | 195/331 [00:16<00:11, 12.25it/s] 60%|█████▉    | 197/331 [00:16<00:10, 12.81it/s] 60%|██████    | 199/331 [00:16<00:10, 12.30it/s] 61%|██████    | 201/331 [00:16<00:10, 12.84it/s] 61%|██████▏   | 203/331 [00:16<00:10, 12.40it/s] 62%|██████▏   | 205/331 [00:17<00:09, 12.83it/s] 63%|██████▎   | 207/331 [00:17<00:09, 13.24it/s] 63%|██████▎   | 209/331 [00:17<00:09, 13.54it/s] 64%|██████▎   | 211/331 [00:17<00:08, 13.75it/s] 64%|██████▍   | 213/331 [00:17<00:08, 13.91it/s] 65%|██████▍   | 215/331 [00:17<00:08, 13.44it/s] 66%|██████▌   | 217/331 [00:17<00:08, 13.68it/s] 66%|██████▌   | 219/331 [00:18<00:08, 12.95it/s] 67%|██████▋   | 221/331 [00:18<00:08, 13.32it/s] 67%|██████▋   | 223/331 [00:18<00:08, 12.66it/s] 68%|██████▊   | 225/331 [00:18<00:08, 13.17it/s] 69%|██████▊   | 227/331 [00:18<00:08, 12.65it/s] 69%|██████▉   | 229/331 [00:18<00:07, 13.15it/s] 70%|██████▉   | 231/331 [00:19<00:07, 12.50it/s] 70%|███████   | 233/331 [00:19<00:07, 13.06it/s] 71%|███████   | 235/331 [00:19<00:07, 12.44it/s] 72%|███████▏  | 237/331 [00:19<00:07, 13.01it/s] 72%|███████▏  | 239/331 [00:19<00:07, 12.38it/s] 73%|███████▎  | 241/331 [00:19<00:06, 12.95it/s] 73%|███████▎  | 243/331 [00:19<00:07, 12.39it/s] 74%|███████▍  | 245/331 [00:20<00:06, 12.97it/s] 75%|███████▍  | 247/331 [00:20<00:07, 11.98it/s] 75%|███████▌  | 249/331 [00:20<00:06, 12.65it/s] 76%|███████▌  | 251/331 [00:20<00:06, 12.27it/s] 76%|███████▋  | 253/331 [00:20<00:06, 12.86it/s] 77%|███████▋  | 255/331 [00:20<00:06, 12.25it/s] 78%|███████▊  | 257/331 [00:21<00:05, 12.76it/s] 78%|███████▊  | 259/331 [00:21<00:05, 12.23it/s] 79%|███████▉  | 261/331 [00:21<00:05, 12.85it/s] 79%|███████▉  | 263/331 [00:21<00:05, 12.35it/s] 80%|████████  | 265/331 [00:21<00:05, 12.96it/s] 81%|████████  | 267/331 [00:21<00:05, 12.28it/s] 81%|████████▏ | 269/331 [00:22<00:04, 12.89it/s] 82%|████████▏ | 271/331 [00:22<00:04, 12.43it/s] 82%|████████▏ | 273/331 [00:22<00:04, 12.99it/s] 83%|████████▎ | 275/331 [00:22<00:04, 12.40it/s] 84%|████████▎ | 277/331 [00:22<00:04, 12.97it/s] 84%|████████▍ | 279/331 [00:22<00:04, 12.20it/s] 85%|████████▍ | 281/331 [00:22<00:03, 12.83it/s] 85%|████████▌ | 283/331 [00:23<00:03, 12.74it/s] 86%|████████▌ | 285/331 [00:23<00:03, 13.23it/s] 87%|████████▋ | 287/331 [00:23<00:03, 13.54it/s] 87%|████████▋ | 289/331 [00:23<00:03, 13.79it/s] 88%|████████▊ | 291/331 [00:23<00:02, 13.95it/s] 89%|████████▊ | 293/331 [00:23<00:02, 14.05it/s] 89%|████████▉ | 295/331 [00:23<00:02, 14.15it/s] 90%|████████▉ | 297/331 [00:24<00:02, 14.24it/s] 90%|█████████ | 299/331 [00:24<00:02, 14.32it/s] 91%|█████████ | 301/331 [00:24<00:02, 14.35it/s] 92%|█████████▏| 303/331 [00:24<00:01, 14.38it/s] 92%|█████████▏| 305/331 [00:24<00:01, 13.47it/s] 93%|█████████▎| 307/331 [00:24<00:01, 13.71it/s] 93%|█████████▎| 309/331 [00:25<00:01, 12.89it/s] 94%|█████████▍| 311/331 [00:25<00:01, 13.31it/s] 95%|█████████▍| 313/331 [00:25<00:01, 12.69it/s] 95%|█████████▌| 315/331 [00:25<00:01, 13.15it/s] 96%|█████████▌| 317/331 [00:25<00:01, 12.39it/s] 96%|█████████▋| 319/331 [00:25<00:00, 12.94it/s] 97%|█████████▋| 321/331 [00:25<00:00, 12.45it/s] 98%|█████████▊| 323/331 [00:26<00:00, 12.98it/s] 98%|█████████▊| 325/331 [00:26<00:00, 12.40it/s] 99%|█████████▉| 327/331 [00:26<00:00, 12.97it/s] 99%|█████████▉| 329/331 [00:26<00:00, 12.57it/s]100%|██████████| 331/331 [00:26<00:00, 13.92it/s]100%|██████████| 331/331 [00:26<00:00, 12.36it/s]
Total samples: 661.000000
Overall Acc: 0.877838
Mean Acc: 0.428582
FreqW Acc: 0.793412
Mean IoU: 0.354244
Class IoU:
	class 0: 0.9352848064593015
	class 1: 0.4366245673963573
	class 2: 0.7562991969820196
	class 3: 0.03680625684872809
	class 4: 0.05198133316696691
	class 5: 0.03148404651071348
	class 6: 0.03850653019162372
	class 7: 0.19508865696415537
	class 8: 0.784517280620103
	class 9: 0.3804714419921854
	class 10: 0.7894170800667677
	class 11: 0.4915841338301502
	class 12: 0.08293427258337173
	class 13: 0.6756590032479483
	class 14: 0.06146605500483009
	class 15: 0.251706850013107
	class 16: 0.21139850834451226
	class 17: 0.12614384027724299
	class 18: 0.3932629945574082
Class Acc:
	class 0: 0.9529223333879304
	class 1: 0.6234625331468516
	class 2: 0.9080645808123091
	class 3: 0.03805744062037878
	class 4: 0.0572883603766216
	class 5: 0.03345692296560806
	class 6: 0.03960582175144892
	class 7: 0.23564784868815591
	class 8: 0.9181474547864918
	class 9: 0.45903328829452805
	class 10: 0.884952575693356
	class 11: 0.6954896576815808
	class 12: 0.09182607069728707
	class 13: 0.8444112530530099
	class 14: 0.068730150812115
	class 15: 0.3493619067323702
	class 16: 0.2256766177215063
	class 17: 0.135460468136873
	class 18: 0.5814646428541139

...from 0 to 18 : best/test_before_mIoU : 0.354244
...from 0 to 18 : best/test_before_acc : 0.428582
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
==============================================
  task : 1-1
  step : 20
  Device: cuda
Namespace(amp=True, batch_size=6, bn_freeze=True, buffer=16384, cil_step=0, ckpt=None, crop_size=513, crop_val=True, curr_itrs=0, curr_step=20, data_root='/data/yt/BARM2/data_root/cityscapes', dataset='cityscapes_domain', gamma=10, gpu_id='1', initial=False, local_rank=0, loss_type='bce_loss', lr=0.01, lr_policy='poly', method='acil', model='deeplabv3_resnet101', num_classes=[1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], output_stride=16, overlap=False, print_interval=10, pseudo=True, pseudo_thresh=0.7, random_seed=1, separable_conv=False, setting='overlap', step_size=10000, subpath='BARM', target_cls=[[0], [1], [2], [3], [4], [5], [6], [7], [8], [9], [10], [11], [12], [13], [14], [15], [16], [17], [18], [19], [20]], task='1-1', test_only=False, train_epoch=50, unknown=0, val_batch_size=2, val_interval=100, weight_decay=0.0001)
==============================================
Category components: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
checkpoints/BARM/1-1/overlap/step19/final.pth
Model restored from checkpoints/BARM/1-1/overlap/step19/final.pth
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
root /data/yt/BARM2/data_root/cityscapes
Filtering images...
	0/3475 ...
	1000/3475 ...
	2000/3475 ...
	3000/3475 ...
Dataset: cityscapes_domain, Train set: 139, Val set: 695, Test set: 695
... train epoch : 50 , iterations : 1150 , val_interval : 100

... Training Done
[Testing Best Model]
  0%|          | 0/348 [00:00<?, ?it/s]  0%|          | 1/348 [00:00<03:32,  1.64it/s]  1%|          | 3/348 [00:00<01:14,  4.63it/s]  1%|▏         | 5/348 [00:00<00:48,  7.13it/s]  2%|▏         | 7/348 [00:01<00:37,  9.11it/s]  3%|▎         | 9/348 [00:01<00:34,  9.82it/s]  3%|▎         | 11/348 [00:01<00:30, 11.11it/s]  4%|▎         | 13/348 [00:01<00:30, 10.97it/s]  4%|▍         | 15/348 [00:01<00:28, 11.89it/s]  5%|▍         | 17/348 [00:01<00:27, 11.92it/s]  5%|▌         | 19/348 [00:01<00:26, 12.65it/s]  6%|▌         | 21/348 [00:02<00:27, 12.05it/s]  7%|▋         | 23/348 [00:02<00:25, 12.71it/s]  7%|▋         | 25/348 [00:02<00:26, 12.22it/s]  8%|▊         | 27/348 [00:02<00:24, 12.84it/s]  8%|▊         | 29/348 [00:02<00:26, 11.86it/s]  9%|▉         | 31/348 [00:02<00:25, 12.55it/s]  9%|▉         | 33/348 [00:03<00:25, 12.39it/s] 10%|█         | 35/348 [00:03<00:24, 12.97it/s] 11%|█         | 37/348 [00:03<00:25, 12.31it/s] 11%|█         | 39/348 [00:03<00:23, 12.91it/s] 12%|█▏        | 41/348 [00:03<00:24, 12.32it/s] 12%|█▏        | 43/348 [00:03<00:23, 12.91it/s] 13%|█▎        | 45/348 [00:04<00:24, 12.46it/s] 14%|█▎        | 47/348 [00:04<00:23, 12.95it/s] 14%|█▍        | 49/348 [00:04<00:24, 12.45it/s] 15%|█▍        | 51/348 [00:04<00:23, 12.64it/s] 15%|█▌        | 53/348 [00:04<00:23, 12.54it/s] 16%|█▌        | 55/348 [00:04<00:23, 12.55it/s] 16%|█▋        | 57/348 [00:05<00:23, 12.54it/s] 17%|█▋        | 59/348 [00:05<00:23, 12.50it/s] 18%|█▊        | 61/348 [00:05<00:22, 12.66it/s] 18%|█▊        | 63/348 [00:05<00:22, 12.44it/s] 19%|█▊        | 65/348 [00:05<00:22, 12.63it/s] 19%|█▉        | 67/348 [00:05<00:22, 12.38it/s] 20%|█▉        | 69/348 [00:05<00:21, 12.85it/s] 20%|██        | 71/348 [00:06<00:22, 12.35it/s] 21%|██        | 73/348 [00:06<00:21, 12.72it/s] 22%|██▏       | 75/348 [00:06<00:22, 12.15it/s] 22%|██▏       | 77/348 [00:06<00:21, 12.52it/s] 23%|██▎       | 79/348 [00:06<00:20, 13.06it/s] 23%|██▎       | 81/348 [00:07<00:36,  7.33it/s] 24%|██▍       | 83/348 [00:07<00:31,  8.53it/s] 24%|██▍       | 85/348 [00:07<00:29,  9.00it/s] 25%|██▌       | 87/348 [00:07<00:25, 10.08it/s] 26%|██▌       | 89/348 [00:07<00:25, 10.25it/s] 26%|██▌       | 91/348 [00:08<00:23, 11.10it/s] 27%|██▋       | 93/348 [00:08<00:23, 11.05it/s] 27%|██▋       | 95/348 [00:08<00:21, 11.75it/s] 28%|██▊       | 97/348 [00:08<00:21, 11.42it/s] 28%|██▊       | 99/348 [00:08<00:20, 12.18it/s] 29%|██▉       | 101/348 [00:08<00:20, 11.92it/s] 30%|██▉       | 103/348 [00:09<00:19, 12.46it/s] 30%|███       | 105/348 [00:09<00:19, 12.34it/s] 31%|███       | 107/348 [00:09<00:19, 12.65it/s] 31%|███▏      | 109/348 [00:09<00:19, 12.10it/s] 32%|███▏      | 111/348 [00:09<00:18, 12.55it/s] 32%|███▏      | 113/348 [00:09<00:19, 12.18it/s] 33%|███▎      | 115/348 [00:10<00:18, 12.77it/s] 34%|███▎      | 117/348 [00:10<00:18, 12.45it/s] 34%|███▍      | 119/348 [00:10<00:17, 12.97it/s] 35%|███▍      | 121/348 [00:10<00:18, 12.42it/s] 35%|███▌      | 123/348 [00:10<00:17, 12.79it/s] 36%|███▌      | 125/348 [00:10<00:18, 12.21it/s] 36%|███▋      | 127/348 [00:11<00:17, 12.36it/s] 37%|███▋      | 129/348 [00:11<00:17, 12.28it/s] 38%|███▊      | 131/348 [00:11<00:17, 12.73it/s] 38%|███▊      | 133/348 [00:11<00:17, 12.27it/s] 39%|███▉      | 135/348 [00:11<00:16, 12.82it/s] 39%|███▉      | 137/348 [00:11<00:16, 12.52it/s] 40%|███▉      | 139/348 [00:11<00:16, 13.01it/s] 41%|████      | 141/348 [00:12<00:17, 12.15it/s] 41%|████      | 143/348 [00:12<00:16, 12.74it/s] 42%|████▏     | 145/348 [00:12<00:16, 12.25it/s] 42%|████▏     | 147/348 [00:12<00:15, 12.83it/s] 43%|████▎     | 149/348 [00:12<00:16, 12.22it/s] 43%|████▎     | 151/348 [00:12<00:15, 12.81it/s] 44%|████▍     | 153/348 [00:13<00:15, 12.40it/s] 45%|████▍     | 155/348 [00:13<00:15, 12.84it/s] 45%|████▌     | 157/348 [00:13<00:15, 12.40it/s] 46%|████▌     | 159/348 [00:13<00:14, 12.94it/s] 46%|████▋     | 161/348 [00:13<00:15, 12.23it/s] 47%|████▋     | 163/348 [00:13<00:14, 12.79it/s] 47%|████▋     | 165/348 [00:14<00:14, 12.43it/s] 48%|████▊     | 167/348 [00:14<00:13, 12.94it/s] 49%|████▊     | 169/348 [00:14<00:14, 12.60it/s] 49%|████▉     | 171/348 [00:14<00:13, 13.01it/s] 50%|████▉     | 173/348 [00:14<00:14, 12.18it/s] 50%|█████     | 175/348 [00:14<00:13, 12.82it/s] 51%|█████     | 177/348 [00:14<00:13, 12.41it/s] 51%|█████▏    | 179/348 [00:15<00:13, 12.99it/s] 52%|█████▏    | 181/348 [00:15<00:13, 12.22it/s] 53%|█████▎    | 183/348 [00:15<00:12, 12.85it/s] 53%|█████▎    | 185/348 [00:15<00:13, 12.25it/s] 54%|█████▎    | 187/348 [00:15<00:12, 12.83it/s] 54%|█████▍    | 189/348 [00:15<00:12, 12.43it/s] 55%|█████▍    | 191/348 [00:16<00:12, 13.00it/s] 55%|█████▌    | 193/348 [00:16<00:12, 12.24it/s] 56%|█████▌    | 195/348 [00:16<00:11, 12.85it/s] 57%|█████▋    | 197/348 [00:16<00:12, 12.47it/s] 57%|█████▋    | 199/348 [00:16<00:11, 13.04it/s] 58%|█████▊    | 201/348 [00:16<00:11, 12.68it/s] 58%|█████▊    | 203/348 [00:17<00:10, 13.20it/s] 59%|█████▉    | 205/348 [00:17<00:10, 13.57it/s] 59%|█████▉    | 207/348 [00:17<00:10, 13.80it/s] 60%|██████    | 209/348 [00:17<00:09, 13.96it/s] 61%|██████    | 211/348 [00:17<00:09, 14.07it/s] 61%|██████    | 213/348 [00:17<00:09, 14.15it/s] 62%|██████▏   | 215/348 [00:17<00:09, 14.20it/s] 62%|██████▏   | 217/348 [00:17<00:09, 14.26it/s] 63%|██████▎   | 219/348 [00:18<00:09, 14.27it/s] 64%|██████▎   | 221/348 [00:18<00:08, 14.27it/s] 64%|██████▍   | 223/348 [00:18<00:08, 14.29it/s] 65%|██████▍   | 225/348 [00:18<00:08, 14.30it/s] 65%|██████▌   | 227/348 [00:18<00:08, 14.30it/s] 66%|██████▌   | 229/348 [00:18<00:08, 14.22it/s] 66%|██████▋   | 231/348 [00:19<00:08, 13.45it/s] 67%|██████▋   | 233/348 [00:19<00:08, 13.74it/s] 68%|██████▊   | 235/348 [00:19<00:08, 12.92it/s] 68%|██████▊   | 237/348 [00:19<00:08, 13.28it/s] 69%|██████▊   | 239/348 [00:19<00:08, 12.62it/s] 69%|██████▉   | 241/348 [00:19<00:08, 13.14it/s] 70%|██████▉   | 243/348 [00:19<00:07, 13.54it/s] 70%|███████   | 245/348 [00:20<00:07, 13.80it/s] 71%|███████   | 247/348 [00:20<00:07, 14.01it/s] 72%|███████▏  | 249/348 [00:20<00:06, 14.15it/s] 72%|███████▏  | 251/348 [00:20<00:06, 14.23it/s] 73%|███████▎  | 253/348 [00:20<00:06, 14.30it/s] 73%|███████▎  | 255/348 [00:20<00:06, 14.35it/s] 74%|███████▍  | 257/348 [00:20<00:06, 14.38it/s] 74%|███████▍  | 259/348 [00:21<00:06, 14.30it/s] 75%|███████▌  | 261/348 [00:21<00:06, 14.38it/s] 76%|███████▌  | 263/348 [00:21<00:05, 14.40it/s] 76%|███████▌  | 265/348 [00:21<00:05, 14.42it/s] 77%|███████▋  | 267/348 [00:21<00:05, 14.43it/s] 77%|███████▋  | 269/348 [00:21<00:05, 13.87it/s] 78%|███████▊  | 271/348 [00:21<00:05, 14.06it/s] 78%|███████▊  | 273/348 [00:22<00:05, 12.93it/s] 79%|███████▉  | 275/348 [00:22<00:05, 13.37it/s] 80%|███████▉  | 277/348 [00:22<00:05, 12.71it/s] 80%|████████  | 279/348 [00:22<00:05, 13.20it/s] 81%|████████  | 281/348 [00:22<00:05, 12.67it/s] 81%|████████▏ | 283/348 [00:22<00:04, 13.17it/s] 82%|████████▏ | 285/348 [00:22<00:04, 12.62it/s] 82%|████████▏ | 287/348 [00:23<00:04, 13.12it/s] 83%|████████▎ | 289/348 [00:23<00:04, 12.69it/s] 84%|████████▎ | 291/348 [00:23<00:04, 13.16it/s] 84%|████████▍ | 293/348 [00:23<00:04, 12.47it/s] 85%|████████▍ | 295/348 [00:23<00:04, 12.99it/s] 85%|████████▌ | 297/348 [00:23<00:04, 12.45it/s] 86%|████████▌ | 299/348 [00:24<00:03, 13.00it/s] 86%|████████▋ | 301/348 [00:24<00:03, 12.50it/s] 87%|████████▋ | 303/348 [00:24<00:03, 13.02it/s] 88%|████████▊ | 305/348 [00:24<00:03, 12.45it/s] 88%|████████▊ | 307/348 [00:24<00:03, 12.98it/s] 89%|████████▉ | 309/348 [00:24<00:03, 12.46it/s] 89%|████████▉ | 311/348 [00:25<00:02, 13.00it/s] 90%|████████▉ | 313/348 [00:25<00:02, 12.38it/s] 91%|█████████ | 315/348 [00:25<00:02, 12.93it/s] 91%|█████████ | 317/348 [00:25<00:02, 12.61it/s] 92%|█████████▏| 319/348 [00:25<00:02, 13.11it/s] 92%|█████████▏| 321/348 [00:25<00:02, 12.39it/s] 93%|█████████▎| 323/348 [00:25<00:01, 12.96it/s] 93%|█████████▎| 325/348 [00:26<00:01, 12.51it/s] 94%|█████████▍| 327/348 [00:26<00:01, 12.98it/s] 95%|█████████▍| 329/348 [00:26<00:01, 12.36it/s] 95%|█████████▌| 331/348 [00:26<00:01, 12.93it/s] 96%|█████████▌| 333/348 [00:26<00:01, 12.30it/s] 96%|█████████▋| 335/348 [00:26<00:01, 12.90it/s] 97%|█████████▋| 337/348 [00:27<00:00, 12.29it/s] 97%|█████████▋| 339/348 [00:27<00:00, 12.87it/s] 98%|█████████▊| 341/348 [00:27<00:00, 12.37it/s] 99%|█████████▊| 343/348 [00:27<00:00, 12.95it/s] 99%|█████████▉| 345/348 [00:27<00:00, 12.53it/s]100%|█████████▉| 347/348 [00:27<00:00, 13.12it/s]100%|██████████| 348/348 [00:27<00:00, 12.45it/s]

Total samples: 695.000000
Overall Acc: 0.879002
Mean Acc: 0.429089
FreqW Acc: 0.795073
Mean IoU: 0.353253
Class IoU:
	class 0: 0.936296007482186
	class 1: 0.4366793838127222
	class 2: 0.7580920811767661
	class 3: 0.033806081064003485
	class 4: 0.047911503890660505
	class 5: 0.026761544375296292
	class 6: 0.042347094658079565
	class 7: 0.19493174312160708
	class 8: 0.7883779422351134
	class 9: 0.37448449949764323
	class 10: 0.7919063483109713
	class 11: 0.4816977173284607
	class 12: 0.08589869272073437
	class 13: 0.6756329437351899
	class 14: 0.04211307687085129
	class 15: 0.25419881979064696
	class 16: 0.24343601063149709
	class 17: 0.09804988791977505
	class 18: 0.3991779798227088
Class Acc:
	class 0: 0.9540483382903254
	class 1: 0.6181476400430442
	class 2: 0.9110612048971211
	class 3: 0.0348574446531401
	class 4: 0.052601337990640484
	class 5: 0.02820069326521383
	class 6: 0.04367481985690275
	class 7: 0.23478268099397354
	class 8: 0.920476337211637
	class 9: 0.44938740710123837
	class 10: 0.885393366357601
	class 11: 0.6837545122982749
	class 12: 0.094903429580757
	class 13: 0.8448288170772025
	class 14: 0.04617047148190314
	class 15: 0.4114650258195994
	class 16: 0.25818402949780417
	class 17: 0.10301343064517501
	class 18: 0.5777481342601897

...from 0 to 18 : best/test_before_mIoU : 0.353253
...from 0 to 18 : best/test_before_acc : 0.429089
